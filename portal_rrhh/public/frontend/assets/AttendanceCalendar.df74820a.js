var F=(D,_,m)=>new Promise((f,d)=>{var x=c=>{try{y(m.next(c))}catch(b){d(b)}},k=c=>{try{y(m.throw(c))}catch(b){d(b)}},y=c=>c.done?f(c.value):Promise.resolve(c.value).then(x,k);y((m=m.apply(D,_)).next())});import{r as N,q as T,K as S,o as a,c as n,b as e,d as L,u as w,_ as q,t as r,F as p,E as v,n as Y,f as u,s as A,w as H,e as J,C as K,a1 as W}from"./vendor.6b0ecc0f.js";import{d as M}from"./es.3448d6cc.js";const G={class:"attendance-calendar"},P={class:"flex justify-end mb-4"},Q={class:"flex items-center bg-white rounded-md shadow-sm border border-gray-300"},U={class:"grid grid-cols-1 lg:grid-cols-2 gap-8 relative"},X={class:"bg-white"},Z={class:"text-lg font-bold text-gray-900 mb-4 capitalize text-center"},tt={class:"grid grid-cols-7 gap-px bg-gray-200 border border-gray-200 rounded-lg overflow-hidden"},et={key:0,class:"w-full text-center"},st={key:0,class:"mt-1"},at={class:"text-lg font-bold text-gray-900"},ot={key:1,class:"mt-1"},nt={key:2,class:"mt-2"},rt={class:"bg-white"},lt={class:"text-lg font-bold text-gray-900 mb-4 capitalize text-center"},dt={class:"grid grid-cols-7 gap-px bg-gray-200 border border-gray-200 rounded-lg overflow-hidden"},it={key:0,class:"w-full text-center"},ct={key:0,class:"mt-1"},ut={class:"text-lg font-bold text-gray-900"},mt={key:1,class:"mt-1"},ht={key:2,class:"mt-2"},gt={key:0,class:"absolute inset-0 bg-white/50 z-50 flex items-center justify-center rounded-lg"},ft={class:"bg-white p-3 rounded shadow border flex items-center space-x-3"},bt={class:"text-sm font-medium"},xt={__name:"AttendanceCalendar",props:{employeeId:{type:String,default:null}},setup(D){M.locale("es");const _=D,m=N(!1),f=N({}),d=N(M().startOf("month")),x=T(()=>d.value.add(1,"month")),k=["Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b","Dom"],y=T(()=>I(d.value)),c=T(()=>I(x.value)),b=o=>o.format("MMMM YYYY"),O=o=>o?o.split(",").map(s=>s.trim()):[],z=o=>{const s=M(o).day();return s!==0&&s!==6};function I(o){const s=o.startOf("month"),t=o.endOf("month"),h=o.daysInMonth(),l=[];let g=s.day();g===0&&(g=7),g-=1;for(let i=0;i<g;i++)l.push({inMonth:!1,dayNum:"",date:null});for(let i=1;i<=h;i++){const j=s.date(i).format("YYYY-MM-DD");l.push({inMonth:!0,dayNum:i,date:j,isToday:j===M().format("YYYY-MM-DD"),data:f.value[j]||null})}const E=t.day();let $=0;E!==0&&($=7-E);for(let i=0;i<$;i++)l.push({inMonth:!1,dayNum:"",date:null});return l}const B=o=>{d.value=d.value.add(o,"month"),C()},R=()=>{d.value=M().startOf("month"),C()},C=()=>F(this,null,function*(){if(!_.employeeId){f.value={};return}m.value=!0;try{const o=d.value.format("YYYY-MM-DD"),s=x.value.endOf("month").format("YYYY-MM-DD"),t=yield W("portal_rrhh.api.attendance.get_attendance_report",{employee:_.employeeId,from_date:o,to_date:s});if(t&&t.success&&t.data){const h={};t.data.forEach(l=>{h[l.date]=l}),f.value=h}else f.value={}}catch(o){console.error(o)}finally{m.value=!1}});S(()=>_.employeeId,()=>{C()},{immediate:!0});const V=o=>o;return(o,s)=>(a(),n("div",G,[e("div",P,[e("div",Q,[e("button",{onClick:s[0]||(s[0]=t=>B(-1)),class:"p-2 hover:bg-gray-50 border-r border-gray-300 text-gray-600"},[L(w(q),{name:"chevron-left",class:"h-5 w-5"})]),e("button",{onClick:R,class:"px-4 py-2 text-sm font-medium hover:bg-gray-50 text-gray-700 border-r border-gray-300"},r(V("Hoy")),1),e("button",{onClick:s[1]||(s[1]=t=>B(1)),class:"p-2 hover:bg-gray-50 text-gray-600"},[L(w(q),{name:"chevron-right",class:"h-5 w-5"})])])]),e("div",U,[e("div",X,[e("h3",Z,r(b(d.value)),1),e("div",tt,[(a(),n(p,null,v(k,t=>e("div",{key:t,class:"bg-gray-50 py-2 text-center text-xs font-semibold text-gray-500 uppercase"},r(t),1)),64)),(a(!0),n(p,null,v(y.value,(t,h)=>(a(),n("div",{key:h,class:Y(["bg-white min-h-[100px] p-2 flex flex-col items-center justify-start relative group transition-colors hover:bg-blue-50",{"bg-gray-50":!t.inMonth,"bg-blue-50":t.isToday}])},[e("span",{class:Y(["text-xs font-medium mb-1",t.isToday?"text-blue-600":"text-gray-400"])},r(t.dayNum),3),t.inMonth&&t.data?(a(),n("div",et,[t.data.hours>0?(a(),n("div",st,[e("span",at,r(t.data.hours)+"h",1)])):u("",!0),t.data.status?(a(),n("div",ot,[(a(!0),n(p,null,v(O(t.data.status),(l,g)=>(a(),A(w(K),{key:g,size:"sm",variant:"subtle",theme:"orange",class:"mb-0.5 mx-auto block max-w-full truncate"},{default:H(()=>[J(r(l),1)]),_:2},1024))),128))])):u("",!0),t.data.hours===0&&!t.data.status&&z(t.date)?(a(),n("div",nt,[...s[2]||(s[2]=[e("span",{class:"h-1.5 w-1.5 rounded-full bg-red-400 inline-block"},null,-1)])])):u("",!0)])):u("",!0)],2))),128))])]),e("div",rt,[e("h3",lt,r(b(x.value)),1),e("div",dt,[(a(),n(p,null,v(k,t=>e("div",{key:t,class:"bg-gray-50 py-2 text-center text-xs font-semibold text-gray-500 uppercase"},r(t),1)),64)),(a(!0),n(p,null,v(c.value,(t,h)=>(a(),n("div",{key:h,class:Y(["bg-white min-h-[100px] p-2 flex flex-col items-center justify-start relative group transition-colors hover:bg-blue-50",{"bg-gray-50":!t.inMonth,"bg-blue-50":t.isToday}])},[e("span",{class:Y(["text-xs font-medium mb-1",t.isToday?"text-blue-600":"text-gray-400"])},r(t.dayNum),3),t.inMonth&&t.data?(a(),n("div",it,[t.data.hours>0?(a(),n("div",ct,[e("span",ut,r(t.data.hours)+"h",1)])):u("",!0),t.data.status?(a(),n("div",mt,[(a(!0),n(p,null,v(O(t.data.status),(l,g)=>(a(),A(w(K),{key:g,size:"sm",variant:"subtle",theme:"orange",class:"mb-0.5 mx-auto block max-w-full truncate"},{default:H(()=>[J(r(l),1)]),_:2},1024))),128))])):u("",!0),t.data.hours===0&&!t.data.status&&z(t.date)?(a(),n("div",ht,[...s[3]||(s[3]=[e("span",{class:"h-1.5 w-1.5 rounded-full bg-red-400 inline-block"},null,-1)])])):u("",!0)])):u("",!0)],2))),128))])]),m.value?(a(),n("div",gt,[e("div",ft,[s[4]||(s[4]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"},null,-1)),e("span",bt,r(V("Cargando...")),1)])])):u("",!0)])]))}};export{xt as _};
