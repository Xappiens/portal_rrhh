var at=Object.defineProperty;var Oe=Object.getOwnPropertySymbols;var st=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var Fe=(k,C,f)=>C in k?at(k,C,{enumerable:!0,configurable:!0,writable:!0,value:f}):k[C]=f,qe=(k,C)=>{for(var f in C||(C={}))st.call(C,f)&&Fe(k,f,C[f]);if(Oe)for(var f of Oe(C))ot.call(C,f)&&Fe(k,f,C[f]);return k};var ie=(k,C,f)=>new Promise((E,w)=>{var A=v=>{try{g(f.next(v))}catch(O){w(O)}},B=v=>{try{g(f.throw(v))}catch(O){w(O)}},g=v=>v.done?E(v.value):Promise.resolve(v.value).then(A,B);g((f=f.apply(k,C)).next())});import{a0 as ke,z as $e,r as T,q as S,o as s,c as l,b as e,n as j,t as u,d as y,u as d,Q as de,f as $,F as R,E as L,s as se,w as Y,y as me,a1 as Ce,a2 as ge,e as z,x as lt,l as oe,K as _e,G as he,_ as le,a3 as be,W as De,a4 as Re,R as Le,a5 as rt,I as nt,a6 as ye,a7 as ze,Z as it,J as dt}from"./vendor.13deb96d.js";import{d as _}from"./es.883fe910.js";import{w as ut}from"./weekOfYear.0d65299d.js";var Ie={exports:{}};(function(k,C){(function(f,E){k.exports=E()})(ke,function(){return function(f,E){E.prototype.isSameOrAfter=function(w,A){return this.isSame(w,A)||this.isAfter(w,A)}}})})(Ie);var He=Ie.exports,Ne={exports:{}};(function(k,C){(function(f,E){k.exports=E()})(ke,function(){return function(f,E){E.prototype.isSameOrBefore=function(w,A){return this.isSame(w,A)||this.isBefore(w,A)}}})})(Ne);var Ue=Ne.exports,We={exports:{}};(function(k,C){(function(f,E){k.exports=E()})(ke,function(){return function(f,E,w){E.prototype.isBetween=function(A,B,g,v){var O=w(A),x=w(B),M=(v=v||"()")[0]==="(",G=v[1]===")";return(M?this.isAfter(O,g):!this.isBefore(O,g))&&(G?this.isBefore(x,g):!this.isAfter(x,g))||(M?this.isBefore(O,g):!this.isAfter(O,g))&&(G?this.isAfter(x,g):!this.isBefore(x,g))}}})})(We);var Ge=We.exports;const ct={class:"calendar-container select-none"},pt={class:"flex items-center justify-between mb-4"},ft={key:0,class:"flex gap-1"},mt={class:"grid grid-cols-7 mb-2 border-b border-gray-100 pb-2"},gt={class:"grid grid-cols-7 gap-1"},yt=["onClick"],vt={key:0,class:"text-[10px] leading-tight text-red-600 font-medium bg-red-50 px-1 py-0.5 rounded truncate w-full text-center"},xt={key:1,class:"flex flex-col gap-1 overflow-hidden w-full flex-1"},_t=["onClick"],ht={class:"p-3 w-64 max-h-64 overflow-y-auto bg-white rounded-lg shadow-xl border border-gray-100"},bt={class:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2"},wt={class:"flex flex-col gap-1.5"},kt={key:0,class:"text-[10px] opacity-75 mt-0.5"},Je=2,$t={__name:"MonthCalendar",props:{events:{type:Array,default:()=>[]},modelDate:{type:[String,Date,Object],default:null},hideControls:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},selection:{type:Object,default:()=>({from:null,to:null})},holidays:{type:Array,default:()=>[]}},emits:["update:selection"],setup(k,{emit:C}){_.extend(He),_.extend(Ue),_.extend(Ge),_.locale("es");const f=k,E=C,w=_(),A=T(_()),B=S({get:()=>f.modelDate?_(f.modelDate):A.value,set:a=>{f.modelDate||(A.value=a)}}),g=S(()=>B.value.format("MMMM")),v=S(()=>B.value.format("YYYY")),O=["Lu","Ma","Mi","Ju","Vi","S\xE1","Do"],x=S(()=>{const a=B.value.startOf("month"),r=B.value.daysInMonth(),p=[];for(let V=1;V<=r;V++){const re=a.date(V);p.push({day:V,fullDate:re.format("YYYY-MM-DD")})}return p}),M=S(()=>{let a=B.value.startOf("month").day();return a===0&&(a=7),a-1});function G(){f.modelDate||(A.value=A.value.subtract(1,"month"))}function K(){f.modelDate||(A.value=A.value.add(1,"month"))}function F(a){return a===w.format("YYYY-MM-DD")}function J(a){return f.holidays?f.holidays.includes(a):!1}function W(a){const r=_(a);return r.day()===0||r.day()===6}function Q(a){if(!f.selectable)return;let{from:r,to:p}=f.selection||{};!r&&!p?E("update:selection",{from:a,to:null}):r&&!p?_(a).isBefore(r)?E("update:selection",{from:a,to:null}):E("update:selection",{from:r,to:a}):E("update:selection",{from:a,to:null})}function b(a){var r;return((r=f.selection)==null?void 0:r.from)?f.selection.from===a||f.selection.to===a:!1}function X(a){var r,p;return!((r=f.selection)==null?void 0:r.from)||!((p=f.selection)==null?void 0:p.to)?!1:_(a).isBetween(f.selection.from,f.selection.to,"day","()")}function H(a){const r="border-gray-100 hover:bg-gray-50";return f.selectable?b(a)?"bg-blue-600 border-blue-600 shadow-sm z-10":X(a)?"bg-blue-50 border-blue-100":J(a)?"bg-red-50 border-red-100":W(a)?"bg-orange-50/50":r:F(a)?"bg-blue-50 border-blue-100":f.compact&&U(a).length?q(U(a)[0]):J(a)?"bg-red-50 border-red-100":W(a)?"bg-orange-50/50":r}function te(a){return f.selectable?b(a)?"text-white":J(a)?"text-red-600 font-bold":W(a)?"text-orange-400":"text-gray-700":F(a)?"text-blue-600":f.compact&&U(a).length?"text-white":J(a)?"text-red-600 font-bold":W(a)?"text-orange-400":"text-gray-700"}function N(a){return f.events.filter(r=>r.from_date&&r.to_date?_(a).isSameOrAfter(r.from_date,"day")&&_(a).isSameOrBefore(r.to_date,"day"):r.date===a)}function h(a){return N(a).slice(0,Je)}function m(a){const r=N(a).length;return Math.max(0,r-Je)}function P(a){return _(a).format("dddd, D [de] MMMM")}const U=N;function ae(a){const r=N(a);return r.length?r.map(p=>p.tooltip).join(`
`):""}function q(a){if(!a)return"";const r={green:"bg-green-500 border-green-600",orange:"bg-orange-500 border-orange-600",red:"bg-red-500 border-red-600",blue:"bg-blue-500 border-blue-600",purple:"bg-purple-500 border-purple-600",pink:"bg-pink-500 border-pink-600",yellow:"bg-yellow-500 border-yellow-600",teal:"bg-teal-500 border-teal-600",indigo:"bg-indigo-500 border-indigo-600",gray:"bg-gray-500 border-gray-600"};return r[a.color]||r.gray}function c(a){const r={green:"bg-green-100 text-green-700",orange:"bg-orange-100 text-orange-700",red:"bg-red-100 text-red-700",blue:"bg-blue-100 text-blue-700",purple:"bg-purple-100 text-purple-700",pink:"bg-pink-100 text-pink-700",yellow:"bg-yellow-100 text-yellow-700",teal:"bg-teal-100 text-teal-700",indigo:"bg-indigo-100 text-indigo-700",gray:"bg-gray-100 text-gray-700"};return r[a]||r.gray}function o(a){const r=c(a.color);return a.status==="Abierta"?`${r} border border-dashed border-current opacity-70`:r}return(a,r)=>(s(),l("div",ct,[e("div",pt,[e("h2",{class:j(["text-lg font-semibold text-gray-900 capitalize",k.compact?"text-sm":""])},u(g.value)+" "+u(v.value),3),k.hideControls?$("",!0):(s(),l("div",ft,[y(d(de),{icon:"chevron-left",variant:"ghost",onClick:G}),y(d(de),{icon:"chevron-right",variant:"ghost",onClick:K})]))]),e("div",mt,[(s(),l(R,null,L(O,p=>e("div",{key:p,class:"text-xs font-medium text-gray-500 text-center uppercase tracking-wide"},u(p),1)),64))]),e("div",gt,[(s(!0),l(R,null,L(M.value,p=>(s(),l("div",{key:`pad-${p}`,class:j(["bg-gray-50/50 rounded-md",k.compact?"h-8":k.selectable?"h-10":"h-24"])},null,2))),128)),(s(!0),l(R,null,L(x.value,p=>(s(),se(lt(k.compact&&d(U)(p.fullDate).length?d(me):"div"),{key:p.fullDate,text:k.compact?ae(p.fullDate):"",class:"contents"},{default:Y(()=>[e("div",{class:j(["relative border rounded-lg p-1 transition flex flex-col gap-1 cursor-pointer",[k.compact?"h-8 justify-center items-center":k.selectable?"h-10 justify-center items-center":"h-24",H(p.fullDate)]]),onClick:V=>Q(p.fullDate)},[e("span",{class:j(["font-medium",[te(p.fullDate),k.compact?"text-xs":"text-sm"]])},u(p.day),3),!k.compact&&J(p.fullDate)?(s(),l("div",vt," Festivo ")):$("",!0),k.compact?$("",!0):(s(),l("div",xt,[(s(!0),l(R,null,L(h(p.fullDate),(V,re)=>(s(),se(d(me),{key:V.id,text:V.tooltip},{default:Y(()=>[e("div",{class:j(["text-xs px-1.5 py-0.5 rounded truncate font-medium cursor-help",o(V)])},u(V.title),3)]),_:2},1032,["text"]))),128)),m(p.fullDate)>0?(s(),se(d(Ce),{key:0},{target:Y(({toggle:V})=>[e("button",{onClick:ge(V,["stop"]),class:"text-xs px-1.5 py-0.5 rounded bg-gray-100 text-gray-600 hover:bg-gray-200 font-medium text-center w-full"}," +"+u(m(p.fullDate))+" m\xE1s ",9,_t)]),body:Y(()=>[e("div",ht,[e("div",bt,u(P(p.fullDate)),1),e("div",wt,[(s(!0),l(R,null,L(N(p.fullDate),V=>(s(),l("div",{key:V.id,class:j(["text-xs px-2 py-1.5 rounded font-medium",o(V)])},[z(u(V.title)+" ",1),V.tooltip?(s(),l("div",kt,u(V.tooltip),1)):$("",!0)],2))),128))])])]),_:2},1024)):$("",!0)]))],10,yt)]),_:2},1032,["text"]))),128))])]))}};var we=$e($t,[["__scopeId","data-v-7ac73896"]]);const Ct={key:0,class:"p-8 text-center text-gray-500"},Dt={key:1,class:"p-5 text-base text-gray-800"},Mt={class:"grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8"},Yt={class:"lg:col-span-5 flex flex-col gap-5"},At={class:"flex flex-col gap-3 bg-gray-50 p-3 rounded-lg border border-gray-100 text-sm"},Et={class:"flex flex-col"},Vt={class:"flex items-center gap-2 mt-0.5"},St={class:"font-medium text-gray-900 truncate"},Pt={key:0,class:"flex flex-col"},Tt={class:"flex items-center gap-2 mt-0.5"},jt={class:"font-medium text-gray-900 truncate"},Bt={class:"flex flex-col"},Ot={class:"mt-1 flex flex-col gap-1 max-h-32 overflow-y-auto custom-scrollbar"},Ft={key:0,class:"text-gray-400 italic text-xs"},qt=["title"],Rt={class:"font-mono font-bold text-gray-700 bg-gray-100 px-1.5 py-0.5 rounded"},Lt={class:"flex flex-col gap-2"},zt={key:0,class:"flex flex-col gap-2"},It={class:"flex flex-col gap-2"},Ht={class:"flex items-center gap-2 cursor-pointer text-sm text-gray-700 select-none hover:text-gray-900"},Nt={class:"flex items-center gap-2 cursor-pointer text-sm text-gray-700 select-none hover:text-gray-900"},Ut={class:"lg:col-span-7 flex flex-col gap-4"},Wt={key:0,class:"flex flex-col gap-3 h-full"},Gt={class:"border rounded-xl p-2 bg-white shadow-sm flex-1 min-h-[320px]"},Jt={class:"flex items-center gap-3"},Xt={class:"flex flex-col"},Kt={class:"font-semibold text-base leading-tight"},Qt={key:0},Zt={key:1},ea={key:0,class:"text-xs opacity-90 mt-0.5"},ta={key:1,class:"flex flex-col gap-4 p-4 bg-gray-50 rounded-xl border border-dashed border-gray-200 h-full justify-center"},aa={class:"flex flex-col gap-2"},sa={class:"flex flex-col gap-2"},oa={key:0,class:"mt-4"},la={__name:"RequestDialog",props:{modelValue:Boolean,leaveTypes:{type:Array,default:()=>[]}},emits:["update:modelValue","success"],setup(k,{emit:C}){_.extend(Ge);const f=k,E=C,w=oe({url:"portal_rrhh.api.spanish_leave.get_leave_form_context",cache:!0}),A=oe({url:"portal_rrhh.api.spanish_leave.create_leave_application",makeParams(h){return{data:h}}}),B=S({get:()=>f.modelValue,set:h=>E("update:modelValue",h)});_e(B,h=>{h&&(w.fetch(),X())});const g=T({leave_type:"",request_type:"Por D\xEDas",description:"",hours:0,description:"",hours:0}),v=T(null),O=T(null),x=T({from:"",to:"",single:""}),M=T(null);function G(h){return _(h).format("DD/MM/YYYY")}function K(h){x.value.from=h.from,x.value.to=h.to}const F=S(()=>{var c;if(!x.value.from||!x.value.to)return{days:0,holidays:[],isError:!1};const h=_(x.value.from),m=_(x.value.to);if(m.isBefore(h))return{days:0,holidays:[],isError:!0,message:"Fecha fin anterior a inicio"};let P=0;const U=[],ae=((c=w.data)==null?void 0:c.holidays)||[];let q=h.clone();for(;q.isBefore(m)||q.isSame(m,"day");){const o=q.format("YYYY-MM-DD"),a=q.day()===0||q.day()===6,r=ae.includes(o);!a&&!r&&P++,r&&!a&&U.push(q.format("DD MMM")),q=q.add(1,"day")}return{days:P,holidays:U,isError:!1}}),J=S(()=>f.leaveTypes.map(h=>({label:h.leave_type_name,value:h.name}))),W=S(()=>f.leaveTypes.find(h=>h.name===g.value.leave_type)),Q=S(()=>{var h;return(h=W.value)==null?void 0:h.allow_hours_request});_e(()=>g.value.leave_type,()=>{Q.value||(g.value.request_type="Por D\xEDas")});const b=T(!1);function X(){g.value.leave_type="",g.value.request_type="Por D\xEDas",g.value.description="",g.value.hours=0,x.value={from:"",to:"",single:""},M.value=null,g.value.hours=0,x.value={from:"",to:"",single:""},M.value=null,b.value=!1,O.value=null,v.value&&(v.value.value="")}function H(h){const m=h.target.files[0];m?O.value=m:O.value=null}function te(h){return ie(this,null,function*(){if(!O.value)return;const m=new FormData;m.append("file",O.value),m.append("doctype","Spanish Leave Application"),m.append("docname",h);try{const P=yield fetch("/api/method/upload_file",{method:"POST",headers:{"X-Frappe-CSRF-Token":window.csrf_token||window.frappe&&window.frappe.csrf_token},body:m});P.ok||console.error("Upload failed",P)}catch(P){console.error("Error uploading file",P)}})}function N(){return ie(this,null,function*(){if(b.value)return;b.value=!0,M.value=null;const h=()=>{b.value=!1};if(!g.value.leave_type){M.value="Debes seleccionar un tipo de permiso.",h();return}const m=qe({},g.value);if(g.value.request_type==="Por D\xEDas"){if(!x.value.from||!x.value.to){M.value="Selecciona un rango de fechas completo.",h();return}if(x.value.from>x.value.to){M.value="La fecha de inicio no puede ser posterior a la fecha final.",h();return}if(F.value.days<=0){M.value="El rango seleccionado no contiene d\xEDas laborables efectivos.",h();return}m.from_date=x.value.from,m.to_date=x.value.to}else{if(!x.value.single){M.value="Selecciona una fecha.",h();return}if(!g.value.hours||g.value.hours<=0){M.value="Ingresa una cantidad de horas v\xE1lida.",h();return}m.request_date=x.value.single}try{const P=yield A.submit(m);O.value&&P&&(yield te(P)),E("success"),B.value=!1}catch(P){P.messages?M.value=P.messages.join(`
`):M.value=P.message||"Error al crear la solicitud"}finally{b.value=!1}})}return(h,m)=>{const P=he("Dialog");return s(),se(P,{modelValue:B.value,"onUpdate:modelValue":m[6]||(m[6]=U=>B.value=U),options:{title:"Nueva Solicitud de Vacaciones",size:"4xl",actions:[{label:"Enviar Solicitud",variant:"solid",loading:b.value,onClick:N}]}},{"body-content":Y(()=>{var U,ae,q,c,o,a,r;return[d(w).loading?(s(),l("div",Ct," Cargando informaci\xF3n... ")):(s(),l("div",Dt,[e("div",Mt,[e("div",Yt,[e("div",At,[e("div",Et,[m[7]||(m[7]=e("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide"},"Aprobador",-1)),e("div",Vt,[y(d(le),{name:"user-check",class:"h-4 w-4 text-blue-500"}),e("span",St,u(((ae=(U=d(w).data)==null?void 0:U.approver)==null?void 0:ae.name)||"No asignado"),1)])]),((q=d(w).data)==null?void 0:q.holiday_list_name)?(s(),l("div",Pt,[m[8]||(m[8]=e("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide"},"Calendario",-1)),e("div",Tt,[y(d(le),{name:"calendar",class:"h-3.5 w-3.5 text-orange-500"}),e("span",jt,u(d(w).data.holiday_list_name),1)])])):$("",!0),m[10]||(m[10]=e("div",{class:"h-px bg-gray-200 w-full"},null,-1)),e("div",Bt,[m[9]||(m[9]=e("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide"},"Tus Saldos",-1)),e("div",Ot,[((o=(c=d(w).data)==null?void 0:c.allocations)==null?void 0:o.length)?$("",!0):(s(),l("div",Ft," Sin asignaciones activas. ")),(s(!0),l(R,null,L((a=d(w).data)==null?void 0:a.allocations,p=>(s(),l("div",{key:p.name,class:"flex justify-between items-center bg-white px-2 py-1.5 rounded border border-gray-100 shadow-sm text-xs"},[e("span",{class:"truncate pr-2",title:p.contract_start_date},u(G(p.contract_start_date)),9,qt),e("span",Rt,u(parseFloat(p.days_remaining).toFixed(1))+"d",1)]))),128))])])]),e("div",Lt,[m[11]||(m[11]=e("label",{class:"font-medium text-gray-700 block text-sm"},"Tipo de Permiso",-1)),y(d(be),{modelValue:g.value.leave_type,options:J.value,placeholder:"Selecciona un tipo...","onUpdate:modelValue":m[0]||(m[0]=p=>g.value.leave_type=p.value)},null,8,["modelValue","options"])]),Q.value?(s(),l("div",zt,[m[14]||(m[14]=e("label",{class:"font-medium text-gray-700 block text-sm"},"Modo",-1)),e("div",It,[e("label",Ht,[De(e("input",{type:"radio","onUpdate:modelValue":m[1]||(m[1]=p=>g.value.request_type=p),value:"Por D\xEDas",name:"req_type",class:"text-gray-900 focus:ring-gray-900"},null,512),[[Re,g.value.request_type]]),m[12]||(m[12]=z(" Por D\xEDas (Jornada) ",-1))]),e("label",Nt,[De(e("input",{type:"radio","onUpdate:modelValue":m[2]||(m[2]=p=>g.value.request_type=p),value:"Por Horas",name:"req_type",class:"text-gray-900 focus:ring-gray-900"},null,512),[[Re,g.value.request_type]]),m[13]||(m[13]=z(" Por Horas (Parcial) ",-1))])])])):$("",!0),e("div",null,[y(d(Le),{label:"Motivo",type:"textarea",modelValue:g.value.description,"onUpdate:modelValue":m[3]||(m[3]=p=>g.value.description=p),rows:"3",placeholder:"Comentarios..."},null,8,["modelValue"])]),e("div",null,[m[15]||(m[15]=e("label",{class:"font-medium text-gray-700 block text-sm mb-2"},"Comprobante (Opcional)",-1)),e("input",{type:"file",ref_key:"fileInput",ref:v,onChange:H,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors cursor-pointer"},null,544)])]),e("div",Ut,[g.value.request_type==="Por D\xEDas"?(s(),l("div",Wt,[m[16]||(m[16]=e("div",{class:"flex justify-between items-end"},[e("label",{class:"font-medium text-gray-700 block text-sm"},"Selecci\xF3n de Fechas"),e("div",{class:"flex gap-3 text-[10px] text-gray-500"},[e("div",{class:"flex items-center gap-1"},[e("div",{class:"w-2.5 h-2.5 bg-blue-600 rounded-[2px]"}),e("span",null,"Selecci\xF3n")]),e("div",{class:"flex items-center gap-1"},[e("div",{class:"w-2.5 h-2.5 bg-red-50 border border-red-100 rounded-[2px]"}),e("span",{class:"text-red-600"},"Festivo")])])],-1)),e("div",Gt,[y(we,{selectable:!0,selection:{from:x.value.from,to:x.value.to},holidays:((r=d(w).data)==null?void 0:r.holidays)||[],"hide-controls":!1,"onUpdate:selection":K},null,8,["selection","holidays"])]),x.value.from?(s(),l("div",{key:0,class:j(["rounded-md border p-3 text-sm transition-all shadow-sm",F.value.isError?"bg-red-50 border-red-100 text-red-700":"bg-blue-50 border-blue-100 text-blue-800"])},[e("div",Jt,[y(d(le),{name:F.value.isError?"alert-circle":"info",class:"h-5 w-5 flex-shrink-0"},null,8,["name"]),e("div",Xt,[e("div",Kt,[x.value.to?(s(),l("span",Zt,u(F.value.days)+" d\xEDas efectivos",1)):(s(),l("span",Qt,"Selecciona fecha fin..."))]),F.value.holidays.length?(s(),l("div",ea," Excluye: "+u(F.value.holidays.join(", ")),1)):$("",!0)])])],2)):$("",!0)])):(s(),l("div",ta,[e("div",aa,[m[17]||(m[17]=e("label",{class:"font-medium text-gray-700 block text-sm"},"Fecha",-1)),y(d(rt),{modelValue:x.value.single,"onUpdate:modelValue":m[4]||(m[4]=p=>x.value.single=p),placeholder:"Selecciona fecha",class:"w-full"},null,8,["modelValue"])]),e("div",sa,[y(d(Le),{label:"Cantidad de Horas",type:"number",modelValue:g.value.hours,"onUpdate:modelValue":m[5]||(m[5]=p=>g.value.hours=p),placeholder:"Ej: 4.5",step:"0.5"},null,8,["modelValue"])])]))])]),M.value?(s(),l("div",oa,[y(d(nt),{message:M.value},null,8,["message"])])):$("",!0)]))]}),_:1},8,["modelValue","options"])}}};var ra=$e(la,[["__scopeId","data-v-1dc4e171"]]);const na={class:"gantt-container bg-white rounded-lg border shadow-sm overflow-hidden"},ia={class:"flex items-center justify-between px-4 py-3 border-b bg-gray-50"},da={class:"flex items-center gap-4"},ua={class:"text-sm text-gray-500"},ca={class:"flex items-center gap-2"},pa={class:"flex overflow-hidden",style:{height:"500px"}},fa={class:"truncate"},ma=["title"],ga={key:0,class:"p-6 text-sm text-gray-500 text-center"},ya={class:"sticky top-0 z-10 bg-white border-b"},va={class:"flex h-8 border-b bg-gray-50"},xa={class:"flex h-8"},_a={class:"flex flex-col items-center leading-tight"},ha={class:"font-medium"},ba={class:"text-[10px] uppercase"},wa={class:"relative"},ka={class:"absolute inset-0 flex"},$a=["onClick"],Ca={class:"text-[10px] font-medium text-white truncate"},Da={class:"font-semibold text-gray-900"},Ma={class:"text-gray-600 mt-1"},Ya={class:"text-gray-500 text-xs mt-1"},Aa={key:0,class:"mt-2"},Ea={key:1,class:"mt-2 text-xs text-gray-500 border-t pt-2"},Va={key:2,class:"mt-3 pt-3 border-t flex gap-2"},Sa={class:"px-4 py-3 border-t bg-gray-50 flex items-center gap-6"},Pa={class:"flex items-center gap-4 flex-wrap"},Ta={class:"text-xs text-gray-600"},ue=36,ve=42,ja={__name:"GanttChart",props:{leaves:{type:Array,default:()=>[]},employees:{type:Array,default:()=>[]},leaveTypes:{type:Array,default:()=>[]},canApprove:{type:Boolean,default:!0}},emits:["process"],setup(k,{emit:C}){_.extend(ut),_.extend(He),_.extend(Ue),_.locale("es");const f=k,E=C,w=T(_().startOf("week")),A=T(null),B=T(null),g=S(()=>w.value),v=S(()=>w.value.add(ve-1,"day")),O=S(()=>{const c=[];let o=g.value;for(let a=0;a<ve;a++)c.push({date:o.format("YYYY-MM-DD"),dayNum:o.format("D"),dayName:o.format("dd"),isWeekend:o.day()===0||o.day()===6,isToday:o.isSame(_(),"day"),dayjs:o}),o=o.add(1,"day");return c}),x=S(()=>{const c=[];let o=g.value;for(;o.isSameOrBefore(v.value);){const a=o.endOf("week"),p=(a.isAfter(v.value)?v.value:a).diff(o,"day")+1;c.push({start:o.format("YYYY-MM-DD"),weekNum:o.week(),label:o.format("D MMM"),days:p}),o=o.add(1,"week").startOf("week")}return c}),M=S(()=>ve*ue),G=S(()=>{const c=new Set;return f.leaves.forEach(o=>{const a=_(o.from_date||o.request_date);_(o.to_date||o.request_date).isSameOrAfter(g.value)&&a.isSameOrBefore(v.value)&&c.add(o.employee)}),c}),K=S(()=>{if(f.employees.length)return f.employees.filter(o=>G.value.has(o.name));const c=new Set;return f.leaves.filter(o=>{if(c.has(o.employee))return!1;const a=_(o.from_date||o.request_date);return!_(o.to_date||o.request_date).isSameOrAfter(g.value)||!a.isSameOrBefore(v.value)?!1:(c.add(o.employee),!0)}).map(o=>({name:o.employee,employee_name:o.employee_name}))}),F=S(()=>{const c=["blue","purple","teal","orange","pink","indigo","yellow","red","green"];return f.leaveTypes.map((o,a)=>({name:o.name,label:o.leave_type_name,color:c[a%c.length]}))});function J(){w.value=w.value.subtract(2,"week")}function W(){w.value=w.value.add(2,"week")}function Q(){w.value=_().startOf("week")}function b(c,o){return`${c.format("D MMM")} - ${o.format("D MMM YYYY")}`}function X(c){return f.leaves.filter(o=>{if(o.employee!==c)return!1;const a=_(o.from_date||o.request_date);return _(o.to_date||o.request_date).isSameOrAfter(g.value)&&a.isSameOrBefore(v.value)})}function H(c){const o=_(c.from_date||c.request_date),a=_(c.to_date||c.request_date);let r=o.diff(g.value,"day");r<0&&(r=0);let p=a.diff(g.value,"day");p>=ve&&(p=ve-1);const V=(p-r+1)*ue-2;return{left:`${r*ue+1}px`,width:`${Math.max(V,ue-2)}px`,top:"2px"}}function te(c){const o=F.value.find(p=>p.name===c.leave_type),a=(o==null?void 0:o.color)||"gray",r=N(a);return c.status==="Abierta"?`${r} border-2 border-dashed border-white/70 opacity-75`:`${r} border border-white/30`}function N(c){const o={blue:"bg-blue-500",purple:"bg-purple-500",teal:"bg-teal-500",orange:"bg-orange-500",pink:"bg-pink-500",indigo:"bg-indigo-500",yellow:"bg-yellow-500",red:"bg-red-500",green:"bg-green-500",gray:"bg-gray-500"};return o[c]||o.gray}function h(c){return{Aprobada:"bg-green-100 text-green-700",Abierta:"bg-orange-100 text-orange-700",Rechazada:"bg-red-100 text-red-700",Cancelada:"bg-gray-100 text-gray-700"}[c]||"bg-gray-100 text-gray-700"}function m(c){return c.isToday?"bg-blue-100 text-blue-700 font-semibold border-blue-200":c.isWeekend?"bg-orange-50 text-orange-600 border-orange-100":"bg-white text-gray-600 border-gray-100"}function P(c){return c.isToday?"bg-blue-50/50":c.isWeekend?"bg-orange-50/30":"bg-white"}function U(c){const o=_(c.from_date||c.request_date),a=_(c.to_date||c.request_date);return o.isSame(a,"day")?o.format("D [de] MMMM YYYY"):`${o.format("D MMM")} - ${a.format("D MMM YYYY")}`}function ae(c){A.value&&(A.value.scrollTop=c.target.scrollTop)}function q(c,o,a){E("process",{name:c,action:o}),a&&a()}return _e(()=>{var c;return(c=B.value)==null?void 0:c.scrollTop},c=>{A.value&&c!==void 0&&(A.value.scrollTop=c)}),(c,o)=>(s(),l("div",na,[e("div",ia,[e("div",da,[o[1]||(o[1]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Vista Gantt - Licencias del Equipo",-1)),e("span",ua,u(b(g.value,v.value)),1)]),e("div",ca,[y(d(de),{icon:"chevron-left",variant:"ghost",onClick:J,title:"Per\xEDodo anterior"}),y(d(de),{variant:"subtle",onClick:Q},{default:Y(()=>[...o[2]||(o[2]=[z("Hoy",-1)])]),_:1}),y(d(de),{icon:"chevron-right",variant:"ghost",onClick:W,title:"Per\xEDodo siguiente"})])]),e("div",pa,[e("div",{class:"flex-shrink-0 w-48 border-r bg-gray-50 overflow-y-auto",ref_key:"employeeColumn",ref:A},[o[4]||(o[4]=e("div",{class:"h-16 border-b bg-gray-100 flex items-end justify-center pb-2"},[e("span",{class:"text-xs font-medium text-gray-500 uppercase"},"Empleado")],-1)),(s(!0),l(R,null,L(K.value,a=>(s(),l("div",{key:a.name,class:"h-7 px-3 flex items-center border-b border-gray-100 hover:bg-gray-100 transition"},[e("div",fa,[e("div",{class:"text-xs font-medium text-gray-900 truncate",title:a.employee_name},u(a.employee_name),9,ma)])]))),128)),K.value.length?$("",!0):(s(),l("div",ga,[...o[3]||(o[3]=[e("div",{class:"text-gray-400 mb-1"},"No hay licencias",-1),e("div",{class:"text-xs"},"en este per\xEDodo",-1)])]))],512),e("div",{class:"flex-1 overflow-x-auto overflow-y-auto",ref_key:"ganttArea",ref:B,onScroll:ae},[e("div",ya,[e("div",va,[(s(!0),l(R,null,L(x.value,a=>(s(),l("div",{key:a.start,class:"flex-shrink-0 flex items-center justify-center border-r border-gray-200 text-xs font-medium text-gray-600",style:ye({width:`${a.days*ue}px`})}," Semana "+u(a.weekNum)+" - "+u(a.label),5))),128))]),e("div",xa,[(s(!0),l(R,null,L(O.value,a=>(s(),l("div",{key:a.date,class:j(["flex-shrink-0 flex items-center justify-center border-r text-xs",m(a)]),style:ye({width:`${ue}px`})},[e("div",_a,[e("span",ha,u(a.dayNum),1),e("span",ba,u(a.dayName),1)])],6))),128))])]),e("div",wa,[(s(!0),l(R,null,L(K.value,a=>(s(),l("div",{key:a.name,class:"h-7 flex items-center border-b border-gray-50 relative",style:ye({width:`${M.value}px`})},[e("div",ka,[(s(!0),l(R,null,L(O.value,r=>(s(),l("div",{key:r.date,class:j(["flex-shrink-0 border-r border-gray-50 h-full",P(r)]),style:ye({width:`${ue}px`})},null,6))),128))]),(s(!0),l(R,null,L(X(a.name),r=>(s(),se(d(Ce),{key:r.name,placement:"bottom","hover-delay":100,trigger:"click"},{target:Y(({open:p,close:V,isOpen:re})=>[e("div",{class:j(["absolute h-6 rounded cursor-pointer hover:brightness-110 transition-all flex items-center px-1.5 overflow-hidden",[te(r),re?"ring-2 ring-white ring-offset-1":""]]),style:ye(H(r)),onClick:ge(Me=>re?V():p(),["stop"])},[e("span",Ca,u(r.leave_type),1)],14,$a)]),body:Y(({close:p})=>[e("div",{class:"p-3 bg-white rounded-lg shadow-xl border text-sm min-w-[240px] max-w-[300px]",onClick:o[0]||(o[0]=ge(()=>{},["stop"]))},[e("div",Da,u(r.employee_name),1),e("div",Ma,u(r.leave_type),1),e("div",Ya,u(U(r)),1),r.status?(s(),l("div",Aa,[e("span",{class:j(["inline-block px-2 py-0.5 text-xs rounded font-medium",h(r.status)])},u(r.status),3)])):$("",!0),r.description?(s(),l("div",Ea,u(r.description),1)):$("",!0),r.status==="Abierta"&&k.canApprove?(s(),l("div",Va,[y(d(de),{variant:"subtle",theme:"red",size:"sm",class:"flex-1",onClick:ge(V=>q(r.name,"reject",p),["stop"])},{default:Y(()=>[...o[5]||(o[5]=[z(" Rechazar ",-1)])]),_:1},8,["onClick"]),y(d(de),{variant:"solid",theme:"green",size:"sm",class:"flex-1",onClick:ge(V=>q(r.name,"approve",p),["stop"])},{default:Y(()=>[...o[6]||(o[6]=[z(" Aprobar ",-1)])]),_:1},8,["onClick"])])):$("",!0)])]),_:2},1024))),128))],4))),128))])],544)]),e("div",Sa,[o[7]||(o[7]=e("span",{class:"text-xs font-medium text-gray-500 uppercase"},"Leyenda:",-1)),e("div",Pa,[(s(!0),l(R,null,L(F.value,a=>(s(),l("div",{key:a.name,class:"flex items-center gap-1.5"},[e("div",{class:j(["w-3 h-3 rounded",N(a.color)])},null,2),e("span",Ta,u(a.label),1)]))),128))])])]))}};var Ba=$e(ja,[["__scopeId","data-v-0b4dff37"]]);const Oa={class:"flex h-full flex-col overflow-hidden"},Fa={key:0,class:"flex items-center gap-6 text-sm text-gray-600 border-l pl-4 hidden sm:flex ml-4"},qa={class:"p-3 space-y-2 text-xs bg-white text-gray-900 rounded-lg shadow-xl border border-gray-200 min-w-[200px]"},Ra={class:"flex justify-between gap-4"},La={class:"font-medium font-mono"},za={class:"flex justify-between gap-4 text-green-600"},Ia={class:"font-medium font-mono"},Ha={class:"flex justify-between gap-4 text-orange-600"},Na={class:"font-medium font-mono"},Ua={class:"border-t pt-2 mt-1 flex justify-between gap-4 font-bold text-gray-900"},Wa={class:"font-mono"},Ga={key:0,class:"pt-2 border-t mt-1"},Ja={class:"flex justify-between gap-4"},Xa={class:"text-xs text-gray-400"},Ka={class:"flex flex-col cursor-help group"},Qa={class:"flex items-baseline gap-1"},Za={class:"text-xl font-bold text-gray-900 leading-none"},es={class:"text-xs text-gray-400 font-medium"},ts={key:0,class:"flex items-center gap-4 border-l pl-4 border-gray-200"},as={class:"flex flex-col items-start"},ss={class:"flex items-center gap-1.5 text-gray-900"},os={class:"font-bold leading-none"},ls={class:"flex items-center gap-1.5"},rs={class:"flex items-center gap-2"},ns={class:"p-3 w-48 bg-white rounded-lg shadow-xl border border-gray-100"},is={class:"flex flex-col gap-2"},ds={class:"text-sm text-gray-700"},us={class:"flex-1 overflow-hidden flex flex-col"},cs={class:"flex border-b bg-gray-50 px-5 justify-between items-center h-12 flex-shrink-0"},ps={class:"flex h-full gap-4"},fs={class:"flex h-full"},ms={key:0,class:"flex items-center h-full gap-2"},gs={class:"bg-white p-1 rounded-lg border shadow-sm inline-flex h-8 items-center"},ys={class:"bg-white p-1 rounded-lg border shadow-sm inline-flex h-8 items-center"},vs={key:0,class:"flex items-center gap-2"},xs={class:"bg-gray-200 rounded p-1 flex"},_s={key:1,class:"flex items-center gap-2"},hs={class:"w-40 sm:w-48"},bs={class:"w-32 sm:w-40"},ws={class:"w-32 sm:w-40"},ks={key:0,class:"flex items-center"},$s={class:"flex items-center gap-2 px-3 py-1.5 bg-white rounded-lg border shadow-sm cursor-pointer hover:bg-gray-50 transition-colors"},Cs={class:"h-full overflow-y-auto bg-gray-50 p-4"},Ds={key:0,class:"flex flex-col lg:flex-row gap-6 h-full"},Ms={class:"flex-1 h-full overflow-hidden flex flex-col"},Ys={key:0,class:"rounded-xl border bg-white p-4 shadow-sm h-full overflow-y-auto"},As={key:1,class:"flex flex-col gap-2 h-full overflow-hidden"},Es={class:"flex justify-between items-center bg-white px-4 py-2 rounded-lg border shadow-sm flex-shrink-0"},Vs={class:"flex items-center gap-2"},Ss={class:"text-base font-bold"},Ps={key:0,class:"text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded border"},Ts={class:"flex gap-1"},js={class:"flex-1 overflow-y-auto"},Bs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2"},Os={key:0,class:"w-full lg:w-80 flex-shrink-0 overflow-y-auto pb-10"},Fs={class:"flex flex-col gap-3"},qs={class:"flex justify-between items-center gap-2"},Rs={class:"min-w-0"},Ls=["title"],zs={class:"text-xs text-gray-500 mt-0.5 truncate"},Is={key:0},Hs={key:1},Ns={class:"flex items-center gap-2 flex-shrink-0"},Us={class:"text-xs font-medium"},Ws={key:1,class:"space-y-6"},Gs={key:0,class:"rounded-xl border bg-white p-4 shadow-sm h-[600px] overflow-hidden flex flex-col"},Js={key:1},Xs={key:2,class:"rounded-xl border bg-white shadow-sm overflow-hidden"},Ks={class:"border-b bg-gray-50 px-6 py-4 flex justify-between items-center"},Qs={class:"text-lg font-medium text-gray-900"},Zs={key:0,class:"text-xs text-gray-500 font-medium bg-white px-2 py-1 rounded border"},eo={key:0,class:"p-6 text-center text-gray-500"},to={key:1,class:"p-6 text-center text-gray-500 text-sm"},ao={key:2,class:"min-w-full divide-y divide-gray-200"},so={class:"bg-gray-50"},oo={key:0,class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},lo={class:"divide-y divide-gray-200 bg-white"},ro={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},no={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},io={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},uo={key:0},co={class:"ml-1 text-xs text-gray-400"},po={key:1},fo={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},mo={class:"px-6 py-4 whitespace-nowrap text-right text-sm"},go={key:0,class:"flex justify-end gap-2"},yo={key:1,class:"flex justify-end gap-2"},vo={key:2,class:"flex justify-end gap-2 mt-1"},xo={class:"text-xs font-medium"},_o={key:0,class:"space-y-3"},ho={class:"text-sm text-gray-600 mb-4"},bo={class:"font-medium"},wo={key:0,class:"ml-2 text-gray-500"},ko={key:1,class:"ml-2 text-gray-500"},$o={key:0,class:"divide-y divide-gray-100"},Co={class:"flex items-center gap-3 min-w-0 flex-1"},Do=["href","title"],Mo={key:1,class:"text-center text-gray-500 py-4"},Yo={class:"pt-3 border-t"},Po={__name:"SpanishLeave",setup(k){const C=T("my_leaves"),f=T("month"),E=T(!1),w=T(null),A=T(null),B=T(null),g=T(!1),v=T(null);function O(i){v.value=i,g.value=!0}const x=T("Pending"),M=T("list"),G=T(""),K=T(""),F=T(""),J=T(!0),W=T(_()),Q=oe({url:"portal_rrhh.api.spanish_leave.get_leave_form_context",auto:!0}),b=oe({url:"portal_rrhh.api.spanish_leave.get_dashboard_data",auto:!0}),X=oe({url:"portal_rrhh.api.spanish_leave.get_my_leaves",auto:!0}),H=oe({url:"portal_rrhh.api.spanish_leave.get_team_requests",auto:!0,makeParams(){return{status:x.value,employee:G.value,leave_type:F.value,location:K.value,only_my_team:J.value||void 0}}}),te=oe({url:"portal_rrhh.api.spanish_leave.get_team_leaves",auto:!0,makeParams(){return{month_start:_().subtract(6,"month").format("YYYY-MM-DD"),month_end:_().add(6,"month").format("YYYY-MM-DD"),employee:G.value,leave_type:F.value,location:K.value}}}),N=oe({url:"portal_rrhh.api.spanish_leave.get_my_team_members",auto:!0}),h=oe({url:"portal_rrhh.api.spanish_leave.process_request"}),m=oe({url:"portal_rrhh.api.spanish_leave.delete_attachment"});function P(i,t){return ie(this,null,function*(){w.value=i;try{yield h.submit({name:i,action:t}),H.reload(),te.reload(),b.reload()}catch(D){console.error(D)}finally{w.value=null}})}function U(D){return ie(this,arguments,function*({name:i,action:t}){yield P(i,t)})}function ae(){b.reload(),X.reload(),H.reload()}function q(i){var t;B.value=i,(t=A.value)==null||t.click()}function c(i){return ie(this,null,function*(){var ne,ee;const t=i.target.files[0];if(!t||!B.value)return;i.target.value="";const D=B.value;B.value=null;const Z=new FormData;Z.append("file",t),Z.append("doctype","Spanish Leave Application"),Z.append("docname",D);try{if((yield fetch("/api/method/upload_file",{method:"POST",headers:{"X-Frappe-CSRF-Token":window.csrf_token||window.frappe&&window.frappe.csrf_token},body:Z})).ok){if(window.frappe&&window.frappe.show_alert&&window.frappe.show_alert({message:"Comprobante adjuntado correctamente",indicator:"green"}),yield X.reload(),H.reload(),g.value&&((ne=v.value)==null?void 0:ne.name)===D){const fe=(ee=X.data)==null?void 0:ee.find(xe=>xe.name===D);fe&&(v.value=fe)}}else window.frappe&&window.frappe.show_alert&&window.frappe.show_alert({message:"Error al subir el archivo",indicator:"red"})}catch(pe){console.error(pe),window.frappe&&window.frappe.show_alert&&window.frappe.show_alert({message:"Error de conexi\xF3n",indicator:"red"})}})}function o(i){return ie(this,null,function*(){if(!v.value||!confirm("\xBFEst\xE1s seguro de que deseas eliminar este comprobante?"))return;const t=v.value.name;try{yield m.submit({file_name:i,docname:t}),v.value.attachments=v.value.attachments.filter(D=>D.name!==i),v.value.attachments.length===0&&(g.value=!1),window.frappe&&window.frappe.show_alert&&window.frappe.show_alert({message:"Comprobante eliminado correctamente",indicator:"green"}),X.reload(),H.reload()}catch(D){console.error(D),window.frappe&&window.frappe.show_alert&&window.frappe.show_alert({message:"Error al eliminar el archivo",indicator:"red"})}})}function a(){var i;!v.value||(B.value=v.value.name,(i=A.value)==null||i.click())}function r(i){return i?_(i).format("DD MMM YYYY"):"-"}function p(i){return i==="Aprobada"?"green":i==="Rechazada"?"red":i==="Abierta"?"orange":"gray"}function V(){W.value=W.value.subtract(1,"year")}function re(){W.value=W.value.add(1,"year")}const Me=S(()=>{const i=W.value.startOf("year"),t=[];for(let D=0;D<12;D++)t.push(i.add(D,"month"));return t});_e([x,G,K,F,J],()=>{H.fetch(),te.fetch()});const Xe=S(()=>N.data?N.data.map(i=>({label:i.employee_name,value:i.name})):[]),Ke=S(()=>{var t,D;const i=((t=Q.data)==null?void 0:t.rooms)||[];if((D=N.data)==null?void 0:D.length){const Z=new Set(N.data.map(ee=>ee.custom_centro).filter(Boolean)),ne=i.filter(ee=>Z.has(ee.name));if(ne.length>0)return ne.map(ee=>({label:ee.room_name,value:ee.name}))}return i.map(Z=>({label:Z.room_name,value:Z.name}))}),Qe=S(()=>{var i;return((i=b.data)==null?void 0:i.leave_types_config)?b.data.leave_types_config.map(t=>({label:t.leave_type_name,value:t.name})):[]});function Ze(i){return i?_(i).isAfter(_(),"day"):!1}const Ye=["blue","purple","teal","orange","pink","indigo","yellow","red","green"],Ae=S(()=>{var i;return((i=b.data)==null?void 0:i.leave_types_config)?b.data.leave_types_config.map((t,D)=>({name:t.name,label:t.leave_type_name,color:Ye[D%Ye.length]})):[]}),Ee=S(()=>{const i={Rechazada:"gray"};return Ae.value.forEach(t=>{i[t.name]=t.color}),i});function et(i){const t={green:"bg-green-500",orange:"bg-orange-500",red:"bg-red-500",blue:"bg-blue-500",purple:"bg-purple-500",pink:"bg-pink-500",teal:"bg-teal-500",indigo:"bg-indigo-500",yellow:"bg-yellow-500",gray:"bg-gray-500"};return t[i]||t.gray}const Ve=S(()=>X.data?X.data.map(i=>{let t=Ee.value[i.leave_type]||"gray";return i.status==="Rechazada"&&(t="gray"),{id:i.name,title:i.leave_type,tooltip:`${i.leave_type} (${i.status})${i.description?": "+i.description:""}`,color:t,from_date:i.request_type==="Por D\xEDas"?i.from_date:null,to_date:i.request_type==="Por D\xEDas"?i.to_date:null,date:i.request_type==="Por Horas"?i.request_date:null}}):[]),tt=S(()=>te.data?te.data.map(i=>{let t=Ee.value[i.leave_type]||"gray";return i.status==="Rechazada"&&(t="gray"),{id:i.name,title:`${i.employee_name} - ${i.leave_type}`,tooltip:`${i.employee_name}: ${i.leave_type} (${i.status})`,color:t,status:i.status,from_date:i.request_type==="Por D\xEDas"?i.from_date:null,to_date:i.request_type==="Por D\xEDas"?i.to_date:null,date:i.request_type==="Por Horas"?i.request_date:null}}):[]);return(i,t)=>{var ee,pe,fe,xe,Se,Pe,Te,je,Be;const D=he("Button"),Z=he("Card"),ne=he("Badge");return s(),l("div",Oa,[(s(),se(ze,{to:"#page-header-title-area"},[d(b).data?(s(),l("div",Fa,[y(d(me),null,{body:Y(()=>{var n,I;return[e("div",qa,[t[22]||(t[22]=e("div",{class:"font-semibold text-gray-900 border-b pb-1 mb-1"},"Desglose de Vacaciones",-1)),e("div",Ra,[t[17]||(t[17]=e("span",null,"Asignados:",-1)),e("span",La,u(d(b).data.total_days_allocated),1)]),e("div",za,[t[18]||(t[18]=e("span",null,"Disfrutados:",-1)),e("span",Ia,u(d(b).data.total_days_consumed),1)]),e("div",Ha,[t[19]||(t[19]=e("span",null,"Pendientes Aprob.:",-1)),e("span",Na,u(d(b).data.total_days_pending),1)]),e("div",Ua,[t[20]||(t[20]=e("span",null,"Disponibles:",-1)),e("span",Wa,u(d(b).data.total_days_remaining),1)]),d(b).data.total_hours_allocated>0?(s(),l("div",Ga,[t[21]||(t[21]=e("div",{class:"font-semibold text-xs text-gray-500 mb-1"},"Horas de Libre Disposici\xF3n",-1)),e("div",Ja,[e("span",null,"Disp: "+u((n=d(b).data.total_hours_remaining)==null?void 0:n.toFixed(2))+"h",1),e("span",Xa,"/ "+u((I=d(b).data.total_hours_allocated)==null?void 0:I.toFixed(2))+"h",1)])])):$("",!0)])]}),default:Y(()=>[e("div",Ka,[t[23]||(t[23]=e("span",{class:"text-xs text-gray-500 uppercase tracking-wider font-semibold group-hover:text-gray-800 transition-colors"},"D\xEDas Disfrutados",-1)),e("div",Qa,[e("span",Za,u(d(b).data.total_days_consumed),1),e("span",es,"/ "+u(d(b).data.total_days_allocated),1)])])]),_:1}),d(b).data.is_approver?(s(),l("div",ts,[y(d(me),{text:"Empleados bajo supervisi\xF3n"},{default:Y(()=>[e("div",as,[t[24]||(t[24]=e("span",{class:"text-xs text-gray-500 uppercase tracking-wider font-semibold"},"Equipo",-1)),e("div",ss,[y(d(le),{name:"users",class:"h-4 w-4 text-gray-400"}),e("span",os,u(d(b).data.team_members_count),1)])])]),_:1}),y(d(me),{text:"Solicitudes pendientes de aprobar"},{default:Y(()=>[e("div",{class:"flex flex-col items-start cursor-pointer",onClick:t[0]||(t[0]=n=>C.value="team")},[t[25]||(t[25]=e("span",{class:"text-xs text-gray-500 uppercase tracking-wider font-semibold"},"Pendientes",-1)),e("div",ls,[y(d(le),{name:"inbox",class:j(["h-4 w-4",d(b).data.pending_team_requests>0?"text-orange-500":"text-gray-400"])},null,8,["class"]),e("span",{class:j(["font-bold leading-none",d(b).data.pending_team_requests>0?"text-orange-600":"text-gray-900"])},u(d(b).data.pending_team_requests),3)])])]),_:1})])):$("",!0)])):$("",!0)])),(s(),se(ze,{to:"#page-header-actions"},[e("div",rs,[y(d(Ce),null,{target:Y(({toggle:n})=>[y(D,{variant:"ghost",icon:"info",onClick:n},null,8,["onClick"])]),body:Y(()=>[e("div",ns,[t[26]||(t[26]=e("div",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2"},"Tipos de Permiso",-1)),e("div",is,[(s(!0),l(R,null,L(Ae.value,n=>(s(),l("div",{key:n.name,class:"flex items-center gap-2"},[e("div",{class:j(["w-3 h-3 rounded-full flex-shrink-0 bg-gray-200",et(n.color)])},null,2),e("span",ds,u(n.label),1)]))),128))])])]),_:1}),y(D,{variant:"solid",onClick:t[1]||(t[1]=n=>E.value=!0)},{prefix:Y(()=>[y(d(le),{name:"plus",class:"h-4 w-4"})]),default:Y(()=>[t[27]||(t[27]=z(" Nueva Solicitud ",-1))]),_:1})])])),e("div",us,[e("div",cs,[e("div",ps,[e("div",fs,[e("button",{class:j(["border-b-2 px-4 h-full text-sm font-medium transition-colors flex items-center",C.value==="my_leaves"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700"]),onClick:t[2]||(t[2]=n=>C.value="my_leaves")}," Mis Vacaciones ",2),((ee=d(b).data)==null?void 0:ee.is_approver)?(s(),l("button",{key:0,class:j(["border-b-2 px-4 h-full text-sm font-medium transition-colors flex items-center",C.value==="team"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700"]),onClick:t[3]||(t[3]=n=>C.value="team")}," Gestionar Equipo ",2)):$("",!0)]),C.value==="team"?(s(),l("div",ms,[e("div",gs,[e("button",{class:j(["px-3 py-1 text-xs font-medium rounded-md transition-all h-full flex items-center",x.value==="Pending"?"bg-gray-100 text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"]),onClick:t[4]||(t[4]=n=>x.value="Pending")}," Pendientes ",2),e("button",{class:j(["px-3 py-1 text-xs font-medium rounded-md transition-all h-full flex items-center",x.value==="History"?"bg-gray-100 text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"]),onClick:t[5]||(t[5]=n=>x.value="History")}," Historial ",2)]),e("div",ys,[e("button",{class:j(["px-3 py-1 text-xs font-medium rounded-md transition-all h-full flex items-center gap-1",M.value==="list"?"bg-gray-100 text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"]),onClick:t[6]||(t[6]=n=>M.value="list")},[y(d(le),{name:"list",class:"h-3 w-3"}),t[28]||(t[28]=z(" Lista ",-1))],2),e("button",{class:j(["px-3 py-1 text-xs font-medium rounded-md transition-all h-full flex items-center gap-1",M.value==="calendar"?"bg-gray-100 text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"]),onClick:t[7]||(t[7]=n=>M.value="calendar")},[y(d(le),{name:"calendar",class:"h-3 w-3"}),t[29]||(t[29]=z(" Calif. ",-1))],2),e("button",{class:j(["px-3 py-1 text-xs font-medium rounded-md transition-all h-full flex items-center gap-1",M.value==="gantt"?"bg-gray-100 text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"]),onClick:t[8]||(t[8]=n=>M.value="gantt")},[y(d(le),{name:"bar-chart-2",class:"h-3 w-3 rotate-90"}),t[30]||(t[30]=z(" Gantt ",-1))],2)])])):$("",!0)]),C.value==="my_leaves"?(s(),l("div",vs,[e("div",xs,[e("button",{class:j(["px-3 py-1 text-xs font-medium rounded transition-colors",f.value==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"]),onClick:t[9]||(t[9]=n=>f.value="month")}," Mes ",2),e("button",{class:j(["px-3 py-1 text-xs font-medium rounded transition-colors",f.value==="year"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"]),onClick:t[10]||(t[10]=n=>f.value="year")}," A\xF1o ",2)])])):$("",!0),C.value==="team"?(s(),l("div",_s,[e("div",hs,[y(d(be),{modelValue:G.value,options:Xe.value,placeholder:"Empleados...","onUpdate:modelValue":t[11]||(t[11]=n=>G.value=(n==null?void 0:n.value)||"")},null,8,["modelValue","options"])]),e("div",bs,[y(d(be),{modelValue:K.value,options:Ke.value,placeholder:"Centro...","onUpdate:modelValue":t[12]||(t[12]=n=>K.value=(n==null?void 0:n.value)||"")},null,8,["modelValue","options"])]),e("div",ws,[y(d(be),{modelValue:F.value,options:Qe.value,placeholder:"Tipo...","onUpdate:modelValue":t[13]||(t[13]=n=>F.value=(n==null?void 0:n.value)||"")},null,8,["modelValue","options"])]),((pe=d(b).data)==null?void 0:pe.has_validar_hc_role)?(s(),l("div",ks,[e("label",$s,[De(e("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=n=>J.value=n),class:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"},null,512),[[it,J.value]]),t[31]||(t[31]=e("span",{class:"text-xs font-medium text-gray-700 whitespace-nowrap"},"Solo mi equipo",-1))])])):$("",!0)])):$("",!0)]),e("div",Cs,[C.value==="my_leaves"?(s(),l("div",Ds,[e("div",Ms,[f.value==="month"?(s(),l("div",Ys,[y(we,{events:Ve.value,holidays:((fe=d(Q).data)==null?void 0:fe.holidays)||[]},null,8,["events","holidays"])])):(s(),l("div",As,[e("div",Es,[e("div",Vs,[e("h2",Ss,u(W.value.format("YYYY")),1),((xe=d(Q).data)==null?void 0:xe.holiday_list_name)?(s(),l("span",Ps,u(d(Q).data.holiday_list_name),1)):$("",!0)]),e("div",Ts,[y(D,{icon:"chevron-left",onClick:V}),y(D,{icon:"chevron-right",onClick:re})])]),e("div",js,[e("div",Bs,[(s(!0),l(R,null,L(Me.value,n=>{var I;return s(),l("div",{key:n.toISOString(),class:"rounded-lg border bg-white p-2 shadow-sm"},[y(we,{events:Ve.value,"model-date":n,"hide-controls":!0,compact:!0,holidays:((I=d(Q).data)==null?void 0:I.holidays)||[],class:"text-xs"},null,8,["events","model-date","holidays"])])}),128))])])]))]),f.value==="month"?(s(),l("div",Os,[e("div",Fs,[t[33]||(t[33]=e("h3",{class:"ml-1 text-lg font-medium"},"\xDAltimas Solicitudes",-1)),((Se=d(X).data)==null?void 0:Se.length)?$("",!0):(s(),se(Z,{key:0,class:"p-4 text-gray-500 text-center"},{default:Y(()=>[...t[32]||(t[32]=[z(" No tienes solicitudes recientes. ",-1)])]),_:1})),(s(!0),l(R,null,L(d(X).data,n=>(s(),se(Z,{key:n.name,class:"p-3 transition hover:shadow-md bg-white border border-gray-100"},{default:Y(()=>{var I;return[e("div",qs,[e("div",Rs,[e("div",{class:"font-medium text-gray-900 text-sm truncate",title:n.leave_type},u(n.leave_type),9,Ls),e("div",zs,[n.request_type==="Por D\xEDas"?(s(),l("span",Is,u(r(n.from_date))+" - "+u(r(n.to_date)),1)):(s(),l("span",Hs,u(r(n.request_date))+" ("+u(n.total_hours)+"h) ",1))])]),e("div",Ns,[y(D,{variant:"subtle",size:"sm",icon:"plus",onClick:ce=>q(n.name),title:"A\xF1adir comprobante",class:"text-gray-600 hover:text-gray-900"},null,8,["onClick"]),((I=n.attachments)==null?void 0:I.length)>0?(s(),se(D,{key:0,variant:"subtle",size:"sm",icon:"file-text",class:"text-blue-600 bg-blue-50 hover:bg-blue-100 border-blue-100",onClick:ce=>O(n),title:`Ver ${n.attachments.length} comprobante(s)`},{suffix:Y(()=>[e("span",Us,u(n.attachments.length),1)]),_:2},1032,["onClick","title"])):$("",!0),y(ne,{variant:p(n.status),class:"text-[10px] px-1.5 py-0.5"},{default:Y(()=>[z(u(n.status),1)]),_:2},1032,["variant"])])])]}),_:2},1024))),128))])])):$("",!0)])):C.value==="team"?(s(),l("div",Ws,[M.value==="calendar"?(s(),l("div",Gs,[y(we,{events:tt.value,selectable:!1},null,8,["events"])])):M.value==="gantt"?(s(),l("div",Js,[y(Ba,{leaves:d(te).data||[],employees:d(N).data||[],"leave-types":((Pe=d(b).data)==null?void 0:Pe.leave_types_config)||[],"can-approve":(Te=d(b).data)==null?void 0:Te.is_approver,onProcess:U},null,8,["leaves","employees","leave-types","can-approve"])])):(s(),l("div",Xs,[e("div",Ks,[e("h3",Qs,u(x.value==="Pending"?"Solicitudes Pendientes":"Historial de Equipo"),1),d(H).data?(s(),l("span",Zs,u(d(H).data.length)+" registros ",1)):$("",!0)]),d(H).loading?(s(),l("div",eo,"Cargando...")):((je=d(H).data)==null?void 0:je.length)?(s(),l("table",ao,[e("thead",so,[e("tr",null,[t[34]||(t[34]=e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Empleado",-1)),t[35]||(t[35]=e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Tipo",-1)),t[36]||(t[36]=e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Fechas",-1)),x.value==="History"?(s(),l("th",oo,"Estado")):$("",!0),t[37]||(t[37]=e("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500"},"Acciones",-1))])]),e("tbody",lo,[(s(!0),l(R,null,L(d(H).data,n=>{var I;return s(),l("tr",{key:n.name},[e("td",ro,u(n.employee_name),1),e("td",no,u(n.leave_type),1),e("td",io,[n.request_type==="Por D\xEDas"?(s(),l("span",uo,[z(u(r(n.from_date))+" - "+u(r(n.to_date))+" ",1),e("span",co,"("+u(n.total_days)+" d\xEDas)",1)])):(s(),l("span",po,u(r(n.request_date))+" ("+u(n.total_hours)+"h) ",1))]),x.value==="History"?(s(),l("td",fo,[y(ne,{variant:p(n.status)},{default:Y(()=>[z(u(n.status),1)]),_:2},1032,["variant"])])):$("",!0),e("td",mo,[n.status==="Abierta"?(s(),l("div",go,[y(D,{variant:"subtle",color:"red",onClick:ce=>P(n.name,"reject"),loading:w.value===n.name},{default:Y(()=>[...t[38]||(t[38]=[z(" Rechazar ",-1)])]),_:1},8,["onClick","loading"]),y(D,{variant:"solid",color:"green",onClick:ce=>P(n.name,"approve"),loading:w.value===n.name},{default:Y(()=>[...t[39]||(t[39]=[z(" Aprobar ",-1)])]),_:1},8,["onClick","loading"])])):n.status==="Aprobada"&&Ze(n.to_date||n.request_date)?(s(),l("div",yo,[y(D,{variant:"subtle",color:"gray",onClick:ce=>P(n.name,"cancel"),loading:w.value===n.name},{default:Y(()=>[...t[40]||(t[40]=[z(" Cancelar ",-1)])]),_:1},8,["onClick","loading"])])):$("",!0),((I=n.attachments)==null?void 0:I.length)>0?(s(),l("div",vo,[y(D,{variant:"ghost",icon:"paperclip",onClick:ce=>O(n),title:`Ver ${n.attachments.length} comprobante(s)`,class:"text-blue-600 hover:bg-blue-50"},{suffix:Y(()=>[e("span",xo,u(n.attachments.length),1)]),_:2},1032,["onClick","title"])])):$("",!0)])])}),128))])])):(s(),l("div",to," No hay solicitudes en esta vista. "))]))])):$("",!0)])]),y(ra,{modelValue:E.value,"onUpdate:modelValue":t[15]||(t[15]=n=>E.value=n),"leave-types":((Be=d(b).data)==null?void 0:Be.leave_types_config)||[],onSuccess:ae},null,8,["modelValue","leave-types"]),e("input",{type:"file",ref_key:"listFileInput",ref:A,class:"hidden",onChange:c},null,544),y(d(dt),{modelValue:g.value,"onUpdate:modelValue":t[16]||(t[16]=n=>g.value=n),options:{title:"Comprobantes Adjuntos",size:"md"}},{"body-content":Y(()=>{var n;return[v.value?(s(),l("div",_o,[e("div",ho,[e("span",bo,u(v.value.leave_type),1),v.value.request_type==="Por D\xEDas"?(s(),l("span",wo," ("+u(r(v.value.from_date))+" - "+u(r(v.value.to_date))+") ",1)):(s(),l("span",ko," ("+u(r(v.value.request_date))+") ",1))]),((n=v.value.attachments)==null?void 0:n.length)>0?(s(),l("div",$o,[(s(!0),l(R,null,L(v.value.attachments,I=>(s(),l("div",{key:I.name,class:"flex items-center justify-between gap-3 py-3 group"},[e("div",Co,[y(d(le),{name:"file",class:"h-5 w-5 text-gray-400 flex-shrink-0"}),e("a",{href:I.file_url,target:"_blank",class:"text-sm text-blue-600 hover:text-blue-800 truncate",title:I.file_name},u(I.file_name||"Archivo"),9,Do)]),y(D,{variant:"ghost",size:"sm",icon:"trash-2",class:"text-red-500 hover:text-red-700 hover:bg-red-50 flex-shrink-0",onClick:ce=>o(I.name),title:"Eliminar"},null,8,["onClick"])]))),128))])):(s(),l("div",Mo," No hay comprobantes adjuntos ")),e("div",Yo,[y(D,{variant:"subtle",icon:"plus",onClick:a,class:"w-full"},{default:Y(()=>[...t[41]||(t[41]=[z(" A\xF1adir comprobante ",-1)])]),_:1})])])):$("",!0)]}),_:1},8,["modelValue"])])}}};export{Po as default};
