var Ae=Object.defineProperty,Ge=Object.defineProperties;var He=Object.getOwnPropertyDescriptors;var ye=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var be=(h,m,d)=>m in h?Ae(h,m,{enumerable:!0,configurable:!0,writable:!0,value:d}):h[m]=d,we=(h,m)=>{for(var d in m||(m={}))We.call(m,d)&&be(h,d,m[d]);if(ye)for(var d of ye(m))Je.call(m,d)&&be(h,d,m[d]);return h},ke=(h,m)=>Ge(h,He(m));var q=(h,m,d)=>new Promise((P,F)=>{var V=E=>{try{L(d.next(E))}catch(A){F(A)}},z=E=>{try{L(d.throw(E))}catch(A){F(A)}},L=E=>E.done?P(E.value):Promise.resolve(E.value).then(V,z);L((d=d.apply(h,m)).next())});import{z as Ce,_ as de,ac as Ke,ad as Qe,ae as Xe,af as Ze,ag as ea,G as Q,o as _,s as W,w as y,b as r,d as v,n as se,c as k,t as u,T as aa,W as Ve,F as oe,E as ne,f as R,ah as De,r as C,q as le,a8 as ta,u as c,Q as B,C as Ye,e as M,J as sa,ai as oa,aa as b,aj as na,R as Te}from"./vendor.0086aa74.js";import{d as T}from"./es.72676fb6.js";import{w as la}from"./weekOfYear.315d1410.js";const ra={name:"SearchableAutocomplete",props:["modelValue","options","placeholder"],emits:["update:modelValue","update:query"],components:{FeatherIcon:de,Combobox:Ke,ComboboxInput:Qe,ComboboxOptions:Xe,ComboboxOption:Ze,ComboboxButton:ea},data(){return{query:""}},watch:{query(h){this.$emit("update:query",h)}},computed:{valuePropPassed(){return"value"in this.$attrs},selectedValue:{get(){return this.valuePropPassed?this.$attrs.value:this.modelValue},set(h){this.$emit(this.valuePropPassed?"change":"update:modelValue",h)}},groups(){var m;return!this.options||this.options.length==0?[]:(((m=this.options[0])==null?void 0:m.group)?this.options:[{group:"",items:this.options}]).map((d,P)=>({key:P,group:d.group,hideLabel:d.hideLabel||!1,items:d.items})).filter(d=>d.items.length>0)}},methods:{displayValue(h){return h?typeof h=="string"?h:h==null?void 0:h.label:""}}},ua={class:"relative w-full"},da={class:"w-full"},ia={key:0,class:"overflow-hidden text-ellipsis text-base leading-5"},ca={key:1,class:"text-base leading-5 text-gray-500"},pa={class:"sticky top-0 mb-1.5 flex items-stretch space-x-1.5 bg-white pt-1.5"},_a={key:0,class:"px-2 py-1 text-xs font-semibold uppercase tracking-wider text-gray-500"},ma={key:0,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"};function ha(h,m,d,P,F,V){const z=Q("FeatherIcon"),L=Q("ComboboxButton"),E=Q("ComboboxInput"),A=Q("ComboboxOption"),N=Q("ComboboxOptions"),S=Q("Combobox");return _(),W(S,{modelValue:V.selectedValue,"onUpdate:modelValue":m[1]||(m[1]=w=>V.selectedValue=w),nullable:""},{default:y(({open:w})=>[r("div",ua,[r("div",da,[v(L,{class:se(["flex w-full items-center justify-between rounded-md bg-gray-100 py-1 pl-3 pr-2 transition-colors hover:bg-gray-200",{"rounded-b-none":w}])},{default:y(()=>[V.selectedValue?(_(),k("span",ia,u(V.displayValue(V.selectedValue)),1)):(_(),k("span",ca,u(d.placeholder||"Select..."),1)),v(z,{name:"chevron-down",class:"h-4 w-4 text-gray-500","aria-hidden":"true"})]),_:1},8,["class"])]),v(aa,{"leave-active-class":"transition duration-100 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:y(()=>[Ve(v(N,{class:"absolute z-10 max-h-[15rem] w-full overflow-y-auto rounded-md rounded-t-none bg-white px-1.5 pb-1.5 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:y(()=>[r("div",pa,[v(E,{class:"form-input w-full placeholder-gray-500 text-sm",type:"text",onChange:m[0]||(m[0]=D=>{F.query=D.target.value}),value:F.query,autocomplete:"off",placeholder:d.placeholder||"Search..."},null,8,["value","placeholder"])]),(_(!0),k(oe,null,ne(V.groups,D=>Ve((_(),k("div",{key:D.key},[D.group&&!D.hideLabel?(_(),k("div",_a,u(D.group),1)):R("",!0),(_(!0),k(oe,null,ne(D.items,O=>(_(),W(A,{as:"template",key:O.value,value:O},{default:y(({active:j,selected:$})=>[r("li",{class:se(["relative cursor-default select-none rounded-md px-2.5 py-1.5 text-base",{"bg-gray-100 text-gray-900":j,"text-gray-900":!j}])},[r("span",{class:se(["block truncate",{"font-medium":$}])},u(O.label),3)],2)]),_:2},1032,["value"]))),128))])),[[De,D.items.length>0]])),128)),V.groups.length==0?(_(),k("li",ma," No results found ")):R("",!0)]),_:1},512),[[De,w]])]),_:2},1024)])]),_:1},8,["modelValue"])}var ie=Ce(ra,[["render",ha]]);const fa={class:"flex flex-col h-full overflow-hidden"},va={class:"flex-1 overflow-y-auto p-5"},ga={class:"mb-6 flex items-center justify-between"},xa={class:"text-2xl font-bold text-gray-900"},ya={class:"flex space-x-2"},ba={key:0,class:"bg-white rounded shadow p-4"},wa={key:0,class:"text-center py-4"},ka={key:1,class:"text-center py-4 text-gray-500"},Ca={key:2,class:"divide-y"},Va={class:"flex items-center space-x-4"},Da={class:"flex items-center space-x-3"},Ya={class:"text-gray-900 font-medium"},Ta={class:"flex items-center space-x-1"},Sa={key:3,class:"mt-4 text-center border-t pt-4"},$a={key:1,class:"bg-white rounded shadow p-4"},Ba={class:"mb-4 flex items-center justify-between bg-gray-50 p-3 rounded"},Ma={class:"flex items-center space-x-4"},Pa={class:"text-lg font-medium"},Ea={class:"flex items-center space-x-4"},Na={class:"flex items-center space-x-2"},ja={class:"text-xs uppercase text-gray-500 font-bold tracking-wider"},Ua={class:"text-lg font-semibold mb-2"},qa={class:"space-y-4"},Oa={class:"grid grid-cols-12 gap-2 text-sm font-medium text-gray-500 border-b pb-2"},Ia={class:"col-span-2"},La={class:"col-span-3"},Ra={class:"text-xs text-gray-400"},Fa={class:"col-span-2"},za={class:"text-xs text-gray-400"},Aa={class:"col-span-3"},Ga={class:"text-xs text-gray-400"},Ha={class:"col-span-1"},Wa={class:"col-span-1 text-right"},Ja={class:"col-span-2"},Ka={class:"col-span-3"},Qa=["onClickCapture"],Xa=["onClickCapture"],Za={class:"col-span-1"},et={class:"col-span-1 text-right pt-1"},at={key:0,class:"pt-2"},tt={class:"mt-8 flex justify-end space-x-3 pt-4 border-t"},st={class:"mt-2"},ce=20,ot={__name:"Timesheets",setup(h){const m=oa;T.extend(la),T.locale("es");const d=C("list"),P=C(!1),F=C(!1),V=C(!1),z=C([]),L=C(!0),E=C(0),A=C([]),N=C([]),S=C([]),w=C([]),D=C({}),O=C({}),j=C(T().startOf("week").format("YYYY-MM-DD")),$=C([]),J=C(!1),X=C(!1),pe=C(""),re=le(()=>T(j.value).endOf("week").format("YYYY-MM-DD")),Se=le(()=>{const t=[];let e=T(j.value);for(let s=0;s<7;s++)t.push({value:e.add(s,"day").format("YYYY-MM-DD"),label:e.add(s,"day").format("dddd")+" ("+je(e.add(s,"day"))+")"});return t}),ee=le(()=>$.value.reduce((t,e)=>t+(parseFloat(e.hours)||0),0)),G=le(()=>O.value.docstatus===1),ae=(t=!0)=>q(this,null,function*(){t?(P.value=!0,E.value=0,z.value=[],L.value=!0):F.value=!0;try{const e=yield b("portal_rrhh.api.timesheets.get_timesheets",{start:E.value,page_length:ce});e&&e.length>0?(z.value=t?e:[...z.value,...e],E.value+=ce,e.length<ce&&(L.value=!1)):L.value=!1}catch(e){console.error(e)}finally{P.value=!1,F.value=!1}}),$e=()=>{ae(!1)},Be=()=>q(this,null,function*(){try{const[t,e,s,l,a]=yield Promise.all([b("portal_rrhh.api.timesheets.get_sedes"),b("portal_rrhh.api.timesheets.get_user_settings"),b("portal_rrhh.api.timesheets.get_courses",{limit:50}),b("portal_rrhh.api.timesheets.get_programs",{limit:50}),b("portal_rrhh.api.timesheets.get_planes",{limit:50})]);A.value=t||[],D.value=e||{},N.value=s||[],S.value=l||[],w.value=a||[]}catch(t){console.error(t)}}),_e=m((t,e,s)=>q(this,null,function*(){const l=typeof e=="object"&&e!==null?e.value:e,a=typeof s=="object"&&s!==null?s.value:s;try{const p=yield b("portal_rrhh.api.timesheets.get_courses",{txt:t,program:l,plan:a,limit:50});N.value=p||[]}catch(p){console.error(p)}}),300),me=m((t,e)=>q(this,null,function*(){const s=typeof e=="object"&&e!==null?e.value:e;try{const l=yield b("portal_rrhh.api.timesheets.get_programs",{txt:t,plan:s,limit:50});S.value=l||[]}catch(l){console.error(l)}}),300),Me=m(t=>q(this,null,function*(){try{const e=yield b("portal_rrhh.api.timesheets.get_planes",{txt:t,limit:50});w.value=e||[]}catch(e){console.error(e)}}),300),Pe=(t,e)=>{if((e==null?void 0:e.value)==="__todos__"||e==="__todos__"){t.plan={label:"\u{1F4CB} Todos (General)",value:"__todos__"},t.expediente={label:"\u{1F4CB} Todos",value:"__todos__"},t.course={label:"\u{1F4CB} Todos",value:"__todos__"};return}t.expediente=null,t.course=null},Ee=(t,e)=>q(this,null,function*(){if((e==null?void 0:e.value)==="__todos__"||e==="__todos__"){t.expediente={label:"\u{1F4CB} Todos",value:"__todos__"},t.course={label:"\u{1F4CB} Todos",value:"__todos__"};return}if(t.course=null,!e)return;const s=typeof e=="object"&&(e==null?void 0:e.value)?e.value:e;let l=S.value.find(a=>a.name===s);if(l&&l.custom_plan&&!t.plan){let a=w.value.find(p=>p.name===l.custom_plan);if(!a)try{const p=yield b("portal_rrhh.api.timesheets.get_planes",{txt:l.custom_plan});p&&p.length>0&&(a=p.find(f=>f.name===l.custom_plan)||p[0],a&&w.value.push(a))}catch(p){console.error(p)}a?t.plan={label:(a.n_plan_formativo?`[${a.n_plan_formativo}] `:"")+(a.custom_descripci\u00F3n_del_plan||a.name),value:a.name}:t.plan=l.custom_plan}}),Ne=(t,e)=>{if((e==null?void 0:e.value)==="__todos__"||e==="__todos__"){t.course={label:"\u{1F4CB} Todos",value:"__todos__"};return}if(!e)return;const s=typeof e=="object"&&(e==null?void 0:e.value)?e.value:e,l=N.value.find(a=>a.name===s);if(l&&l.expediente){const a=S.value.find(f=>f.name===l.expediente);t.expediente=a?{label:a.custom_num_de_expediente,value:a.name}:l.expediente;const p=l.custom_plan||(a?a.custom_plan:null);if(p){const f=w.value.find(o=>o.name===p);t.plan=f?{label:f.custom_descripci\u00F3n_del_plan||f.name,value:f.name}:p}}},te=t=>T(t).format("DD/MM/YYYY"),je=t=>T(t).format("DD/MM"),he=t=>t==="Submitted"||t==="Aprobado"?"green":t==="Draft"||t==="Borrador"?"yellow":t==="Rejected"||t==="Rechazado"?"red":"gray",Ue=t=>q(this,null,function*(){if(!!confirm(i("\xBFEst\xE1s seguro de que quieres eliminar este borrador?")))try{yield b("portal_rrhh.api.timesheets.delete_timesheet",{name:t}),ae(!0)}catch(e){console.error(e)}}),fe=t=>({Draft:"Borrador",Submitted:"Validado",Cancelled:"Cancelado",Borrador:"Borrador"})[t]||t,qe=()=>{O.value={status:"Borrador"};const t=T().startOf("week");j.value=t.format("YYYY-MM-DD"),$.value=[];for(let e=0;e<5;e++)$.value.push({date:t.add(e,"day").format("YYYY-MM-DD"),hours:0,sede:D.value.default_sede?{label:D.value.default_sede_name,value:D.value.default_sede}:null,course:null,expediente:null,plan:null});J.value=!0,d.value="edit"},ve=t=>q(this,null,function*(){P.value=!0;try{const e=yield b("portal_rrhh.api.timesheets.get_timesheet_details",{name:t});O.value=e,j.value=e.start_date;const s=[...new Set((e.custom_sede_time_logs||[]).map(o=>o.plan).filter(Boolean))],l=[...new Set((e.custom_sede_time_logs||[]).map(o=>o.expediente).filter(Boolean))],a=[...new Set((e.custom_sede_time_logs||[]).map(o=>o.course).filter(Boolean))],p=[];s.length>0&&s.forEach(o=>{p.push(b("portal_rrhh.api.timesheets.get_planes",{txt:o}).then(g=>g?g.find(U=>U.name===o):null))}),l.length>0&&l.forEach(o=>{p.push(b("portal_rrhh.api.timesheets.get_programs",{txt:o}).then(g=>g?g.find(U=>U.name===o):null))}),a.length>0&&a.forEach(o=>{p.push(b("portal_rrhh.api.timesheets.get_courses",{txt:o}).then(g=>g?g.find(U=>U.name===o):null))}),(yield Promise.all(p)).filter(Boolean).forEach(o=>{o.n_plan_formativo!==void 0?w.value.find(g=>g.name===o.name)||w.value.push(o):o.program_name!==void 0?S.value.find(g=>g.name===o.name)||S.value.push(o):o.course_name!==void 0&&(N.value.find(g=>g.name===o.name)||N.value.push(o))}),$.value=(e.custom_sede_time_logs||[]).map(o=>{const g=o.sede?A.value.find(Y=>Y.name===o.sede):null,U=o.course?N.value.find(Y=>Y.name===o.course):null,n=o.expediente?S.value.find(Y=>Y.name===o.expediente):null,x=o.plan?w.value.find(Y=>Y.name===o.plan):null,I=Y=>({label:`\u{1F4CB} ${Y}`,value:"__todos__"});return{date:o.date,hours:o.hours,sede:g?{label:g.room_name,value:o.sede}:o.sede,course:o.course?U?{label:(U.custom_display_identifier?`[${U.custom_display_identifier}] `:"")+(U.course_name||U.name),value:o.course,link_program:U.expediente}:o.course:I("Todos"),expediente:o.expediente?n?{label:(n.custom_num_de_expediente?`[${n.custom_num_de_expediente}] `:"")+(n.program_name||n.name),value:o.expediente,link_plan:n.custom_plan}:o.expediente:I("Todos"),plan:o.plan?x?{label:(x.n_plan_formativo?`[${x.n_plan_formativo}] `:"")+(x.custom_descripci\u00F3n_del_plan||x.name),value:o.plan}:o.plan:I("Todos (General)")}}),J.value=!1,d.value="edit"}catch(e){console.error(e)}finally{P.value=!1}}),Oe=t=>q(this,null,function*(){P.value=!0;try{const e=yield b("portal_rrhh.api.timesheets.get_timesheet_details",{name:t});O.value={status:"Borrador"},J.value=!0;const s=T(e.start_date),l=T().startOf("week"),a=l.diff(s,"day");j.value=l.format("YYYY-MM-DD");const p=[...new Set((e.custom_sede_time_logs||[]).map(n=>n.plan).filter(Boolean))],f=[...new Set((e.custom_sede_time_logs||[]).map(n=>n.expediente).filter(Boolean))],o=[...new Set((e.custom_sede_time_logs||[]).map(n=>n.course).filter(Boolean))],g=[];p.length>0&&p.forEach(n=>{g.push(b("portal_rrhh.api.timesheets.get_planes",{txt:n}).then(x=>x?x.find(I=>I.name===n):null))}),f.length>0&&f.forEach(n=>{g.push(b("portal_rrhh.api.timesheets.get_programs",{txt:n}).then(x=>x?x.find(I=>I.name===n):null))}),o.length>0&&o.forEach(n=>{g.push(b("portal_rrhh.api.timesheets.get_courses",{txt:n}).then(x=>x?x.find(I=>I.name===n):null))}),(yield Promise.all(g)).filter(Boolean).forEach(n=>{n.n_plan_formativo!==void 0?w.value.find(x=>x.name===n.name)||w.value.push(n):n.program_name!==void 0?S.value.find(x=>x.name===n.name)||S.value.push(n):n.course_name!==void 0&&(N.value.find(x=>x.name===n.name)||N.value.push(n))}),$.value=(e.custom_sede_time_logs||[]).map(n=>{const x=T(n.date).add(a,"day").format("YYYY-MM-DD"),I=n.sede?A.value.find(H=>H.name===n.sede):null,Y=n.course?N.value.find(H=>H.name===n.course):null,K=n.expediente?S.value.find(H=>H.name===n.expediente):null,Z=n.plan?w.value.find(H=>H.name===n.plan):null,ue=H=>({label:`\u{1F4CB} ${H}`,value:"__todos__"});return{date:x,hours:n.hours,sede:I?{label:I.room_name,value:n.sede}:n.sede,course:n.course?Y?{label:(Y.custom_display_identifier?`[${Y.custom_display_identifier}] `:"")+(Y.course_name||Y.name),value:n.course,link_program:Y.expediente}:n.course:ue("Todos"),expediente:n.expediente?K?{label:(K.custom_num_de_expediente?`[${K.custom_num_de_expediente}] `:"")+(K.program_name||K.name),value:n.expediente,link_plan:K.custom_plan}:n.expediente:ue("Todos"),plan:n.plan?Z?{label:(Z.n_plan_formativo?`[${Z.n_plan_formativo}] `:"")+(Z.custom_descripci\u00F3n_del_plan||Z.name),value:n.plan}:n.plan:ue("Todos (General)")}}),d.value="edit"}catch(e){console.error(e)}finally{P.value=!1}}),ge=t=>{j.value=T(j.value).add(t,"week").format("YYYY-MM-DD")},Ie=()=>{const t=$.value[$.value.length-1],e=t?t.date:j.value;$.value.push({date:e,hours:0,sede:D.value.default_sede?{label:D.value.default_sede_name,value:D.value.default_sede}:null,course:null,expediente:null,plan:null})},Le=t=>{$.value.splice(t,1)},xe=(t=!1)=>q(this,null,function*(){var s;if(ee.value>39)return alert(i("No se pueden registrar m\xE1s de 39 horas semanales. Por favor, ajusta tus horas.")),!1;if($.value.some(l=>!l.hours||parseFloat(l.hours)<=0))return alert(i("No puedes guardar l\xEDneas con 0 horas. Por favor, elimina las l\xEDneas vac\xEDas o a\xF1ade horas.")),!1;V.value=!0;try{const l=f=>{const o=(f==null?void 0:f.value)||f;return o==="__todos__"?null:o},a={name:O.value.name,start_date:j.value,end_date:re.value,logs:$.value.map(f=>{var o;return ke(we({},f),{sede:((o=f.sede)==null?void 0:o.value)||f.sede,course:l(f.course),expediente:l(f.expediente),plan:l(f.plan)})})},p=yield b("portal_rrhh.api.timesheets.save_timesheet",{data:JSON.stringify(a)});return O.value=p,J.value=!1,p}catch(l){console.error(l);const a=((s=l.messages)==null?void 0:s[0])||l.message||l;alert(a)}finally{V.value=!1}}),Re=()=>q(this,null,function*(){const t=T(),e=T(re.value);let s=[];t.isBefore(e)&&ee.value<39&&s.push("La semana a\xFAn no ha terminado y/o parece que no has completado una jornada completa."),pe.value=s.length>0?s.join(`
`)+`
`+i("Recuerda: El timesheet debe validarse al final de la semana o con todas las horas registradas."):i("Vas a cerrar y validar este registro de horas."),X.value=!0}),Fe=()=>{d.value="list",ae(!0)},ze=()=>q(this,null,function*(){X.value=!1,V.value=!0;try{const t=yield xe(!0);t&&(yield b("portal_rrhh.api.timesheets.submit_timesheet",{name:t.name}),yield ve(t.name))}catch(t){console.error(t)}finally{V.value=!1}}),i=t=>t;return ta(()=>{ae(),Be()}),(t,e)=>(_(),k("div",fa,[r("div",va,[r("div",ga,[r("h1",xa,u(i("Registro de Horas")),1),r("div",ya,[d.value==="edit"?(_(),W(c(B),{key:0,appearance:"white",onClick:Fe},{default:y(()=>[M(u(i("Volver al listado")),1)]),_:1})):R("",!0),d.value==="list"?(_(),W(c(B),{key:1,appearance:"primary",size:"md",label:"Nuevo Registro Semanal",loading:P.value,onClick:qe,class:"!bg-gray-900 !text-white hover:!bg-gray-800"},{default:y(()=>[M(u(i("Nuevo Registro Semanal")),1)]),_:1},8,["loading"])):R("",!0)])]),d.value==="list"?(_(),k("div",ba,[P.value?(_(),k("div",wa,u(i("Cargando...")),1)):z.value.length===0?(_(),k("div",ka,u(i("No hay registros de horas. Crea uno nuevo.")),1)):(_(),k("div",Ca,[(_(!0),k(oe,null,ne(z.value,s=>(_(),W(c(na),{key:s.name,title:`Semana #${c(T)(s.start_date).week()} \u2022 ${te(s.start_date)} - ${te(c(T)(s.start_date).add(4,"day").format("YYYY-MM-DD"))}`},{actions:y(()=>[r("div",Va,[r("div",Da,[r("span",Ya,u(s.total_hours)+" h",1),v(c(Ye),{color:he(s.status)},{default:y(()=>[M(u(fe(s.status)),1)]),_:2},1032,["color"])]),r("div",Ta,[s.status==="Draft"||s.status==="Borrador"?(_(),W(c(B),{key:0,size:"sm",appearance:"minimal",class:"text-red-500 hover:text-red-700",onClick:l=>Ue(s.name),title:i("Eliminar")},{default:y(()=>[v(c(de),{name:"trash-2",class:"w-4 h-4"})]),_:1},8,["onClick","title"])):R("",!0),v(c(B),{size:"sm",appearance:"minimal",onClick:l=>Oe(s.name),title:i("Duplicar")},{default:y(()=>[v(c(de),{name:"copy",class:"w-4 h-4"})]),_:1},8,["onClick","title"]),v(c(B),{size:"sm",appearance:"minimal",onClick:l=>ve(s.name)},{default:y(()=>[M(u(i("Ver / Editar")),1)]),_:1},8,["onClick"])])])]),_:2},1032,["title"]))),128))])),L.value?(_(),k("div",Sa,[v(c(B),{appearance:"secondary",loading:F.value,onClick:$e},{default:y(()=>[M(u(i("Cargar anteriores")),1)]),_:1},8,["loading"])])):R("",!0)])):(_(),k("div",$a,[r("div",Ba,[r("div",Ma,[v(c(B),{icon:"chevron-left",appearance:"minimal",onClick:e[0]||(e[0]=s=>ge(-1)),disabled:!J.value},null,8,["disabled"]),r("div",Pa,u(i("Semana del"))+" "+u(te(j.value))+" "+u(i("al"))+" "+u(te(re.value)),1),v(c(B),{icon:"chevron-right",appearance:"minimal",onClick:e[1]||(e[1]=s=>ge(1)),disabled:!J.value},null,8,["disabled"])]),r("div",Ea,[r("div",Na,[r("span",ja,u(i("Total"))+":",1),r("span",{class:se(["text-lg font-bold",ee.value>39?"text-red-600":"text-blue-700"])},u(ee.value)+" h",3)]),v(c(Ye),{size:"lg",color:he(O.value.status)},{default:y(()=>[M(u(fe(O.value.status||"Borrador")),1)]),_:1},8,["color"])])]),r("h3",Ua,u(i("Detalle de Actividad")),1),r("div",qa,[r("div",Oa,[r("div",Ia,u(i("Fecha")),1),r("div",La,[M(u(i("Plan Formativo"))+" ",1),r("span",Ra,"("+u(w.value.length)+")",1)]),r("div",Fa,[M(u(i("Expediente"))+" ",1),r("span",za,"("+u(S.value.length)+")",1)]),r("div",Aa,[M(u(i("Curso"))+" ",1),r("span",Ga,"("+u(N.value.length)+")",1)]),r("div",Ha,u(i("Horas")),1),r("div",Wa,u(i("Acciones")),1)]),(_(!0),k(oe,null,ne($.value,(s,l)=>(_(),k("div",{key:l,class:"grid grid-cols-12 gap-2 items-start border-b py-2"},[r("div",Ja,[v(c(Te),{type:"select",modelValue:s.date,"onUpdate:modelValue":a=>s.date=a,options:Se.value,disabled:G.value},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),r("div",Ka,[v(ie,{modelValue:s.plan,"onUpdate:modelValue":[a=>s.plan=a,a=>Pe(s,a)],options:[{label:"\u{1F4CB} Todos (General)",value:"__todos__"},...w.value.map(a=>({label:(a.n_plan_formativo?`[${a.n_plan_formativo}] `:"")+(a.custom_descripci\u00F3n_del_plan||a.name),value:a.name}))],disabled:G.value,placeholder:"Buscar Plan...","onUpdate:query":e[2]||(e[2]=a=>c(Me)(a))},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),r("div",{class:"col-span-2",onClickCapture:a=>c(me)("",s.plan)},[v(ie,{modelValue:s.expediente,"onUpdate:modelValue":[a=>s.expediente=a,a=>Ee(s,a)],options:[{label:"\u{1F4CB} Todos",value:"__todos__"},...S.value.map(a=>({label:(a.custom_num_de_expediente?`[${a.custom_num_de_expediente}] `:"")+(a.program_name||a.name),value:a.name,link_plan:a.custom_plan}))],disabled:G.value,placeholder:"Buscar Exp...","onUpdate:query":a=>c(me)(a,s.plan)},null,8,["modelValue","onUpdate:modelValue","options","disabled","onUpdate:query"])],40,Qa),r("div",{class:"col-span-3",onClickCapture:a=>c(_e)("",s.expediente,s.plan)},[v(ie,{modelValue:s.course,"onUpdate:modelValue":[a=>s.course=a,a=>Ne(s,a)],options:[{label:"\u{1F4CB} Todos",value:"__todos__"},...N.value.map(a=>({label:(a.custom_display_identifier?`[${a.custom_display_identifier}] `:"")+(a.course_name||a.name),value:a.name,link_program:a.expediente,link_plan:a.custom_plan}))],disabled:G.value,placeholder:"Buscar Curso...","onUpdate:query":a=>c(_e)(a,s.expediente,s.plan)},null,8,["modelValue","onUpdate:modelValue","options","disabled","onUpdate:query"])],40,Xa),r("div",Za,[v(c(Te),{type:"number",modelValue:s.hours,"onUpdate:modelValue":a=>s.hours=a,modelModifiers:{number:!0},disabled:G.value,min:"0",step:"0.5"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),r("div",et,[G.value?R("",!0):(_(),W(c(B),{key:0,icon:"trash-2",appearance:"minimal",class:"text-red-500 hover:text-red-700",onClick:a=>Le(l)},null,8,["onClick"]))])]))),128)),G.value?R("",!0):(_(),k("div",at,[v(c(B),{appearance:"white",icon:"plus",class:"w-full",onClick:Ie},{default:y(()=>[M(u(i("A\xF1adir Registro")),1)]),_:1})]))]),r("div",tt,[G.value?R("",!0):(_(),W(c(B),{key:0,appearance:"secondary",onClick:e[3]||(e[3]=s=>xe(!1)),loading:V.value},{default:y(()=>[M(u(i("Guardar Borrador")),1)]),_:1},8,["loading"])),!G.value&&!J.value?(_(),W(c(B),{key:1,appearance:"primary",onClick:Re,loading:V.value},{default:y(()=>[M(u(i("Validar y Enviar")),1)]),_:1},8,["loading"])):R("",!0)])]))]),v(c(sa),{modelValue:X.value,"onUpdate:modelValue":e[5]||(e[5]=s=>X.value=s),title:i("Advertencia de Env\xEDo")},{"body-content":y(()=>[r("p",null,u(pe.value),1),r("p",st,u(i("\xBFEst\xE1s seguro de que quieres validar este registro ahora? Ya no podr\xE1s editarlo despu\xE9s.")),1)]),actions:y(()=>[v(c(B),{appearance:"white",onClick:e[4]||(e[4]=s=>X.value=!1)},{default:y(()=>[M(u(i("Cancelar")),1)]),_:1}),v(c(B),{appearance:"danger",onClick:ze},{default:y(()=>[M(u(i("S\xED, Validar")),1)]),_:1})]),_:1},8,["modelValue","title"])]))}};var dt=Ce(ot,[["__scopeId","data-v-11a8e16b"]]);export{dt as default};
