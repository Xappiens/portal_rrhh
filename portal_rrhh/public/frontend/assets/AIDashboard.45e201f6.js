var y=(r,s,c)=>new Promise((u,t)=>{var a=n=>{try{h(c.next(n))}catch(m){t(m)}},o=n=>{try{h(c.throw(n))}catch(m){t(m)}},h=n=>n.done?u(n.value):Promise.resolve(n.value).then(a,o);h((c=c.apply(r,s)).next())});import{q as x,Z as f,o as l,c as d,b as e,f as b,t as i,F as p,x as v,n as _}from"./vendor.b02fecb1.js";const w={name:"AIDashboard",data(){return{stats:{cvsAnalyzed:0,reportsGenerated:0,successRate:0},recentAnalyses:[],loading:!1,error:null,refreshInterval:null,lastRefreshTime:null}},mounted(){this.loadDashboardData(),this.startAutoRefresh()},beforeUnmount(){this.stopAutoRefresh()},activated(){console.log("AI Dashboard activated, refreshing data..."),this.loadDashboardData(),this.startAutoRefresh()},deactivated(){this.stopAutoRefresh()},watch:{$route(r,s){r.name==="AIDashboard"&&(console.log("Navigated to AI Dashboard, refreshing data..."),this.loadDashboardData())}},methods:{loadDashboardData(r=!1){return y(this,null,function*(){var s,c,u;r||(this.loading=!0),this.error=null;try{console.log("\u{1F504} Loading dashboard data... (limit: 10)");const t=yield f("ai_hr_recruitment.ai_hr_recruitment.www.ai_dashboard.get_dashboard_data",{limit:10});if(console.log("\u{1F4E5} Raw API response:",t),t){const a=this.stats.cvsAnalyzed,o=this.recentAnalyses.length,h=this.recentAnalyses.map(g=>g.name).sort();t.stats&&(this.stats={cvsAnalyzed:(s=t.stats.cvsAnalyzed)!=null?s:0,reportsGenerated:(c=t.stats.reportsGenerated)!=null?c:0,successRate:(u=t.stats.successRate)!=null?u:0});const n=Array.isArray(t.recent_analyses)?JSON.parse(JSON.stringify(t.recent_analyses)):[];this.recentAnalyses=n,this.lastRefreshTime=new Date;const m=n.map(g=>g.name).sort();console.log("\u{1F4CA} Stats update:",{old:a,new:this.stats.cvsAnalyzed,changed:this.stats.cvsAnalyzed!==a}),console.log("\u{1F4CB} Recent analyses update:",{oldCount:a,newCount:n.length,oldNames:h,newNames:m,changed:JSON.stringify(h)!==JSON.stringify(m),actualArrayLength:this.recentAnalyses.length}),t.stats&&t.stats.cvsAnalyzed>a&&console.log(`\u2705 Dashboard updated: ${t.stats.cvsAnalyzed-a} new analysis(es) detected!`),n.length>o&&console.log(`\u2705 Dashboard updated: ${n.length-o} new recent analysis(es) added!`),n.length>0&&console.log("\u{1F4C4} Current recent analyses:",n.map(g=>({name:g.name,candidate:g.candidate_name,score:g.overall_score,timestamp:g.analysis_timestamp}))),this.$nextTick(()=>{console.log("\u{1F504} After nextTick - recentAnalyses length:",this.recentAnalyses.length),console.log("\u{1F4CA} Current stats:",JSON.stringify(this.stats)),console.log("\u{1F4CB} Current recent analyses count:",this.recentAnalyses.length),this.$forceUpdate&&this.$forceUpdate()})}else console.error("\u274C No data returned from API"),this.error="No data returned from server"}catch(t){console.error("Error loading dashboard data:",t),this.error=t.message||t.exc||"Failed to load dashboard data. Please check your connection."}finally{this.loading=!1}})},getScoreClass(r){return r>=80?"high":r>=60?"medium":"low"},formatDate(r){if(!r)return"N/A";try{return new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(s){return r}},viewAnalysis(r){r.name&&this.$router.push({name:"CVAnalysis",params:{jobApplicant:r.job_applicant||"",jobOpening:r.job_opening||""},query:{analysisId:r.name}})},goToAnalysis(){this.$router.push({name:"CVAnalysis"})},startAutoRefresh(){this.stopAutoRefresh(),this.refreshInterval=setInterval(()=>{console.log("Auto-refreshing dashboard..."),this.loadDashboardData(!0)},3e4),console.log("Auto-refresh started (every 30 seconds)")},stopAutoRefresh(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null,console.log("Auto-refresh stopped"))}}},A={class:"flex-1 p-6 bg-gray-50"},D={class:"mb-8 pb-6 border-b border-gray-200"},k={class:"flex justify-between items-start"},R={class:"flex items-center gap-3"},C={key:0,class:"text-xs text-gray-500"},I=["disabled"],N={key:0},j={key:1},z={key:0,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-center justify-between"},S={class:"flex items-center gap-3"},T={class:"text-red-700"},V={key:1,class:"text-center py-16"},U={key:2},G={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"},L={class:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow"},O={class:"flex items-center"},J={class:"ml-4"},P={class:"text-3xl font-bold text-gray-900"},B={class:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow"},E={class:"flex items-center"},F={class:"ml-4"},q={class:"text-3xl font-bold text-gray-900"},Z={class:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow"},H={class:"flex items-center"},K={class:"ml-4"},M={class:"text-3xl font-bold text-gray-900"},Q={class:"bg-white rounded-lg shadow p-6"},W={class:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200"},X={key:0,class:"px-3 py-1 bg-blue-500 text-white rounded-full text-xs font-semibold"},Y={key:0,class:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"},$={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ee=["onClick"],se={class:"flex items-center gap-4 mb-4"},te={class:"w-14 h-14 rounded-lg bg-blue-500 flex items-center justify-center text-white text-2xl font-bold flex-shrink-0 shadow-md"},oe={class:"flex-1 min-w-0"},re={class:"text-base font-semibold text-gray-900 truncate mb-1"},ae={class:"text-sm text-gray-600 truncate"},ne={key:0,class:"text-xs text-gray-500 mt-1"},le={class:"flex justify-between items-center pt-4 border-t border-gray-200"},de={class:"text-xl"};function ie(r,s,c,u,t,a){return l(),d("div",A,[e("div",D,[e("div",k,[s[3]||(s[3]=e("div",null,[e("h2",{class:"text-2xl font-semibold text-gray-900 mb-2"},"\u{1F916} AI Recruitment Dashboard"),e("p",{class:"text-sm text-gray-600"},"Track CV analyses and recruitment insights")],-1)),e("div",R,[t.refreshInterval?(l(),d("span",C,"Auto-refreshing every 30s")):b("",!0),e("button",{onClick:s[0]||(s[0]=(...o)=>a.loadDashboardData&&a.loadDashboardData(...o)),disabled:t.loading,class:"px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed"},[t.loading?(l(),d("span",N,"\u{1F504} Loading...")):(l(),d("span",j,"\u{1F504} Refresh"))],8,I)])])]),t.error?(l(),d("div",z,[e("div",S,[s[4]||(s[4]=e("strong",{class:"text-red-800"},"\u26A0\uFE0F Error:",-1)),e("span",T,i(t.error),1)]),e("button",{onClick:s[1]||(s[1]=(...o)=>a.loadDashboardData&&a.loadDashboardData(...o)),class:"px-3 py-1 bg-red-600 text-white rounded text-sm font-semibold hover:bg-red-700"},"Retry")])):b("",!0),t.loading&&!t.stats.cvsAnalyzed?(l(),d("div",V,[...s[5]||(s[5]=[e("div",{class:"inline-block w-12 h-12 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin mb-4"},null,-1),e("p",{class:"text-gray-600"},"Loading dashboard data...",-1)])])):(l(),d("div",U,[e("div",G,[e("div",L,[e("div",O,[s[8]||(s[8]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center shadow-md"},[e("span",{class:"text-2xl"},"\u{1F4CA}")])],-1)),e("div",J,[s[6]||(s[6]=e("p",{class:"text-sm font-medium text-gray-500"},"CVs Analyzed",-1)),e("p",P,i(t.stats.cvsAnalyzed||0),1),s[7]||(s[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Total completed analyses",-1))])])]),e("div",B,[e("div",E,[s[11]||(s[11]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center shadow-md"},[e("span",{class:"text-2xl"},"\u{1F4C4}")])],-1)),e("div",F,[s[9]||(s[9]=e("p",{class:"text-sm font-medium text-gray-500"},"Reports Generated",-1)),e("p",q,i(t.stats.reportsGenerated||0),1),s[10]||(s[10]=e("p",{class:"text-xs text-gray-500 mt-1"},"Recruitment reports created",-1))])])]),e("div",Z,[e("div",H,[s[14]||(s[14]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-12 h-12 bg-yellow-500 rounded-lg flex items-center justify-center shadow-md"},[e("span",{class:"text-2xl"},"\u2705")])],-1)),e("div",K,[s[12]||(s[12]=e("p",{class:"text-sm font-medium text-gray-500"},"Success Rate",-1)),e("p",M,i(t.stats.successRate||0)+"%",1),s[13]||(s[13]=e("p",{class:"text-xs text-gray-500 mt-1"},"Analysis completion rate",-1))])])])]),e("div",Q,[e("div",W,[s[15]||(s[15]=e("h3",{class:"text-lg font-semibold text-gray-900"},"\u{1F4CB} Recent CV Analyses",-1)),t.recentAnalyses.length>0?(l(),d("span",X,i(t.recentAnalyses.length)+" "+i(t.recentAnalyses.length===1?"analysis":"analyses"),1)):b("",!0)]),t.recentAnalyses.length===0?(l(),d("div",Y,[s[16]||(s[16]=e("div",{class:"text-5xl mb-4"},"\u{1F4ED}",-1)),s[17]||(s[17]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"No analysis yet",-1)),s[18]||(s[18]=e("p",{class:"text-sm text-gray-600 mb-6"},"Start analyzing CVs to see results here.",-1)),e("button",{onClick:s[2]||(s[2]=(...o)=>a.goToAnalysis&&a.goToAnalysis(...o)),class:"px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600"}," Go to CV Analysis \u2192 ")])):(l(),d("div",$,[(l(!0),d(p,null,v(t.recentAnalyses,(o,h)=>(l(),d("div",{key:`analysis-${o.name}-${t.lastRefreshTime?t.lastRefreshTime.getTime():h}`,class:"bg-gray-50 rounded-lg p-5 border-2 border-gray-200 hover:border-blue-400 cursor-pointer transition-all hover:shadow-lg",onClick:n=>a.viewAnalysis(o)},[e("div",se,[e("div",te,i((o.candidate_name||"U")[0].toUpperCase()),1),e("div",oe,[e("h4",re,i(o.candidate_name||"Unknown Candidate"),1),e("p",ae,i(o.job_title||"Unknown Position"),1),o.analysis_timestamp?(l(),d("p",ne,i(a.formatDate(o.analysis_timestamp)),1)):b("",!0)])]),e("div",le,[e("div",{class:_(["flex flex-col items-center px-4 py-2 rounded-lg font-semibold shadow-sm",a.getScoreClass(o.overall_score)==="high"?"bg-green-500 text-white":a.getScoreClass(o.overall_score)==="medium"?"bg-yellow-500 text-white":"bg-red-500 text-white"])},[s[19]||(s[19]=e("span",{class:"text-xs opacity-90 mb-1"},"Score",-1)),e("span",de,i(o.overall_score||0)+"%",1)],2),s[20]||(s[20]=e("span",{class:"text-sm text-blue-600 font-semibold hover:text-blue-800"},"View Details \u2192",-1))])],8,ee))),128))]))])]))])}var ge=x(w,[["render",ie],["__scopeId","data-v-fe2168e4"]]);export{ge as default};
