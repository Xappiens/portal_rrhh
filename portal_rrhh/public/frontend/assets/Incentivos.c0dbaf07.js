var z=(V,x,m)=>new Promise((v,f)=>{var n=c=>{try{h(m.next(c))}catch(y){f(y)}},C=c=>{try{h(m.throw(c))}catch(y){f(y)}},h=c=>c.done?v(c.value):Promise.resolve(c.value).then(n,C);h((m=m.apply(V,x)).next())});import{r as b,l as E,q as J,K as O,a8 as q,o as u,c as p,b as e,d as o,w as i,u as a,Q as g,U as w,R as S,W as G,Y as K,J as Q,_ as d,e as _,t as r,s as B,f as k,F as W,E as Y,C as A,a2 as H,S as X}from"./vendor.13deb96d.js";const Z={class:"h-full bg-gray-50 flex flex-col overflow-hidden"},ee={class:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0"},te={class:"flex items-center justify-between mb-4"},se={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ae={class:"flex items-center"},oe={class:"flex-shrink-0"},le={class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},ne={class:"ml-3"},re={class:"text-xl font-semibold text-gray-900"},ie={class:"flex items-center"},de={class:"flex-shrink-0"},ce={class:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"},ue={class:"ml-3"},me={class:"text-xl font-semibold text-gray-900"},pe={class:"flex items-center"},_e={class:"flex-shrink-0"},xe={class:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center"},fe={class:"ml-3"},ve={class:"text-xl font-semibold text-gray-900"},ye={class:"flex items-center"},ge={class:"flex-shrink-0"},he={class:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center"},be={class:"ml-3"},we={class:"text-xl font-semibold text-gray-900"},ke={class:"bg-white rounded-lg shadow-sm border border-gray-200 mx-6 mt-4 mb-4 flex-shrink-0"},Ce={class:"px-4 py-3"},Ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3"},Se={class:"lg:col-span-2"},Ve={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mt-3"},je={class:"flex items-end"},De={class:"flex-1 overflow-hidden px-6 pb-6"},Fe={class:"px-6 py-4 border-b border-gray-200 flex-shrink-0 flex items-center justify-between"},Ne={class:"text-lg font-semibold text-gray-900"},ze={class:"flex items-center space-x-2"},Ee={class:"flex-1 overflow-y-auto p-6"},Be={key:0,class:"text-center py-12"},Ae={key:1,class:"text-center py-12"},Ue={class:"text-xs text-gray-500 mb-4"},$e={key:2,class:"space-y-4"},Me=["onClick"],Te={class:"flex items-start justify-between"},Le={class:"flex-1"},Re={class:"flex items-center space-x-3 mb-3"},Pe={class:"flex-shrink-0"},Je={class:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center"},Oe={class:"text-sm font-semibold text-blue-700"},qe={class:"flex-1 min-w-0"},Ge={class:"text-base font-semibold text-gray-900 truncate"},Ke={class:"text-xs text-gray-500 truncate"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3"},We={class:"space-y-2"},Ye={class:"flex items-center space-x-2 text-sm"},He={class:"font-semibold text-gray-900"},Xe={class:"flex items-center space-x-2 text-sm"},Ze={class:"font-medium text-gray-900"},et={class:"space-y-2"},tt={class:"flex items-center space-x-2 text-sm"},st={class:"font-medium text-gray-900 truncate"},at={key:0,class:"flex items-center space-x-2 text-sm"},ot={class:"font-medium text-gray-900"},lt={key:0,class:"flex flex-wrap gap-2 mt-3"},nt=["title"],rt={class:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100"},it=["onClick"],dt={class:"text-xs text-gray-500"},ct={class:"space-y-4"},ut={class:"flex justify-end space-x-2"},_t={__name:"Incentivos",setup(V){const x=b(!1),m=b([]),v=b({total:0,submitted:0,draft:0,total_amount:0}),f=b(!1),n=b({search_text:"",status:"",payroll_date_from:"",payroll_date_to:"",employee:"",company:"",custom_provincia:"",salary_component:""}),C=E({url:"portal_rrhh.api.incentive.get_incentives",params:()=>({filters:JSON.stringify(n.value)}),onSuccess(l){m.value=l.data||[]}}),h=E({url:"portal_rrhh.api.incentive.get_incentive_stats",params:()=>({filters:JSON.stringify(n.value)}),onSuccess(l){v.value=l||{}}}),c=J(()=>!!(n.value.search_text||n.value.status||n.value.payroll_date_from||n.value.payroll_date_to||n.value.employee||n.value.company||n.value.custom_provincia||n.value.salary_component)),y=()=>z(this,null,function*(){x.value=!0;try{yield Promise.all([C.reload(),h.reload()])}finally{x.value=!1}}),U=()=>{n.value={search_text:"",status:"",payroll_date_from:"",payroll_date_to:"",employee:"",company:"",custom_provincia:"",salary_component:""}},j=()=>{f.value=!0},$=()=>{const l="/app/employee-incentive/new-employee-incentive";window.open(l,"_blank"),f.value=!1},M=l=>{D("Employee Incentive",l.name)},D=(l,t,s)=>{s&&s.stopPropagation();const P=`/app/${l.toLowerCase().replace(/\s+/g,"-")}/${encodeURIComponent(t)}`;window.open(P,"_blank")},T=l=>{if(!l)return"E";const t=l.trim().split(" ");return t.length>=2?(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase():l.charAt(0).toUpperCase()},L=l=>({Draft:"warning",Submitted:"success",Cancelled:"danger",Borrador:"warning",Enviado:"success",Cancelado:"danger"})[l]||"default",F=l=>l?new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l):"0.00",N=l=>l?new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"N/A",R=l=>{if(!l)return"0h";const t=Math.floor(l/3600),s=Math.floor(l%3600/60);return t>0&&s>0?`${t}h ${s}m`:t>0?`${t}h`:`${s}m`};return O(n,()=>{const l=n.value.search_text?500:200,t=setTimeout(()=>{y()},l);return()=>clearTimeout(t)},{deep:!0}),q(()=>{y()}),(l,t)=>(u(),p("div",Z,[e("div",ee,[e("div",te,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Gesti\xF3n de Incentivos"),e("p",{class:"text-sm text-gray-600 mt-1"},"Administra y visualiza los incentivos de empleados")],-1)),o(a(g),{variant:"primary",onClick:j,disabled:x.value},{default:i(()=>[o(a(d),{name:"plus",class:"h-4 w-4 mr-2"}),t[6]||(t[6]=_(" Nuevo Incentivo ",-1))]),_:1},8,["disabled"])]),e("div",se,[o(a(w),{class:"p-4"},{default:i(()=>[e("div",ae,[e("div",oe,[e("div",le,[o(a(d),{name:"file-text",class:"h-5 w-5 text-blue-600"})])]),e("div",ne,[t[8]||(t[8]=e("p",{class:"text-xs font-medium text-gray-500"},"Total",-1)),e("p",re,r(v.value.total||0),1)])])]),_:1}),o(a(w),{class:"p-4"},{default:i(()=>[e("div",ie,[e("div",de,[e("div",ce,[o(a(d),{name:"check-circle",class:"h-5 w-5 text-green-600"})])]),e("div",ue,[t[9]||(t[9]=e("p",{class:"text-xs font-medium text-gray-500"},"Enviados",-1)),e("p",me,r(v.value.submitted||0),1)])])]),_:1}),o(a(w),{class:"p-4"},{default:i(()=>[e("div",pe,[e("div",_e,[e("div",xe,[o(a(d),{name:"edit",class:"h-5 w-5 text-yellow-600"})])]),e("div",fe,[t[10]||(t[10]=e("p",{class:"text-xs font-medium text-gray-500"},"Borradores",-1)),e("p",ve,r(v.value.draft||0),1)])])]),_:1}),o(a(w),{class:"p-4"},{default:i(()=>[e("div",ye,[e("div",ge,[e("div",he,[o(a(d),{name:"dollar-sign",class:"h-5 w-5 text-purple-600"})])]),e("div",be,[t[11]||(t[11]=e("p",{class:"text-xs font-medium text-gray-500"},"Total Monto",-1)),e("p",we,r(F(v.value.total_amount)),1)])])]),_:1})])]),e("div",ke,[e("div",Ce,[e("div",Ie,[e("div",Se,[o(a(S),{modelValue:n.value.search_text,"onUpdate:modelValue":t[0]||(t[0]=s=>n.value.search_text=s),type:"text",placeholder:"Buscar por empleado, ID de incentivo...",variant:"outline",size:"sm"},{prefix:i(()=>[o(a(d),{name:"search",class:"h-4 text-gray-400"})]),_:1},8,["modelValue"])]),e("div",null,[G(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.value.status=s),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[12]||(t[12]=[e("option",{value:""},"Todos los estados",-1),e("option",{value:"Draft"},"Borrador",-1),e("option",{value:"Submitted"},"Enviado",-1),e("option",{value:"Cancelled"},"Cancelado",-1)])],512),[[K,n.value.status]])]),e("div",null,[o(a(S),{modelValue:n.value.payroll_date_from,"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.payroll_date_from=s),type:"date",placeholder:"Fecha desde",variant:"outline",size:"sm",label:"Fecha desde"},null,8,["modelValue"])])]),e("div",Ve,[e("div",null,[o(a(S),{modelValue:n.value.payroll_date_to,"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.payroll_date_to=s),type:"date",placeholder:"Fecha hasta",variant:"outline",size:"sm",label:"Fecha hasta"},null,8,["modelValue"])]),e("div",je,[o(a(g),{variant:"outline",size:"sm",onClick:U,disabled:!c.value},{default:i(()=>[o(a(d),{name:"x",class:"h-4 w-4 mr-2"}),t[13]||(t[13]=_(" Limpiar Filtros ",-1))]),_:1},8,["disabled"])])])])]),e("div",De,[o(a(w),{class:"h-full flex flex-col overflow-hidden"},{default:i(()=>[e("div",Fe,[e("h3",Ne," Incentivos ("+r(m.value.length)+") ",1),e("div",ze,[o(a(g),{variant:"ghost",size:"sm",onClick:y,loading:x.value},{default:i(()=>[o(a(d),{name:"refresh-cw",class:"h-4 w-4 mr-2"}),t[14]||(t[14]=_(" Actualizar ",-1))]),_:1},8,["loading"])])]),e("div",Ee,[x.value&&m.value.length===0?(u(),p("div",Be,[o(a(d),{name:"loader",class:"h-8 w-8 animate-spin mx-auto mb-4 text-gray-400"}),t[15]||(t[15]=e("p",{class:"text-sm text-gray-500"},"Cargando incentivos...",-1))])):!x.value&&m.value.length===0?(u(),p("div",Ae,[o(a(d),{name:"inbox",class:"h-12 w-12 mx-auto mb-4 text-gray-300"}),t[17]||(t[17]=e("p",{class:"text-sm font-medium text-gray-900 mb-1"},"No hay incentivos",-1)),e("p",Ue,r(c.value?"Intenta ajustar los filtros":"Crea tu primer incentivo"),1),c.value?k("",!0):(u(),B(a(g),{key:0,variant:"primary",size:"sm",onClick:j},{default:i(()=>[o(a(d),{name:"plus",class:"h-4 w-4 mr-2"}),t[16]||(t[16]=_(" Crear Incentivo ",-1))]),_:1}))])):(u(),p("div",$e,[(u(!0),p(W,null,Y(m.value,s=>(u(),p("div",{key:s.name,class:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:I=>M(s)},[e("div",Te,[e("div",Le,[e("div",Re,[e("div",Pe,[e("div",Je,[e("span",Oe,r(T(s.employee_name)),1)])]),e("div",qe,[e("h4",Ge,r(s.employee_name||"Sin nombre"),1),e("p",Ke,r(s.department||"Sin departamento")+" \u2022 "+r(s.company||"Sin compa\xF1\xEDa"),1)]),o(a(A),{variant:L(s.status),size:"md"},{default:i(()=>[_(r(s.status_label||s.status),1)]),_:2},1032,["variant"])]),e("div",Qe,[e("div",We,[e("div",Ye,[o(a(d),{name:"dollar-sign",class:"h-4 w-4 text-gray-400"}),t[18]||(t[18]=e("span",{class:"text-gray-600"},"Monto:",-1)),e("span",He,r(F(s.incentive_amount))+" "+r(s.currency||""),1)]),e("div",Xe,[o(a(d),{name:"calendar",class:"h-4 w-4 text-gray-400"}),t[19]||(t[19]=e("span",{class:"text-gray-600"},"Fecha de n\xF3mina:",-1)),e("span",Ze,r(s.payroll_date_formatted||N(s.payroll_date)),1)])]),e("div",et,[e("div",tt,[o(a(d),{name:"briefcase",class:"h-4 w-4 text-gray-400"}),t[20]||(t[20]=e("span",{class:"text-gray-600"},"Componente:",-1)),e("span",st,r(s.salary_component||"Sin componente"),1)]),s.custom_provincia?(u(),p("div",at,[o(a(d),{name:"map-pin",class:"h-4 w-4 text-gray-400"}),t[21]||(t[21]=e("span",{class:"text-gray-600"},"Provincia:",-1)),e("span",ot,r(s.custom_provincia),1)])):k("",!0)])]),s.custom_by_hours||s.custom_justificaci\u00F3n?(u(),p("div",lt,[s.custom_by_hours?(u(),B(a(A),{key:0,variant:"info",size:"sm"},{default:i(()=>[o(a(d),{name:"clock",class:"h-3 w-3 mr-1"}),_(" Por horas: "+r(R(s.custom_incentive_hours)),1)]),_:2},1024)):k("",!0),s.custom_justificaci\u00F3n?(u(),p("div",{key:1,class:"text-xs text-gray-600 bg-gray-50 rounded px-2 py-1 max-w-md truncate",title:s.custom_justificaci\u00F3n},r(s.custom_justificaci\u00F3n),9,nt)):k("",!0)])):k("",!0),e("div",rt,[e("a",{onClick:H(I=>D("Employee Incentive",s.name,I),["stop"]),class:"text-xs text-blue-600 hover:text-blue-800 hover:underline font-mono cursor-pointer",title:"Ver detalle del incentivo"}," ID: "+r(s.name),9,it),e("span",dt," Modificado: "+r(N(s.modified)),1)])])])],8,Me))),128))]))])]),_:1})]),o(a(Q),{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=s=>f.value=s),options:{title:"Nuevo Incentivo",size:"lg"}},{body:i(()=>[e("div",ct,[o(a(X),{variant:"info",title:"Informaci\xF3n"},{default:i(()=>[...t[22]||(t[22]=[_(" Ser\xE1s redirigido al formulario de Frappe para crear el incentivo. ",-1)])]),_:1}),t[23]||(t[23]=e("div",{class:"text-sm text-gray-600"},[e("p",null,'Al hacer clic en "Crear", se abrir\xE1 el formulario de Employee Incentive en una nueva pesta\xF1a.')],-1))])]),actions:i(()=>[e("div",ut,[o(a(g),{variant:"outline",onClick:t[4]||(t[4]=s=>f.value=!1)},{default:i(()=>[...t[24]||(t[24]=[_(" Cancelar ",-1)])]),_:1}),o(a(g),{variant:"primary",onClick:$},{default:i(()=>[...t[25]||(t[25]=[_(" Crear Incentivo ",-1)])]),_:1})])]),_:1},8,["modelValue"])]))}};export{_t as default};
