var y=(n,s,b)=>new Promise((r,e)=>{var p=c=>{try{x(b.next(c))}catch(A){e(A)}},i=c=>{try{x(b.throw(c))}catch(A){e(A)}},x=c=>c.done?r(c.value):Promise.resolve(c.value).then(p,i);x((b=b.apply(n,s)).next())});import{q as O,X as u,o as l,c as a,b as t,e as g,Y as v,Z as J,F as f,x as h,f as d,t as o,n as m,$ as _}from"./vendor.e26080f1.js";const w={name:"CVAnalysis",props:{jobApplicant:String,jobOpening:String},data(){return{analysis:null,isAnalyzing:!1,error:null,formJobApplicant:"",formJobOpening:"",pollingAttempts:0,pollingInterval:null,applicantData:null,jobOpeningData:null,loadingApplicant:!1,loadingJobOpening:!1,jobApplicantsList:[],jobOpeningsList:[],loadingJobApplicants:!1,loadingJobOpenings:!1}},computed:{effectiveJobApplicant(){return this.formJobApplicant||this.jobApplicant||this.$route.params.jobApplicant||this.$route.query.applicant||""},effectiveJobOpening(){return this.formJobOpening||this.jobOpening||this.$route.params.jobOpening||this.$route.query.opening||""},canAnalyze(){return this.formJobApplicant&&this.formJobOpening},hasValidData(){return this.analysis&&this.analysis.status==="Completed"?!0:this.analysis&&(this.analysis.skills_match_percentage||this.analysis.experience_relevance||this.analysis.education_match||this.analysis.cv_analysis_text&&this.analysis.cv_analysis_text.trim().length>0)}},mounted(){this.loadJobApplicantsList(),this.loadJobOpeningsList(),this.$route.query.analysisId?this.loadAnalysisById(this.$route.query.analysisId):this.effectiveJobApplicant&&this.effectiveJobOpening&&this.loadApplicantAndJobData()},watch:{effectiveJobApplicant(n){n&&!this.applicantData&&this.loadApplicantData()},effectiveJobOpening(n){n&&!this.jobOpeningData&&this.loadJobOpeningData()}},beforeUnmount(){this.pollingInterval&&clearTimeout(this.pollingInterval)},methods:{startAnalysis(){this.canAnalyze&&this.analyzeCV()},clearInputs(){this.formJobApplicant="",this.formJobOpening="",this.analysis=null,this.error=null,this.isAnalyzing=!1,this.applicantData=null,this.jobOpeningData=null},clearError(){this.error=null},cancelAnalysis(){this.pollingInterval&&(clearTimeout(this.pollingInterval),this.pollingInterval=null),this.isAnalyzing=!1,this.pollingAttempts=0,this.error="Analysis cancelled"},analyzeCV(){return y(this,null,function*(){if(!this.effectiveJobApplicant||!this.effectiveJobOpening){this.error="Please provide both Job Applicant ID and Job Opening ID";return}yield this.loadApplicantAndJobData(),this.isAnalyzing=!0,this.error=null,this.pollingAttempts=0;try{const n=yield u("ai_hr_recruitment.ai_hr_recruitment.api.cv_analysis.analyze_cv_with_ai",{job_applicant:this.effectiveJobApplicant,job_opening:this.effectiveJobOpening});n&&n.status?n.status==="processing"?this.pollAnalysisStatus(n.analysis_id):n.status==="exists"?(yield this.loadAnalysis(n.analysis_id),this.isAnalyzing=!1):n.status==="error"&&(this.error=n.message||"Analysis failed to start",this.isAnalyzing=!1):(this.error="Unexpected response from server",this.isAnalyzing=!1)}catch(n){console.error("Error analyzing CV:",n),this.error=n.message||"Failed to start CV analysis. Please check your connection and try again.",this.isAnalyzing=!1}})},pollAnalysisStatus(n){return y(this,null,function*(){const s=30;this.pollingAttempts=0,console.log("Starting polling for analysis:",n);const b=()=>y(this,null,function*(){if(!this.isAnalyzing){console.log("Polling stopped - isAnalyzing is false");return}try{console.log(`Polling attempt ${this.pollingAttempts+1}/${s} for analysis ${n}`);const r=yield u("ai_hr_recruitment.ai_hr_recruitment.api.cv_analysis.get_cv_analysis",{analysis_id:n});if(this.pollingAttempts++,console.log("Analysis status:",r?r.status:"null","Full data:",r),r&&r.status)if(r.status==="Completed"){console.log("\u2705 Analysis completed! Full data:",r),this.analysis=r,r.job_applicant&&(this.formJobApplicant=r.job_applicant,this.loadApplicantData()),r.job_opening&&(this.formJobOpening=r.job_opening,this.loadJobOpeningData()),this.isAnalyzing=!1,this.pollingInterval=null,this.pollingAttempts=0;return}else if(r.status==="Failed"){console.log("\u274C Analysis failed"),this.error=this.getErrorMessage(r),this.isAnalyzing=!1,this.pollingInterval=null;return}else if(r.status==="Analyzing"||r.status==="Pending"){console.log(`\u23F3 Still analyzing... (attempt ${this.pollingAttempts}/${s})`),this.pollingAttempts<s?this.pollingInterval=setTimeout(b,2e3):(this.error=`Analysis still processing after ${s*2} seconds. The background workers might not be running. Please check if 'bench start' is running.`,this.isAnalyzing=!1,this.pollingInterval=null,this.analysis=r);return}else{console.log("\u26A0\uFE0F Unknown status:",r.status),this.pollingAttempts<s?this.pollingInterval=setTimeout(b,2e3):(this.error=`Unknown analysis status: ${r.status}. Showing current data anyway.`,this.analysis=r,this.isAnalyzing=!1,this.pollingInterval=null);return}else{console.log("\u26A0\uFE0F No analysis data or status"),this.pollingAttempts<s?this.pollingInterval=setTimeout(b,2e3):(this.error="Could not retrieve analysis status after multiple attempts",this.isAnalyzing=!1,this.pollingInterval=null);return}}catch(r){console.error("\u274C Error polling:",r),this.pollingAttempts<s&&this.isAnalyzing?(console.log(`Retrying after error (attempt ${this.pollingAttempts}/${s})...`),this.pollingInterval=setTimeout(b,3e3)):(this.error="Error checking analysis status: "+(r.message||"Unknown error"),this.isAnalyzing=!1,this.pollingInterval=null)}});b()})},loadAnalysis(n){return y(this,null,function*(){try{this.error=null,console.log("Loading analysis:",n);const s=yield u("ai_hr_recruitment.ai_hr_recruitment.api.cv_analysis.get_cv_analysis",{analysis_id:n});console.log("Loaded analysis:",s),s?(this.analysis=s,s.job_applicant&&(this.formJobApplicant=s.job_applicant,this.loadApplicantData()),s.job_opening&&(this.formJobOpening=s.job_opening,this.loadJobOpeningData()),s.status==="Analyzing"||s.status==="Pending"?(console.log("Analysis still processing, starting polling..."),this.isAnalyzing=!0,this.pollAnalysisStatus(n)):s.status==="Completed"?(console.log("\u2705 Analysis already completed, showing results"),this.isAnalyzing=!1):(this.isAnalyzing=!1,s.status==="Failed"&&(this.error=this.getErrorMessage(s)))):this.error="Analysis not found"}catch(s){console.error("Error loading analysis:",s),this.error="Failed to load analysis: "+(s.message||"Unknown error")}})},loadAnalysisById(n=null){return y(this,null,function*(){if(!n){this.error="Please provide an Analysis ID";return}this.isAnalyzing=!0,this.error=null,yield this.loadAnalysis(n)})},reloadAnalysis(){return y(this,null,function*(){this.analysis&&this.analysis.name&&(this.isAnalyzing=!0,yield this.loadAnalysis(this.analysis.name))})},getErrorMessage(n){if(n.cv_analysis_text){if(n.cv_analysis_text.includes("disabled"))return"CV Analysis is disabled in AI HR Settings";if(n.cv_analysis_text.includes("API key"))return"OpenAI API key not configured in AI HR Settings";if(n.cv_analysis_text.includes("rate limit"))return"OpenAI API rate limit exceeded. Please wait and try again"}return"Analysis failed. Please try again or check error logs"},formatDate(n){if(!n)return"N/A";try{return new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(s){return n}},loadApplicantData(){return y(this,null,function*(){if(!!this.effectiveJobApplicant){this.loadingApplicant=!0;try{const n=yield u("frappe.client.get",{doctype:"Job Applicant",name:this.effectiveJobApplicant});this.applicantData=n,console.log("Loaded applicant data:",n)}catch(n){console.error("Error loading applicant data:",n),this.applicantData=null}finally{this.loadingApplicant=!1}}})},loadJobOpeningData(){return y(this,null,function*(){if(!!this.effectiveJobOpening){this.loadingJobOpening=!0;try{const n=yield u("frappe.client.get",{doctype:"Job Opening",name:this.effectiveJobOpening});this.jobOpeningData=n,console.log("Loaded job opening data:",n)}catch(n){console.error("Error loading job opening data:",n),this.jobOpeningData=null}finally{this.loadingJobOpening=!1}}})},loadApplicantAndJobData(){return y(this,null,function*(){this.effectiveJobApplicant&&(yield this.loadApplicantData()),this.effectiveJobOpening&&(yield this.loadJobOpeningData())})},loadJobApplicantsList(){return y(this,null,function*(){this.loadingJobApplicants=!0;try{const n=yield u("frappe.client.get_list",{doctype:"Job Applicant",fields:["name","applicant_name","email_id","job_title","status"],limit_page_length:1e3,order_by:"modified desc"});this.jobApplicantsList=n||[],console.log("Loaded job applicants list:",this.jobApplicantsList.length)}catch(n){console.error("Error loading job applicants list:",n),this.jobApplicantsList=[]}finally{this.loadingJobApplicants=!1}})},loadJobOpeningsList(){return y(this,null,function*(){this.loadingJobOpenings=!0;try{const n=yield u("frappe.client.get_list",{doctype:"Job Opening",fields:["name","job_title","designation","status","company"],limit_page_length:1e3,order_by:"modified desc"});this.jobOpeningsList=n||[],console.log("Loaded job openings list:",this.jobOpeningsList.length)}catch(n){console.error("Error loading job openings list:",n),this.jobOpeningsList=[]}finally{this.loadingJobOpenings=!1}})},onJobApplicantChange(){return y(this,null,function*(){this.formJobApplicant?(yield this.loadApplicantData(),this.applicantData&&this.applicantData.job_title&&(this.formJobOpening=this.applicantData.job_title,console.log("Auto-filled job opening from applicant:",this.formJobOpening),this.formJobOpening&&(yield this.loadJobOpeningData()))):(this.formJobOpening="",this.applicantData=null)})},onJobOpeningChange(){return y(this,null,function*(){this.formJobOpening?(yield this.loadJobOpeningData(),this.formJobApplicant&&this.applicantData&&this.applicantData.job_title!==this.formJobOpening&&console.warn("Warning: Selected Job Applicant is not associated with the selected Job Opening")):this.jobOpeningData=null})}}},D={class:"flex-1 p-6 bg-gray-50 overflow-y-auto"},k={key:0,class:"mb-6"},j={class:"bg-white rounded-lg shadow p-6"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},C=["disabled"],I=["value"],L={key:0,class:"text-xs text-gray-500 mt-1"},S=["disabled"],E=["value"],V={key:0,class:"text-xs text-gray-500 mt-1"},T=["disabled"],P={key:0},N={key:1},F={key:1,class:"mb-6"},M={class:"bg-white rounded-lg shadow p-6 mb-4"},U={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},q={class:"border-r border-gray-200 pr-6"},R={class:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-200"},B={class:"text-xs text-gray-500 font-mono ml-auto"},H={key:0,class:"space-y-2"},Y={class:"text-sm"},G={class:"text-gray-900"},W={class:"text-sm"},X={class:"text-gray-900"},Z={key:0,class:"text-sm"},K={class:"text-gray-900"},Q={key:1,class:"text-sm"},$={class:"text-gray-900"},ss={key:2,class:"text-sm"},ts={class:"text-gray-900"},es={key:1,class:"text-sm text-gray-500 italic"},ns={class:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-200"},is={class:"text-xs text-gray-500 font-mono ml-auto"},ls={key:0,class:"space-y-2"},as={class:"text-sm"},os={class:"text-gray-900"},rs={key:0,class:"text-sm"},ps={class:"text-gray-900"},gs={key:1,class:"text-sm"},ds={class:"text-gray-900"},ys={key:2,class:"text-sm"},bs={class:"text-gray-900"},cs={key:3,class:"text-sm"},us={class:"text-gray-900"},ms={key:4,class:"text-sm"},fs={class:"text-gray-900"},hs={key:5,class:"text-sm"},xs={class:"text-gray-900"},As={key:1,class:"text-sm text-gray-500 italic"},_s={class:"flex gap-3 flex-wrap"},vs=["disabled"],Js={key:0},Os={key:1},ws={key:2,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-center justify-between"},Ds={class:"flex items-center gap-3"},ks={class:"text-red-700"},js={key:3,class:"bg-white rounded-lg shadow p-8 text-center mb-6"},zs={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 text-left"},Cs={class:"mb-4"},Is={class:"text-sm text-gray-600 mb-2"},Ls={class:"w-full bg-gray-200 rounded-full h-2"},Ss={key:4,class:"space-y-6"},Es={class:"bg-white rounded-lg shadow p-6"},Vs={class:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200"},Ts={key:0,class:"text-xl font-semibold text-gray-900"},Ps={key:1,class:"text-xl font-semibold text-gray-900"},Ns={key:2,class:"text-xl font-semibold text-gray-900"},Fs={key:3,class:"text-xl font-semibold text-gray-900"},Ms={key:4,class:"text-sm text-gray-500"},Us={class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-6 text-sm text-blue-900"},qs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},Rs={class:"bg-gray-50 rounded-lg p-4"},Bs={class:"text-3xl font-bold text-gray-900 mb-2"},Hs={class:"w-full bg-gray-200 rounded-full h-2"},Ys={class:"bg-gray-50 rounded-lg p-4"},Gs={class:"text-2xl mb-2"},Ws={class:"text-sm font-semibold text-gray-700"},Xs={class:"bg-gray-50 rounded-lg p-4"},Zs={class:"text-2xl mb-2"},Ks={class:"text-sm font-semibold text-gray-700"},Qs={class:"bg-gray-50 rounded-lg p-4"},$s={class:"text-3xl font-bold text-gray-900 mb-2"},st={class:"w-full bg-gray-200 rounded-full h-2"},tt={class:"bg-gray-50 rounded-lg p-6 mb-6"},et=["innerHTML"],nt={key:1,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-yellow-800"},it={class:"bg-gray-50 rounded-lg p-6"},lt={class:"text-gray-700 leading-relaxed"},at={key:0},ot={key:1,class:"text-gray-500 italic"};function rt(n,s,b,r,e,p){return l(),a("div",D,[s[70]||(s[70]=t("div",{class:"mb-8"},[t("h2",{class:"text-2xl font-semibold text-gray-900 mb-2"},"\u{1F4C4} AI CV Analysis"),t("p",{class:"text-sm text-gray-600"},"Analyze candidate CVs using AI to evaluate fit and skills match")],-1)),!p.effectiveJobApplicant||!p.effectiveJobOpening?(l(),a("div",k,[t("div",j,[s[15]||(s[15]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"\u{1F4DD} Enter Analysis Details",-1)),s[16]||(s[16]=t("p",{class:"text-sm text-gray-600 mb-6"},"Select a Job Applicant and Job Opening from the dropdowns below. The Job Opening will auto-fill when you select a Job Applicant.",-1)),t("div",z,[t("div",null,[s[12]||(s[12]=t("label",{for:"job-applicant",class:"block text-sm font-medium text-gray-700 mb-2"},[t("span",null,"\u{1F464}"),g(" Job Applicant ")],-1)),v(t("select",{id:"job-applicant","onUpdate:modelValue":s[0]||(s[0]=i=>e.formJobApplicant=i),onChange:s[1]||(s[1]=(...i)=>p.onJobApplicantChange&&p.onJobApplicantChange(...i)),disabled:e.loadingJobApplicants,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},[s[11]||(s[11]=t("option",{value:""},"Select Job Applicant...",-1)),(l(!0),a(f,null,h(e.jobApplicantsList,i=>(l(),a("option",{key:i.name,value:i.name},o(i.applicant_name||i.name)+" "+o(i.email_id?`(${i.email_id})`:""),9,I))),128))],40,C),[[J,e.formJobApplicant]]),e.loadingJobApplicants?(l(),a("p",L,"Loading applicants...")):d("",!0)]),t("div",null,[s[14]||(s[14]=t("label",{for:"job-opening",class:"block text-sm font-medium text-gray-700 mb-2"},[t("span",null,"\u{1F4BC}"),g(" Job Opening ")],-1)),v(t("select",{id:"job-opening","onUpdate:modelValue":s[2]||(s[2]=i=>e.formJobOpening=i),onChange:s[3]||(s[3]=(...i)=>p.onJobOpeningChange&&p.onJobOpeningChange(...i)),disabled:e.loadingJobOpenings,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},[s[13]||(s[13]=t("option",{value:""},"Select Job Opening...",-1)),(l(!0),a(f,null,h(e.jobOpeningsList,i=>(l(),a("option",{key:i.name,value:i.name},o(i.job_title||i.name)+" "+o(i.designation?`(${i.designation})`:""),9,E))),128))],40,S),[[J,e.formJobOpening]]),e.loadingJobOpenings?(l(),a("p",V,"Loading openings...")):d("",!0)])]),t("button",{onClick:s[4]||(s[4]=(...i)=>p.startAnalysis&&p.startAnalysis(...i)),disabled:!p.canAnalyze||e.isAnalyzing,class:"w-full px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed"},[e.isAnalyzing?(l(),a("span",P,"\u{1F504} Analyzing...")):(l(),a("span",N,"\u{1F680} Start AI Analysis"))],8,T)])])):(l(),a("div",F,[t("div",M,[t("div",U,[t("div",q,[t("div",R,[s[17]||(s[17]=t("span",{class:"text-2xl"},"\u{1F464}",-1)),s[18]||(s[18]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Job Applicant",-1)),t("span",B,o(p.effectiveJobApplicant),1)]),e.applicantData?(l(),a("div",H,[t("p",Y,[s[19]||(s[19]=t("span",{class:"font-medium text-gray-700"},"Name:",-1)),s[20]||(s[20]=g()),t("span",G,o(e.applicantData.applicant_name||"N/A"),1)]),t("p",W,[s[21]||(s[21]=t("span",{class:"font-medium text-gray-700"},"Email:",-1)),s[22]||(s[22]=g()),t("span",X,o(e.applicantData.email_id||"N/A"),1)]),e.applicantData.phone_number?(l(),a("p",Z,[s[23]||(s[23]=t("span",{class:"font-medium text-gray-700"},"Phone:",-1)),s[24]||(s[24]=g()),t("span",K,o(e.applicantData.phone_number),1)])):d("",!0),e.applicantData.designation?(l(),a("p",Q,[s[25]||(s[25]=t("span",{class:"font-medium text-gray-700"},"Designation:",-1)),s[26]||(s[26]=g()),t("span",$,o(e.applicantData.designation),1)])):d("",!0),e.applicantData.status?(l(),a("p",ss,[s[27]||(s[27]=t("span",{class:"font-medium text-gray-700"},"Status:",-1)),s[28]||(s[28]=g()),t("span",ts,o(e.applicantData.status),1)])):d("",!0)])):(l(),a("div",es,"Loading applicant data..."))]),t("div",null,[t("div",ns,[s[29]||(s[29]=t("span",{class:"text-2xl"},"\u{1F4BC}",-1)),s[30]||(s[30]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Job Opening",-1)),t("span",is,o(p.effectiveJobOpening),1)]),e.jobOpeningData?(l(),a("div",ls,[t("p",as,[s[31]||(s[31]=t("span",{class:"font-medium text-gray-700"},"Title:",-1)),s[32]||(s[32]=g()),t("span",os,o(e.jobOpeningData.job_title||"N/A"),1)]),e.jobOpeningData.designation?(l(),a("p",rs,[s[33]||(s[33]=t("span",{class:"font-medium text-gray-700"},"Designation:",-1)),s[34]||(s[34]=g()),t("span",ps,o(e.jobOpeningData.designation),1)])):d("",!0),e.jobOpeningData.company?(l(),a("p",gs,[s[35]||(s[35]=t("span",{class:"font-medium text-gray-700"},"Company:",-1)),s[36]||(s[36]=g()),t("span",ds,o(e.jobOpeningData.company),1)])):d("",!0),e.jobOpeningData.department?(l(),a("p",ys,[s[37]||(s[37]=t("span",{class:"font-medium text-gray-700"},"Department:",-1)),s[38]||(s[38]=g()),t("span",bs,o(e.jobOpeningData.department),1)])):d("",!0),e.jobOpeningData.location?(l(),a("p",cs,[s[39]||(s[39]=t("span",{class:"font-medium text-gray-700"},"Location:",-1)),s[40]||(s[40]=g()),t("span",us,o(e.jobOpeningData.location),1)])):d("",!0),e.jobOpeningData.employment_type?(l(),a("p",ms,[s[41]||(s[41]=t("span",{class:"font-medium text-gray-700"},"Type:",-1)),s[42]||(s[42]=g()),t("span",fs,o(e.jobOpeningData.employment_type),1)])):d("",!0),e.jobOpeningData.status?(l(),a("p",hs,[s[43]||(s[43]=t("span",{class:"font-medium text-gray-700"},"Status:",-1)),s[44]||(s[44]=g()),t("span",xs,o(e.jobOpeningData.status),1)])):d("",!0)])):(l(),a("div",As,"Loading job opening data..."))])])]),t("div",_s,[t("button",{onClick:s[5]||(s[5]=(...i)=>p.analyzeCV&&p.analyzeCV(...i)),disabled:e.isAnalyzing,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed"},[e.isAnalyzing?(l(),a("span",Js,"\u{1F504} Analyzing...")):(l(),a("span",Os,"\u{1F50D} Analyze CV"))],8,vs),t("button",{onClick:s[6]||(s[6]=(...i)=>p.clearInputs&&p.clearInputs(...i)),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},"Change IDs"),e.analysis?(l(),a("button",{key:0,onClick:s[7]||(s[7]=(...i)=>p.reloadAnalysis&&p.reloadAnalysis(...i)),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},"\u{1F504} Reload")):d("",!0)])])),e.error?(l(),a("div",ws,[t("div",Ds,[s[46]||(s[46]=t("span",{class:"text-xl"},"\u26A0\uFE0F",-1)),t("div",null,[s[45]||(s[45]=t("strong",{class:"text-red-800"},"Error:",-1)),t("span",ks,o(e.error),1)])]),t("button",{onClick:s[8]||(s[8]=(...i)=>p.clearError&&p.clearError(...i)),class:"text-red-600 hover:text-red-800"},"\u2715")])):d("",!0),e.isAnalyzing&&!e.analysis?(l(),a("div",js,[s[51]||(s[51]=t("div",{class:"relative inline-block mb-6"},[t("div",{class:"w-16 h-16 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin"})],-1)),s[52]||(s[52]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"\u{1F916} AI is Analyzing CV...",-1)),s[53]||(s[53]=t("p",{class:"text-sm text-gray-600 mb-6"},"This is a real analysis using OpenAI GPT-4",-1)),t("div",zs,[t("div",{class:m(["p-3 rounded-lg",e.pollingAttempts>0?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...s[47]||(s[47]=[t("span",{class:"mr-2"},"\u2713",-1),g(" Request queued ",-1)])],2),t("div",{class:m(["p-3 rounded-lg",e.pollingAttempts>2?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...s[48]||(s[48]=[t("span",{class:"mr-2"},"\u23F3",-1),g(" Processing CV ",-1)])],2),t("div",{class:m(["p-3 rounded-lg",e.pollingAttempts>5?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...s[49]||(s[49]=[t("span",{class:"mr-2"},"\u23F3",-1),g(" Calling OpenAI ",-1)])],2),t("div",{class:m(["p-3 rounded-lg",e.pollingAttempts>8?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...s[50]||(s[50]=[t("span",{class:"mr-2"},"\u23F3",-1),g(" Parsing results ",-1)])],2)]),t("div",Cs,[t("p",Is,"Checking status... ("+o(e.pollingAttempts)+"/30 attempts, ~"+o(Math.round(e.pollingAttempts*2))+"s elapsed)",1),t("div",Ls,[t("div",{class:"bg-blue-500 h-2 rounded-full transition-all",style:_({width:Math.min(e.pollingAttempts/30*100,100)+"%"})},null,4)])]),e.pollingAttempts>5?(l(),a("button",{key:0,onClick:s[9]||(s[9]=(...i)=>p.cancelAnalysis&&p.cancelAnalysis(...i)),class:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600"},"Cancel Analysis")):d("",!0)])):d("",!0),e.analysis?(l(),a("div",Ss,[t("div",Es,[t("div",Vs,[e.analysis.status==="Completed"?(l(),a("h3",Ts,"\u2705 Analysis Complete")):e.analysis.status==="Analyzing"?(l(),a("h3",Ps,"\u23F3 Analysis In Progress")):e.analysis.status==="Failed"?(l(),a("h3",Ns,"\u274C Analysis Failed")):(l(),a("h3",Fs,"\u{1F4CA} Analysis (Status: "+o(e.analysis.status)+")",1)),e.analysis.analysis_timestamp?(l(),a("div",Ms," Analyzed on "+o(p.formatDate(e.analysis.analysis_timestamp)),1)):d("",!0)]),t("div",Us,[s[60]||(s[60]=t("p",{class:"font-semibold mb-2"},"\u{1F50D} Debug Info:",-1)),t("p",null,[s[54]||(s[54]=t("strong",null,"Status:",-1)),g(" "+o(e.analysis.status),1)]),t("p",null,[s[55]||(s[55]=t("strong",null,"Analysis ID:",-1)),g(" "+o(e.analysis.name),1)]),t("p",null,[s[56]||(s[56]=t("strong",null,"Has text:",-1)),g(" "+o(e.analysis.cv_analysis_text?"Yes ("+e.analysis.cv_analysis_text.length+" chars)":"No"),1)]),t("p",null,[s[57]||(s[57]=t("strong",null,"Skills:",-1)),g(" "+o(e.analysis.skills_match_percentage||"N/A")+"%",1)]),t("p",null,[s[58]||(s[58]=t("strong",null,"Experience:",-1)),g(" "+o(e.analysis.experience_relevance||"N/A"),1)]),t("p",null,[s[59]||(s[59]=t("strong",null,"Education:",-1)),g(" "+o(e.analysis.education_match||"N/A"),1)])]),t("div",qs,[t("div",Rs,[s[61]||(s[61]=t("div",{class:"flex items-center gap-2 mb-2"},[t("span",{class:"text-xl"},"\u{1F3AF}"),t("h4",{class:"text-sm font-medium text-gray-700"},"Skills Match")],-1)),t("div",Bs,o(e.analysis.skills_match_percentage||0)+"%",1),t("div",Hs,[t("div",{class:"bg-blue-500 h-2 rounded-full",style:_({width:(e.analysis.skills_match_percentage||0)+"%"})},null,4)])]),t("div",Ys,[s[62]||(s[62]=t("div",{class:"flex items-center gap-2 mb-2"},[t("span",{class:"text-xl"},"\u{1F4BC}"),t("h4",{class:"text-sm font-medium text-gray-700"},"Experience")],-1)),t("div",Gs,[(l(),a(f,null,h(5,i=>t("span",{key:i,class:m(i<=(e.analysis.experience_relevance||0)?"text-yellow-500":"text-gray-300")},"\u2605",2)),64))]),t("div",Ws,o(e.analysis.experience_relevance||0)+"/5",1)]),t("div",Xs,[s[63]||(s[63]=t("div",{class:"flex items-center gap-2 mb-2"},[t("span",{class:"text-xl"},"\u{1F393}"),t("h4",{class:"text-sm font-medium text-gray-700"},"Education")],-1)),t("div",Zs,[(l(),a(f,null,h(5,i=>t("span",{key:i,class:m(i<=(e.analysis.education_match||0)?"text-yellow-500":"text-gray-300")},"\u2605",2)),64))]),t("div",Ks,o(e.analysis.education_match||0)+"/5",1)]),t("div",Qs,[s[64]||(s[64]=t("div",{class:"flex items-center gap-2 mb-2"},[t("span",{class:"text-xl"},"\u{1F4CA}"),t("h4",{class:"text-sm font-medium text-gray-700"},"AI Confidence")],-1)),t("div",$s,o(e.analysis.ai_confidence_score||0)+"%",1),t("div",st,[t("div",{class:"bg-green-500 h-2 rounded-full",style:_({width:(e.analysis.ai_confidence_score||0)+"%"})},null,4)])])]),t("div",tt,[s[68]||(s[68]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-200"},"\u{1F4CB} Detailed AI Analysis",-1)),e.analysis.cv_analysis_text&&e.analysis.cv_analysis_text.trim().length>0?(l(),a("div",{key:0,class:"text-gray-700 leading-relaxed whitespace-pre-wrap",innerHTML:e.analysis.cv_analysis_text},null,8,et)):(l(),a("div",nt,[s[65]||(s[65]=t("p",{class:"font-semibold mb-2"},"\u26A0\uFE0F Analysis completed but no detailed text was generated.",-1)),s[66]||(s[66]=t("p",{class:"text-sm mb-2"},"This might happen if:",-1)),s[67]||(s[67]=t("ul",{class:"text-sm list-disc list-inside mb-3"},[t("li",null,"The AI response was incomplete"),t("li",null,"There was an error parsing the AI response"),t("li",null,"The analysis data is still being processed")],-1)),t("button",{onClick:s[10]||(s[10]=(...i)=>p.reloadAnalysis&&p.reloadAnalysis(...i)),class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"},"\u{1F504} Reload Analysis")]))]),t("div",it,[s[69]||(s[69]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-200"},"\u{1F4A1} AI Recommendations",-1)),t("div",lt,[e.analysis.ai_recommendations&&e.analysis.ai_recommendations.trim().length>0?(l(),a("p",at,o(e.analysis.ai_recommendations),1)):(l(),a("p",ot," \u26A0\uFE0F No recommendations were generated for this analysis. "))])])])])):d("",!0)])}var dt=O(w,[["render",rt],["__scopeId","data-v-5d42915a"]]);export{dt as default};
