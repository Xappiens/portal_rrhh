var ye=Object.defineProperty,pe=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var O=(u,e,y)=>e in u?ye(u,e,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[e]=y,J=(u,e)=>{for(var y in e||(e={}))ve.call(e,y)&&O(u,y,e[y]);if(R)for(var y of R(e))be.call(e,y)&&O(u,y,e[y]);return u},G=(u,e)=>pe(u,fe(e));var q=(u,e,y)=>new Promise((s,T)=>{var b=v=>{try{c(y.next(v))}catch(f){T(f)}},i=v=>{try{c(y.throw(v))}catch(f){T(f)}},c=v=>v.done?s(v.value):Promise.resolve(v.value).then(b,i);c((y=y.apply(u,e)).next())});import{z as _e,U as he,C as we,Q as ke,_ as Ce,$ as Ee,R as Ae,J as De,r as h,j as qe,q as P,a8 as Le,o as x,c as p,b as t,d as n,w as d,T as Ve,f as C,aa as S,G as L,W as I,Y as Se,e as g,t as l,n as B,s as Y,F as Q,E as W,Z}from"./vendor.0086aa74.js";const Te={name:"Nominas",components:{Card:he,Badge:we,Button:ke,FeatherIcon:Ce,LoadingIndicator:Ee,Input:Ae,Dialog:De},setup(){const u=h(!1),e=h(!1),y=h("previsiones"),s=qe({show:!1,message:"",type:"info"}),T=P(()=>({success:"check-circle",error:"alert-circle",warning:"alert-triangle",info:"info"})[s.type]||"info"),b=(o,r="info",m=4e3)=>{s.message=o,s.type=r,s.show=!0,setTimeout(()=>{s.show=!1},m)},i=h({mes:ge(),a\u00F1o:new Date().getFullYear(),employee:"",course:""}),c=h([]),v=h([]),f=h(null),k=h([]),_=h([]),E=P(()=>{let o=c.value;if(i.value.employee&&i.value.employee.trim()!==""){const r=i.value.employee.toLowerCase().trim();o=o.filter(m=>{var w,N,M;return((w=m.employee_name)==null?void 0:w.toLowerCase().includes(r))||((N=m.employee)==null?void 0:N.toLowerCase().includes(r))||((M=m.dni_nie)==null?void 0:M.toLowerCase().includes(r))})}if(i.value.course&&i.value.course.trim()!==""){const r=i.value.course.toLowerCase().trim();o=o.filter(m=>{var w;return(w=m.course)==null?void 0:w.toLowerCase().includes(r)})}return o}),a=P(()=>{let o=v.value;if(i.value.employee&&i.value.employee.trim()!==""){const r=i.value.employee.toLowerCase().trim();o=o.filter(m=>{var w,N,M;return((w=m.employee_name)==null?void 0:w.toLowerCase().includes(r))||((N=m.employee)==null?void 0:N.toLowerCase().includes(r))||((M=m.dni_nie)==null?void 0:M.toLowerCase().includes(r))})}if(i.value.course&&i.value.course.trim()!==""){const r=i.value.course.toLowerCase().trim();o=o.filter(m=>{var w;return(w=m.course)==null?void 0:w.toLowerCase().includes(r)})}return o}),A=P(()=>E.value.length>0&&E.value.every(o=>k.value.includes(`${o.employee}-${o.course}`))),K=P(()=>a.value.length>0&&a.value.every(o=>_.value.includes(o.name))),F=h(!1),z=h(null),j=h(!1),V=h(null),H=h(!1),U=h(new Date().toISOString().split("T")[0]),D=()=>q(this,null,function*(){var o;u.value=!0;try{const r=yield S("portal_rrhh.api.nominas.get_prevision_mes",{mes:i.value.mes,a\u00F1o:i.value.a\u00F1o,employee:null,course:null});r&&(c.value=r.previsiones||[],f.value=r.resumen||{});const m=yield S("portal_rrhh.api.nominas.get_liquidaciones_mes",{mes:i.value.mes,a\u00F1o:i.value.a\u00F1o,employee:null,course:null});m&&(v.value=m.liquidaciones||[],((o=m.liquidaciones)==null?void 0:o.length)>0&&(f.value=m.resumen))}catch(r){console.error("Error cargando datos:",r),b("Error al cargar los datos","error")}finally{u.value=!1}}),X=()=>{i.value.employee="",i.value.course="",D()},$=()=>q(this,null,function*(){yield D(),b("Previsiones actualizadas","success")}),ee=()=>q(this,null,function*(){var o;if(k.value.length!==0&&!!confirm(`\xBFEst\xE1 seguro de liquidar ${k.value.length} n\xF3minas?`)){u.value=!0;try{const r=E.value.filter(w=>k.value.includes(`${w.employee}-${w.course}`)),m=yield S("portal_rrhh.api.nominas.crear_liquidaciones_mes",{mes:i.value.mes,a\u00F1o:i.value.a\u00F1o,liquidaciones_data:r});m.creadas>0&&b(`Se crearon ${m.creadas} liquidaciones`,"success"),((o=m.errores)==null?void 0:o.length)>0&&(console.warn("Errores al liquidar:",m.errores),b(`${m.errores.length} liquidaciones con errores`,"warning")),k.value=[],yield D(),y.value="liquidaciones"}catch(r){console.error("Error liquidando n\xF3minas:",r),b("Error al liquidar las n\xF3minas","error")}finally{u.value=!1}}}),te=()=>q(this,null,function*(){if(_.value.length!==0&&!!confirm(`\xBFMarcar ${_.value.length} liquidaciones como enviadas?`)){u.value=!0;try{const o=yield S("portal_rrhh.api.nominas.marcar_como_enviado",{liquidaciones_ids:_.value});b(`Se marcaron ${o.actualizadas} liquidaciones como enviadas`,"success"),_.value=[],yield D()}catch(o){console.error("Error:",o),b("Error al marcar como enviadas","error")}finally{u.value=!1}}}),se=()=>{_.value.length!==0&&(H.value=!0)},ae=()=>q(this,null,function*(){u.value=!0;try{const o=yield S("portal_rrhh.api.nominas.marcar_como_pagado",{liquidaciones_ids:_.value,fecha_pago:U.value});b(`Se marcaron ${o.actualizadas} liquidaciones como pagadas`,"success"),H.value=!1,_.value=[],yield D()}catch(o){console.error("Error:",o),b("Error al marcar como pagadas","error")}finally{u.value=!1}}),oe=()=>q(this,null,function*(){e.value=!0;try{const o=yield S("portal_rrhh.api.nominas.generar_reporte_excel",{mes:i.value.mes,a\u00F1o:i.value.a\u00F1o,liquidaciones_ids:_.value.length>0?_.value:null});o.success&&o.file_url&&(window.open(o.file_url,"_blank"),b("Reporte Excel generado correctamente","success"))}catch(o){console.error("Error generando reporte:",o),b("Error al generar el reporte Excel","error")}finally{e.value=!1}}),re=o=>{z.value=o,F.value=!0},le=o=>{V.value=G(J({},o),{horas_extras:o.horas_extras||0,precio_hora_extra:o.precio_hora_extra||o.precio_hora*1.2}),j.value=!0},ne=()=>{const o=c.value.findIndex(r=>r.employee===V.value.employee&&r.course===V.value.course);if(o!==-1){const r=c.value[o];r.horas_extras=parseFloat(V.value.horas_extras)||0,r.precio_hora_extra=parseFloat(V.value.precio_hora_extra)||r.precio_hora*1.2,r.total_horas=r.horas_normales+r.horas_extras,r.importe_horas_extras=r.horas_extras*r.precio_hora_extra,r.bruto=r.importe_horas_normales+r.importe_horas_extras,r.vacaciones_mes=Math.round(r.bruto*.0833*100)/100,r.bruto_menos_vacaciones=r.bruto-r.vacaciones_mes,r.base_ss=r.bruto_menos_vacaciones,r.importe_ss=Math.round(r.base_ss*.3207*100)/100,r.total=r.base_ss+r.importe_ss,b("Horas extras actualizadas","success")}j.value=!1},ie=o=>{o.target.checked?k.value=E.value.map(r=>`${r.employee}-${r.course}`):k.value=[]},de=o=>{o.target.checked?_.value=a.value.map(r=>r.name):_.value=[]},ce=o=>{window.open(`/app/liquidacion-nomina/${o}`,"_blank")},me=o=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(o||0),ue=o=>new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(o||0),xe=o=>({Borrador:"gray",Previsi\u00F3n:"blue",Liquidado:"orange","Enviado a Asesor\xEDa":"purple",Pagado:"green"})[o]||"gray";function ge(){return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][new Date().getMonth()]}return Le(()=>{D()}),{loading:u,generandoExcel:e,activeTab:y,filters:i,previsiones:E,liquidaciones:a,resumen:f,seleccionadas:k,seleccionadasLiquidaciones:_,allPrevisionesSelected:A,allLiquidacionesSelected:K,showDetalleModal:F,detalleActual:z,showHorasExtrasModal:j,horasExtrasData:V,showPagoModal:H,fechaPago:U,toast:s,toastIcon:T,cargarDatos:D,limpiarFiltros:X,generarPrevisiones:$,liquidarSeleccionadas:ee,marcarComoEnviado:te,marcarComoPagado:se,confirmarPago:ae,generarReporteExcel:oe,verDetalle:re,agregarHorasExtras:le,guardarHorasExtras:ne,toggleSelectAll:ie,toggleSelectAllLiquidaciones:de,abrirLiquidacion:ce,formatCurrency:me,formatNumber:ue,getEstadoBadgeTheme:xe}}},Ne={class:"h-full flex flex-col overflow-hidden"},Me={class:"flex-1 overflow-y-auto px-5 py-4 sm:px-8"},Pe={class:"p-2"},je={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-2"},He={class:"flex flex-wrap gap-2"},Ie={class:"text-sm"},Be={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-4"},Fe={class:"p-2.5 flex items-center gap-2.5"},ze={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-100 flex-shrink-0"},Ue={class:"min-w-0"},Re={class:"text-lg font-bold text-gray-900 leading-tight"},Oe={class:"p-2.5 flex items-center gap-2.5"},Je={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-green-100 flex-shrink-0"},Ge={class:"min-w-0"},Ye={class:"text-lg font-bold text-gray-900 leading-tight"},Qe={class:"p-2.5 flex items-center gap-2.5"},We={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-yellow-100 flex-shrink-0"},Ze={class:"min-w-0"},Ke={class:"text-lg font-bold text-gray-900 leading-tight"},Xe={class:"p-2.5 flex items-center gap-2.5"},$e={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-white bg-opacity-20 flex-shrink-0"},et={class:"min-w-0"},tt={class:"text-lg font-bold text-white leading-tight"},st={class:"border-b border-gray-200"},at={class:"flex -mb-px"},ot={key:0,class:"ml-1 bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full text-xs"},rt={key:0,class:"ml-1 bg-green-100 text-green-600 px-2 py-0.5 rounded-full text-xs"},lt={key:0,class:"p-3"},nt={key:1,class:"text-center py-12"},it={key:2,class:"overflow-x-auto"},dt={class:"min-w-full divide-y divide-gray-200"},ct={class:"bg-gray-50"},mt={class:"px-3 py-2 text-left"},ut=["checked"],xt={class:"bg-white divide-y divide-gray-200"},gt={class:"px-3 py-2"},yt=["value"],pt={class:"px-3 py-2 text-sm text-gray-900"},ft={class:"px-3 py-2 text-sm text-gray-500"},vt=["title"],bt={class:"px-3 py-2 text-sm text-gray-900 text-right"},_t={class:"px-3 py-2 text-sm text-gray-900 text-right"},ht={class:"px-3 py-2 text-sm text-gray-500 text-right"},wt={class:"px-3 py-2 text-sm text-gray-500 text-right"},kt={class:"px-3 py-2 text-sm font-semibold text-gray-900 text-right"},Ct={class:"px-3 py-2 text-center"},Et={class:"flex items-center justify-center gap-1"},At={key:1,class:"p-3"},Dt={key:1,class:"text-center py-12"},qt={key:2,class:"overflow-x-auto"},Lt={class:"min-w-full divide-y divide-gray-200"},Vt={class:"bg-gray-50"},St={class:"px-3 py-2 text-left"},Tt=["checked"],Nt={class:"bg-white divide-y divide-gray-200"},Mt={class:"px-3 py-2"},Pt=["value"],jt={class:"px-3 py-2 text-sm text-gray-900"},Ht={class:"px-3 py-2 text-sm text-gray-500"},It=["title"],Bt={class:"px-3 py-2 text-sm text-gray-900 text-right"},Ft={class:"px-3 py-2 text-sm text-gray-900 text-right"},zt={class:"px-3 py-2 text-sm text-gray-900 text-right"},Ut={class:"px-3 py-2 text-sm text-gray-900 text-right"},Rt={class:"px-3 py-2 text-sm text-gray-500 text-right"},Ot={class:"px-3 py-2 text-sm font-semibold text-gray-900 text-right"},Jt={class:"px-3 py-2 text-center"},Gt={class:"px-3 py-2 text-center"},Yt={key:0,class:"space-y-6"},Qt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Wt={class:"bg-gray-50 rounded-lg p-4"},Zt={class:"space-y-2"},Kt={class:"flex justify-between text-sm"},Xt={class:"font-medium text-gray-900"},$t={class:"flex justify-between text-sm"},es={class:"font-medium text-gray-900"},ts={class:"flex justify-between text-sm"},ss={class:"font-medium text-gray-900"},as={class:"flex justify-between text-sm"},os={class:"font-medium text-gray-900 text-right max-w-[200px]"},rs={class:"bg-gray-50 rounded-lg p-4"},ls={class:"space-y-2"},ns={class:"flex justify-between text-sm"},is={class:"font-medium text-gray-900"},ds={class:"flex justify-between text-sm"},cs={class:"font-medium text-gray-900"},ms={class:"flex justify-between text-sm border-t pt-2"},us={class:"font-semibold text-gray-900"},xs={class:"flex justify-between text-sm"},gs={class:"font-medium text-gray-900"},ys={class:"bg-white border border-gray-200 rounded-lg p-4"},ps={class:"space-y-2"},fs={class:"flex justify-between text-sm"},vs={class:"text-gray-900"},bs={class:"flex justify-between text-sm"},_s={class:"text-gray-900"},hs={key:0,class:"flex justify-between text-sm"},ws={class:"text-gray-900"},ks={class:"flex justify-between text-sm font-semibold border-t border-b py-2"},Cs={class:"text-gray-900"},Es={class:"flex justify-between text-sm text-red-600"},As={class:"flex justify-between text-sm border-t pt-2"},Ds={class:"text-gray-900"},qs={key:1,class:"flex justify-between text-sm"},Ls={class:"text-gray-900"},Vs={class:"flex justify-between text-sm"},Ss={class:"text-gray-900"},Ts={class:"flex justify-between text-sm"},Ns={class:"text-gray-900"},Ms={class:"flex justify-between text-lg font-bold bg-blue-50 p-3 rounded-lg mt-3"},Ps={class:"text-blue-900"},js={key:0,class:"space-y-4"},Hs={class:"bg-gray-50 rounded-lg p-3"},Is={class:"text-sm"},Bs={class:"text-sm"},Fs={class:"space-y-4"},zs={class:"text-sm text-gray-600"};function Us(u,e,y,s,T,b){const i=L("Input"),c=L("Button"),v=L("Card"),f=L("FeatherIcon"),k=L("LoadingIndicator"),_=L("Badge"),E=L("Dialog");return x(),p("div",Ne,[t("div",Me,[n(v,{class:"mb-4"},{default:d(()=>[t("div",Pe,[t("div",je,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Mes",-1)),I(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.filters.mes=a),onChange:e[1]||(e[1]=(...a)=>s.cargarDatos&&s.cargarDatos(...a)),class:"form-select w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm py-1.5"},[...e[21]||(e[21]=[t("option",{value:"Enero"},"Enero",-1),t("option",{value:"Febrero"},"Febrero",-1),t("option",{value:"Marzo"},"Marzo",-1),t("option",{value:"Abril"},"Abril",-1),t("option",{value:"Mayo"},"Mayo",-1),t("option",{value:"Junio"},"Junio",-1),t("option",{value:"Julio"},"Julio",-1),t("option",{value:"Agosto"},"Agosto",-1),t("option",{value:"Septiembre"},"Septiembre",-1),t("option",{value:"Octubre"},"Octubre",-1),t("option",{value:"Noviembre"},"Noviembre",-1),t("option",{value:"Diciembre"},"Diciembre",-1)])],544),[[Se,s.filters.mes]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"A\xF1o",-1)),n(i,{type:"number",modelValue:s.filters.a\u00F1o,"onUpdate:modelValue":e[2]||(e[2]=a=>s.filters.a\u00F1o=a),onChange:s.cargarDatos,class:"text-sm"},null,8,["modelValue","onChange"])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Docente (Opcional)",-1)),n(i,{type:"text",modelValue:s.filters.employee,"onUpdate:modelValue":e[3]||(e[3]=a=>s.filters.employee=a),placeholder:"Buscar docente...",class:"text-sm"},null,8,["modelValue"])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Course (Opcional)",-1)),n(i,{type:"text",modelValue:s.filters.course,"onUpdate:modelValue":e[4]||(e[4]=a=>s.filters.course=a),placeholder:"Buscar course...",class:"text-sm"},null,8,["modelValue"])])]),t("div",He,[n(c,{onClick:s.cargarDatos,"icon-left":"search",class:"!py-1 !text-sm"},{default:d(()=>[...e[26]||(e[26]=[g(" Buscar ",-1)])]),_:1},8,["onClick"]),n(c,{onClick:s.limpiarFiltros,appearance:"white",class:"!py-1 !text-sm"},{default:d(()=>[...e[27]||(e[27]=[g(" Limpiar ",-1)])]),_:1},8,["onClick"]),e[32]||(e[32]=t("div",{class:"border-l border-gray-300 mx-1"},null,-1)),n(c,{onClick:s.generarPrevisiones,"icon-left":"refresh-cw",loading:s.loading,class:"!py-1 !text-sm"},{default:d(()=>[...e[28]||(e[28]=[g(" Actualizar Previsiones ",-1)])]),_:1},8,["onClick","loading"]),n(c,{onClick:s.liquidarSeleccionadas,"icon-left":"check",disabled:s.seleccionadas.length===0||s.loading,class:"!py-1 !text-sm"},{default:d(()=>[g(" Liquidar Seleccionadas ("+l(s.seleccionadas.length)+") ",1)]),_:1},8,["onClick","disabled"]),n(c,{onClick:s.marcarComoEnviado,"icon-left":"send",appearance:"white",disabled:s.seleccionadasLiquidaciones.length===0||s.loading,class:"!py-1 !text-sm"},{default:d(()=>[...e[29]||(e[29]=[g(" Marcar como Enviado ",-1)])]),_:1},8,["onClick","disabled"]),n(c,{onClick:s.marcarComoPagado,"icon-left":"dollar-sign",appearance:"white",disabled:s.seleccionadasLiquidaciones.length===0||s.loading,class:"!py-1 !text-sm"},{default:d(()=>[...e[30]||(e[30]=[g(" Marcar como Pagado ",-1)])]),_:1},8,["onClick","disabled"]),n(c,{onClick:s.generarReporteExcel,"icon-left":"download",appearance:"white",disabled:s.liquidaciones.length===0||s.loading,loading:s.generandoExcel,class:"!py-1 !text-sm"},{default:d(()=>[...e[31]||(e[31]=[g(" Descargar Excel ",-1)])]),_:1},8,["onClick","disabled","loading"])])])]),_:1}),n(Ve,{name:"fade"},{default:d(()=>[s.toast.show?(x(),p("div",{key:0,class:B(["fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg flex items-center gap-2 max-w-md",s.toast.type==="success"?"bg-green-500 text-white":"",s.toast.type==="error"?"bg-red-500 text-white":"",s.toast.type==="warning"?"bg-yellow-500 text-white":"",s.toast.type==="info"?"bg-blue-500 text-white":""])},[n(f,{name:s.toastIcon,class:"h-5 w-5 flex-shrink-0"},null,8,["name"]),t("span",Ie,l(s.toast.message),1),t("button",{onClick:e[5]||(e[5]=a=>s.toast.show=!1),class:"ml-2 hover:opacity-70"},[n(f,{name:"x",class:"h-4 w-4"})])],2)):C("",!0)]),_:1}),s.resumen?(x(),p("div",Be,[n(v,null,{default:d(()=>[t("div",Fe,[t("div",ze,[n(f,{name:"users",class:"h-4 w-4 text-blue-600"})]),t("div",Ue,[e[33]||(e[33]=t("div",{class:"text-[10px] font-medium text-gray-500 uppercase leading-tight"},"Total Docentes",-1)),t("div",Re,l(s.resumen.total_docentes),1)])])]),_:1}),n(v,null,{default:d(()=>[t("div",Oe,[t("div",Je,[n(f,{name:"clock",class:"h-4 w-4 text-green-600"})]),t("div",Ge,[e[34]||(e[34]=t("div",{class:"text-[10px] font-medium text-gray-500 uppercase leading-tight"},"Total Horas",-1)),t("div",Ye,l(s.formatNumber(s.resumen.total_horas))+"h",1)])])]),_:1}),n(v,null,{default:d(()=>[t("div",Qe,[t("div",We,[n(f,{name:"dollar-sign",class:"h-4 w-4 text-yellow-600"})]),t("div",Ze,[e[35]||(e[35]=t("div",{class:"text-[10px] font-medium text-gray-500 uppercase leading-tight"},"Total Bruto",-1)),t("div",Ke,l(s.formatCurrency(s.resumen.total_bruto)),1)])])]),_:1}),n(v,{class:"bg-gradient-to-br from-blue-500 to-blue-600"},{default:d(()=>[t("div",Xe,[t("div",$e,[n(f,{name:"trending-up",class:"h-4 w-4 text-white"})]),t("div",et,[e[36]||(e[36]=t("div",{class:"text-[10px] font-medium text-blue-100 uppercase leading-tight"},"Total a Pagar",-1)),t("div",tt,l(s.formatCurrency(s.resumen.total_pagar)),1)])])]),_:1})])):C("",!0),n(v,null,{default:d(()=>[t("div",st,[t("nav",at,[t("button",{onClick:e[6]||(e[6]=a=>s.activeTab="previsiones"),class:B(["flex items-center gap-2 px-5 py-2.5 text-sm font-medium border-b-2 transition-colors",s.activeTab==="previsiones"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[n(f,{name:"eye",class:"h-4 w-4"}),e[37]||(e[37]=g(" Previsiones ",-1)),s.previsiones.length>0?(x(),p("span",ot,l(s.previsiones.length),1)):C("",!0)],2),t("button",{onClick:e[7]||(e[7]=a=>s.activeTab="liquidaciones"),class:B(["flex items-center gap-2 px-5 py-2.5 text-sm font-medium border-b-2 transition-colors",s.activeTab==="liquidaciones"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[n(f,{name:"file-text",class:"h-4 w-4"}),e[38]||(e[38]=g(" Liquidaciones ",-1)),s.liquidaciones.length>0?(x(),p("span",rt,l(s.liquidaciones.length),1)):C("",!0)],2)])]),s.activeTab==="previsiones"?(x(),p("div",lt,[s.loading?(x(),Y(k,{key:0,class:"py-12"})):s.previsiones.length===0?(x(),p("div",nt,[n(f,{name:"inbox",class:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e[40]||(e[40]=t("p",{class:"text-gray-500 mb-4"},"No hay previsiones pendientes para este mes",-1)),e[41]||(e[41]=t("p",{class:"text-gray-400 text-sm mb-4"},"Las previsiones se generan autom\xE1ticamente desde Job Offers y Modificaciones RRHH activos",-1)),n(c,{onClick:s.cargarDatos,"icon-left":"refresh-cw"},{default:d(()=>[...e[39]||(e[39]=[g(" Actualizar ",-1)])]),_:1},8,["onClick"])])):(x(),p("div",it,[t("table",dt,[t("thead",ct,[t("tr",null,[t("th",mt,[t("input",{type:"checkbox",checked:s.allPrevisionesSelected,onChange:e[8]||(e[8]=(...a)=>s.toggleSelectAll&&s.toggleSelectAll(...a)),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,ut)]),e[42]||(e[42]=t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Docente",-1)),e[43]||(e[43]=t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"DNI/NIE",-1)),e[44]||(e[44]=t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Course",-1)),e[45]||(e[45]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Horas",-1)),e[46]||(e[46]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Bruto",-1)),e[47]||(e[47]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Vacaciones",-1)),e[48]||(e[48]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"SS",-1)),e[49]||(e[49]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total",-1)),e[50]||(e[50]=t("th",{class:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones",-1))])]),t("tbody",xt,[(x(!0),p(Q,null,W(s.previsiones,a=>(x(),p("tr",{key:`prev-${a.employee}-${a.course}`,class:"hover:bg-gray-50"},[t("td",gt,[I(t("input",{type:"checkbox",value:`${a.employee}-${a.course}`,"onUpdate:modelValue":e[9]||(e[9]=A=>s.seleccionadas=A),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,yt),[[Z,s.seleccionadas]])]),t("td",pt,l(a.employee_name),1),t("td",ft,l(a.dni_nie),1),t("td",{class:"px-3 py-2 text-sm text-gray-500 max-w-[200px] truncate",title:a.course},l(a.course),9,vt),t("td",bt,l(s.formatNumber(a.total_horas))+"h",1),t("td",_t,l(s.formatCurrency(a.bruto)),1),t("td",ht,l(s.formatCurrency(a.vacaciones_mes)),1),t("td",wt,l(s.formatCurrency(a.importe_ss)),1),t("td",kt,l(s.formatCurrency(a.total)),1),t("td",Ct,[t("div",Et,[n(c,{onClick:A=>s.verDetalle(a),appearance:"minimal",icon:"eye",class:"!p-1",title:"Ver detalle"},null,8,["onClick"]),n(c,{onClick:A=>s.agregarHorasExtras(a),appearance:"minimal",icon:"clock",class:"!p-1",title:"Agregar horas extras"},null,8,["onClick"])])])]))),128))])])]))])):C("",!0),s.activeTab==="liquidaciones"?(x(),p("div",At,[s.loading?(x(),Y(k,{key:0,class:"py-12"})):s.liquidaciones.length===0?(x(),p("div",Dt,[n(f,{name:"inbox",class:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e[51]||(e[51]=t("p",{class:"text-gray-500"},"No hay liquidaciones creadas para este mes",-1)),e[52]||(e[52]=t("p",{class:"text-gray-400 text-sm mt-2"},'Selecciona previsiones y haz clic en "Liquidar Seleccionadas"',-1))])):(x(),p("div",qt,[t("table",Lt,[t("thead",Vt,[t("tr",null,[t("th",St,[t("input",{type:"checkbox",checked:s.allLiquidacionesSelected,onChange:e[10]||(e[10]=(...a)=>s.toggleSelectAllLiquidaciones&&s.toggleSelectAllLiquidaciones(...a)),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,Tt)]),e[53]||(e[53]=t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Docente",-1)),e[54]||(e[54]=t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"DNI/NIE",-1)),e[55]||(e[55]=t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Course",-1)),e[56]||(e[56]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Horas N",-1)),e[57]||(e[57]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Horas E",-1)),e[58]||(e[58]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total H",-1)),e[59]||(e[59]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Bruto",-1)),e[60]||(e[60]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"SS",-1)),e[61]||(e[61]=t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total",-1)),e[62]||(e[62]=t("th",{class:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado",-1)),e[63]||(e[63]=t("th",{class:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones",-1))])]),t("tbody",Nt,[(x(!0),p(Q,null,W(s.liquidaciones,a=>(x(),p("tr",{key:a.name,class:"hover:bg-gray-50"},[t("td",Mt,[I(t("input",{type:"checkbox",value:a.name,"onUpdate:modelValue":e[11]||(e[11]=A=>s.seleccionadasLiquidaciones=A),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,Pt),[[Z,s.seleccionadasLiquidaciones]])]),t("td",jt,l(a.employee_name),1),t("td",Ht,l(a.dni_nie),1),t("td",{class:"px-3 py-2 text-sm text-gray-500 max-w-[200px] truncate",title:a.course},l(a.course),9,It),t("td",Bt,l(s.formatNumber(a.horas_normales)),1),t("td",Ft,l(s.formatNumber(a.horas_extras)),1),t("td",zt,l(s.formatNumber(a.total_horas)),1),t("td",Ut,l(s.formatCurrency(a.bruto)),1),t("td",Rt,l(s.formatCurrency(a.importe_ss)),1),t("td",Ot,l(s.formatCurrency(a.total)),1),t("td",Jt,[n(_,{theme:s.getEstadoBadgeTheme(a.estado)},{default:d(()=>[g(l(a.estado),1)]),_:2},1032,["theme"])]),t("td",Gt,[n(c,{onClick:A=>s.abrirLiquidacion(a.name),appearance:"minimal",icon:"external-link",class:"!p-1",title:"Abrir en Frappe"},null,8,["onClick"])])]))),128))])])]))])):C("",!0)]),_:1}),n(E,{modelValue:s.showDetalleModal,"onUpdate:modelValue":e[13]||(e[13]=a=>s.showDetalleModal=a),options:{title:"Detalle de Liquidaci\xF3n",size:"3xl"}},{"body-content":d(()=>[s.detalleActual?(x(),p("div",Yt,[t("div",Qt,[t("div",Wt,[e[68]||(e[68]=t("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Informaci\xF3n B\xE1sica",-1)),t("div",Zt,[t("div",Kt,[e[64]||(e[64]=t("span",{class:"text-gray-500"},"Empleado:",-1)),t("span",Xt,l(s.detalleActual.employee_name),1)]),t("div",$t,[e[65]||(e[65]=t("span",{class:"text-gray-500"},"DNI/NIE:",-1)),t("span",es,l(s.detalleActual.dni_nie),1)]),t("div",ts,[e[66]||(e[66]=t("span",{class:"text-gray-500"},"Designation:",-1)),t("span",ss,l(s.detalleActual.designation),1)]),t("div",as,[e[67]||(e[67]=t("span",{class:"text-gray-500"},"Course:",-1)),t("span",os,l(s.detalleActual.course),1)])])]),t("div",rs,[e[73]||(e[73]=t("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Horas Trabajadas",-1)),t("div",ls,[t("div",ns,[e[69]||(e[69]=t("span",{class:"text-gray-500"},"Horas Normales:",-1)),t("span",is,l(s.formatNumber(s.detalleActual.horas_normales))+"h",1)]),t("div",ds,[e[70]||(e[70]=t("span",{class:"text-gray-500"},"Horas Extras:",-1)),t("span",cs,l(s.formatNumber(s.detalleActual.horas_extras))+"h",1)]),t("div",ms,[e[71]||(e[71]=t("span",{class:"text-gray-500 font-medium"},"Total Horas:",-1)),t("span",us,l(s.formatNumber(s.detalleActual.total_horas))+"h",1)]),t("div",xs,[e[72]||(e[72]=t("span",{class:"text-gray-500"},"D\xEDas Trabajados:",-1)),t("span",gs,l(s.detalleActual.dias_trabajados)+" d\xEDas",1)])])])]),t("div",ys,[e[84]||(e[84]=t("h4",{class:"text-sm font-semibold text-gray-900 mb-4"},"C\xE1lculo de Importes",-1)),t("div",ps,[t("div",fs,[e[74]||(e[74]=t("span",{class:"text-gray-600"},"Precio por Hora:",-1)),t("span",vs,l(s.formatCurrency(s.detalleActual.precio_hora)),1)]),t("div",bs,[e[75]||(e[75]=t("span",{class:"text-gray-600"},"Importe Horas Normales:",-1)),t("span",_s,l(s.formatCurrency(s.detalleActual.importe_horas_normales)),1)]),s.detalleActual.horas_extras>0?(x(),p("div",hs,[e[76]||(e[76]=t("span",{class:"text-gray-600"},"Importe Horas Extras:",-1)),t("span",ws,l(s.formatCurrency(s.detalleActual.importe_horas_extras)),1)])):C("",!0),t("div",ks,[e[77]||(e[77]=t("span",{class:"text-gray-900"},"BRUTO TOTAL:",-1)),t("span",Cs,l(s.formatCurrency(s.detalleActual.bruto)),1)]),t("div",Es,[e[78]||(e[78]=t("span",null,"Vacaciones (8.33%):",-1)),t("span",null,"-"+l(s.formatCurrency(s.detalleActual.vacaciones_mes)),1)]),t("div",As,[e[79]||(e[79]=t("span",{class:"text-gray-600"},"Bruto - Vacaciones:",-1)),t("span",Ds,l(s.formatCurrency(s.detalleActual.bruto_menos_vacaciones)),1)]),s.detalleActual.vacaciones_acumuladas>0?(x(),p("div",qs,[e[80]||(e[80]=t("span",{class:"text-gray-600"},"Vacaciones Acumuladas:",-1)),t("span",Ls,l(s.formatCurrency(s.detalleActual.vacaciones_acumuladas)),1)])):C("",!0),t("div",Vs,[e[81]||(e[81]=t("span",{class:"text-gray-600"},"Base para SS:",-1)),t("span",Ss,l(s.formatCurrency(s.detalleActual.base_ss)),1)]),t("div",Ts,[e[82]||(e[82]=t("span",{class:"text-gray-600"},"Seguridad Social (32.07%):",-1)),t("span",Ns,l(s.formatCurrency(s.detalleActual.importe_ss)),1)]),t("div",Ms,[e[83]||(e[83]=t("span",{class:"text-blue-900"},"TOTAL A PAGAR:",-1)),t("span",Ps,l(s.formatCurrency(s.detalleActual.total)),1)])])])])):C("",!0)]),actions:d(()=>[n(c,{appearance:"white",onClick:e[12]||(e[12]=a=>s.showDetalleModal=!1)},{default:d(()=>[...e[85]||(e[85]=[g(" Cerrar ",-1)])]),_:1})]),_:1},8,["modelValue"]),n(E,{modelValue:s.showHorasExtrasModal,"onUpdate:modelValue":e[17]||(e[17]=a=>s.showHorasExtrasModal=a),options:{title:"Agregar Horas Extras",size:"md"}},{"body-content":d(()=>[s.horasExtrasData?(x(),p("div",js,[t("div",Hs,[t("p",Is,[e[86]||(e[86]=t("strong",null,"Docente:",-1)),g(" "+l(s.horasExtrasData.employee_name),1)]),t("p",Bs,[e[87]||(e[87]=t("strong",null,"Course:",-1)),g(" "+l(s.horasExtrasData.course),1)])]),t("div",null,[e[88]||(e[88]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Horas Extras",-1)),n(i,{type:"number",modelValue:s.horasExtrasData.horas_extras,"onUpdate:modelValue":e[14]||(e[14]=a=>s.horasExtrasData.horas_extras=a),step:"0.5",min:"0"},null,8,["modelValue"])]),t("div",null,[e[89]||(e[89]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Precio Hora Extra (opcional)",-1)),n(i,{type:"number",modelValue:s.horasExtrasData.precio_hora_extra,"onUpdate:modelValue":e[15]||(e[15]=a=>s.horasExtrasData.precio_hora_extra=a),step:"0.01",min:"0",placeholder:`Por defecto: ${s.formatCurrency(s.horasExtrasData.precio_hora*1.2)}`},null,8,["modelValue","placeholder"]),e[90]||(e[90]=t("p",{class:"text-xs text-gray-500 mt-1"},"Si no se especifica, se usa 120% del precio normal",-1))])])):C("",!0)]),actions:d(()=>[n(c,{appearance:"white",onClick:e[16]||(e[16]=a=>s.showHorasExtrasModal=!1)},{default:d(()=>[...e[91]||(e[91]=[g(" Cancelar ",-1)])]),_:1}),n(c,{onClick:s.guardarHorasExtras},{default:d(()=>[...e[92]||(e[92]=[g(" Guardar ",-1)])]),_:1},8,["onClick"])]),_:1},8,["modelValue"]),n(E,{modelValue:s.showPagoModal,"onUpdate:modelValue":e[20]||(e[20]=a=>s.showPagoModal=a),options:{title:"Marcar como Pagado",size:"sm"}},{"body-content":d(()=>[t("div",Fs,[t("p",zs,[e[93]||(e[93]=g(" Se marcar\xE1n ",-1)),t("strong",null,l(s.seleccionadasLiquidaciones.length),1),e[94]||(e[94]=g(" liquidaciones como pagadas. ",-1))]),t("div",null,[e[95]||(e[95]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha de Pago",-1)),n(i,{type:"date",modelValue:s.fechaPago,"onUpdate:modelValue":e[18]||(e[18]=a=>s.fechaPago=a)},null,8,["modelValue"])])])]),actions:d(()=>[n(c,{appearance:"white",onClick:e[19]||(e[19]=a=>s.showPagoModal=!1)},{default:d(()=>[...e[96]||(e[96]=[g(" Cancelar ",-1)])]),_:1}),n(c,{onClick:s.confirmarPago,loading:s.loading},{default:d(()=>[...e[97]||(e[97]=[g(" Confirmar Pago ",-1)])]),_:1},8,["onClick","loading"])]),_:1},8,["modelValue"])])])}var Js=_e(Te,[["render",Us],["__scopeId","data-v-56d6c058"]]);export{Js as default};
