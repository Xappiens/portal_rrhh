var h=(n,t,p)=>new Promise((r,s)=>{var l=b=>{try{f(p.next(b))}catch(v){s(v)}},i=b=>{try{f(p.throw(b))}catch(v){s(v)}},f=b=>b.done?r(b.value):Promise.resolve(b.value).then(l,i);f((p=p.apply(n,t)).next())});import{q as D,Z as x,o as a,c as o,b as e,e as d,$ as O,a0 as J,X as y,Y as u,f as c,t as g,F as A,x as _,n as m,a1 as w}from"./vendor.b02fecb1.js";const j={name:"CVAnalysis",props:{jobApplicant:String,jobOpening:String},data(){return{analysis:null,isAnalyzing:!1,error:null,formJobApplicant:"",formJobOpening:"",applicantSearchText:"",openingSearchText:"",showApplicantDropdown:!1,showOpeningDropdown:!1,highlightedApplicantIndex:-1,highlightedOpeningIndex:-1,pollingAttempts:0,pollingInterval:null,applicantData:null,jobOpeningData:null,loadingApplicant:!1,loadingJobOpening:!1,jobApplicantsList:[],jobOpeningsList:[],loadingJobApplicants:!1,loadingJobOpenings:!1}},computed:{effectiveJobApplicant(){return this.formJobApplicant||this.jobApplicant||this.$route.params.jobApplicant||this.$route.query.applicant||""},effectiveJobOpening(){return this.formJobOpening||this.jobOpening||this.$route.params.jobOpening||this.$route.query.opening||""},canAnalyze(){return this.formJobApplicant&&this.formJobOpening},filteredApplicants(){if(!this.applicantSearchText)return this.jobApplicantsList;const n=this.applicantSearchText.toLowerCase();return this.jobApplicantsList.filter(t=>{const p=(t.applicant_name||"").toLowerCase(),r=(t.email_id||"").toLowerCase(),s=(t.name||"").toLowerCase();return p.includes(n)||r.includes(n)||s.includes(n)})},filteredOpenings(){if(!this.openingSearchText)return this.jobOpeningsList;const n=this.openingSearchText.toLowerCase();return this.jobOpeningsList.filter(t=>{const p=(t.job_title||"").toLowerCase(),r=(t.designation||"").toLowerCase(),s=(t.name||"").toLowerCase();return p.includes(n)||r.includes(n)||s.includes(n)})},hasValidData(){return this.analysis&&this.analysis.status==="Completed"?!0:this.analysis&&(this.analysis.skills_match_percentage||this.analysis.experience_relevance||this.analysis.education_match||this.analysis.cv_analysis_text&&this.analysis.cv_analysis_text.trim().length>0)}},mounted(){this.loadJobApplicantsList(),this.loadJobOpeningsList(),this.$route.query.analysisId?this.loadAnalysisById(this.$route.query.analysisId):this.effectiveJobApplicant&&this.effectiveJobOpening&&this.loadApplicantAndJobData()},watch:{effectiveJobApplicant(n){n&&!this.applicantData&&this.loadApplicantData()},effectiveJobOpening(n){n&&!this.jobOpeningData&&this.loadJobOpeningData()}},beforeUnmount(){this.pollingInterval&&clearTimeout(this.pollingInterval)},methods:{startAnalysis(){this.canAnalyze&&this.analyzeCV()},clearInputs(){this.formJobApplicant="",this.formJobOpening="",this.applicantSearchText="",this.openingSearchText="",this.showApplicantDropdown=!1,this.showOpeningDropdown=!1,this.analysis=null,this.error=null,this.isAnalyzing=!1,this.applicantData=null,this.jobOpeningData=null},clearApplicant(){this.formJobApplicant="",this.applicantSearchText="",this.showApplicantDropdown=!1,this.applicantData=null},clearOpening(){this.formJobOpening="",this.openingSearchText="",this.showOpeningDropdown=!1,this.jobOpeningData=null},selectApplicant(n){this.formJobApplicant=n.name,this.applicantSearchText=n.applicant_name||n.name,this.showApplicantDropdown=!1,this.highlightedApplicantIndex=-1,this.onJobApplicantChange()},selectOpening(n){this.formJobOpening=n.name,this.openingSearchText=n.job_title||n.name,this.showOpeningDropdown=!1,this.highlightedOpeningIndex=-1,this.onJobOpeningChange()},onApplicantSearchInput(){const n=this.applicantSearchText.trim();if(n){const t=this.jobApplicantsList.find(p=>{const r=n.toLowerCase(),s=p.name&&p.name.toLowerCase()===r,l=p.applicant_name&&p.applicant_name.toLowerCase()===r,i=p.email_id&&p.email_id.toLowerCase()===r;return s||l||i});t?(this.formJobApplicant=t.name,this.applicantSearchText=t.applicant_name||t.name):this.formJobApplicant=n}else this.formJobApplicant="";this.showApplicantDropdown&&(this.highlightedApplicantIndex=-1)},onApplicantFocus(){this.jobApplicantsList.length>0&&(this.showApplicantDropdown=!0)},onOpeningSearchInput(){const n=this.openingSearchText.trim();if(n){const t=this.jobOpeningsList.find(p=>{const r=n.toLowerCase(),s=p.name&&p.name.toLowerCase()===r,l=p.job_title&&p.job_title.toLowerCase()===r,i=p.designation&&p.designation.toLowerCase()===r;return s||l||i});t?(this.formJobOpening=t.name,this.openingSearchText=t.job_title||t.name):this.formJobOpening=n}else this.formJobOpening="";this.showOpeningDropdown&&(this.highlightedOpeningIndex=-1)},onOpeningFocus(){this.jobOpeningsList.length>0&&(this.showOpeningDropdown=!0)},toggleApplicantDropdown(){this.showApplicantDropdown=!this.showApplicantDropdown,this.showApplicantDropdown&&(this.highlightedApplicantIndex=-1)},toggleOpeningDropdown(){this.showOpeningDropdown=!this.showOpeningDropdown,this.showOpeningDropdown&&(this.highlightedOpeningIndex=-1)},handleApplicantBlur(){setTimeout(()=>{if(this.showApplicantDropdown=!1,this.formJobApplicant){const n=this.jobApplicantsList.find(t=>t.name===this.formJobApplicant);n&&(this.applicantSearchText=n.applicant_name||n.name)}},200)},handleOpeningBlur(){setTimeout(()=>{if(this.showOpeningDropdown=!1,this.formJobOpening){const n=this.jobOpeningsList.find(t=>t.name===this.formJobOpening);n&&(this.openingSearchText=n.job_title||n.name)}},200)},getApplicantDisplayName(n){const t=this.jobApplicantsList.find(p=>p.name===n);return t?t.applicant_name||t.name:n},getOpeningDisplayName(n){const t=this.jobOpeningsList.find(p=>p.name===n);return t?t.job_title||t.name:n},handleApplicantEnter(){this.highlightedApplicantIndex>=0&&this.filteredApplicants[this.highlightedApplicantIndex]?this.selectApplicant(this.filteredApplicants[this.highlightedApplicantIndex]):this.filteredApplicants.length>0?this.selectApplicant(this.filteredApplicants[0]):this.applicantSearchText.trim()&&(this.formJobApplicant=this.applicantSearchText.trim(),this.showApplicantDropdown=!1,this.onJobApplicantChange())},handleOpeningEnter(){this.highlightedOpeningIndex>=0&&this.filteredOpenings[this.highlightedOpeningIndex]?this.selectOpening(this.filteredOpenings[this.highlightedOpeningIndex]):this.filteredOpenings.length>0?this.selectOpening(this.filteredOpenings[0]):this.openingSearchText.trim()&&(this.formJobOpening=this.openingSearchText.trim(),this.showOpeningDropdown=!1,this.onJobOpeningChange())},navigateApplicantDropdown(n){!this.showApplicantDropdown||this.filteredApplicants.length===0||(this.highlightedApplicantIndex+=n,this.highlightedApplicantIndex<0?this.highlightedApplicantIndex=this.filteredApplicants.length-1:this.highlightedApplicantIndex>=this.filteredApplicants.length&&(this.highlightedApplicantIndex=0),this.$nextTick(()=>{var p,r;const t=(r=(p=document.querySelector("#job-applicant-search"))==null?void 0:p.parentElement)==null?void 0:r.querySelector(".absolute");if(t){const s=t.children[this.highlightedApplicantIndex];s&&s.scrollIntoView({block:"nearest",behavior:"smooth"})}}))},navigateOpeningDropdown(n){!this.showOpeningDropdown||this.filteredOpenings.length===0||(this.highlightedOpeningIndex+=n,this.highlightedOpeningIndex<0?this.highlightedOpeningIndex=this.filteredOpenings.length-1:this.highlightedOpeningIndex>=this.filteredOpenings.length&&(this.highlightedOpeningIndex=0),this.$nextTick(()=>{var p,r;const t=(r=(p=document.querySelector("#job-opening-search"))==null?void 0:p.parentElement)==null?void 0:r.querySelector(".absolute");if(t){const s=t.children[this.highlightedOpeningIndex];s&&s.scrollIntoView({block:"nearest",behavior:"smooth"})}}))},clearError(){this.error=null},cancelAnalysis(){this.pollingInterval&&(clearTimeout(this.pollingInterval),this.pollingInterval=null),this.isAnalyzing=!1,this.pollingAttempts=0,this.error="Analysis cancelled"},analyzeCV(){return h(this,null,function*(){if(!this.effectiveJobApplicant||!this.effectiveJobOpening){this.error="Please provide both Job Applicant ID and Job Opening ID";return}yield this.loadApplicantAndJobData(),this.isAnalyzing=!0,this.error=null,this.pollingAttempts=0;try{const n=yield x("ai_hr_recruitment.ai_hr_recruitment.api.cv_analysis.analyze_cv_with_ai",{job_applicant:this.effectiveJobApplicant,job_opening:this.effectiveJobOpening});n&&n.status?n.status==="processing"?this.pollAnalysisStatus(n.analysis_id):n.status==="exists"?(yield this.loadAnalysis(n.analysis_id),this.isAnalyzing=!1):n.status==="error"&&(this.error=n.message||"Analysis failed to start",this.isAnalyzing=!1):(this.error="Unexpected response from server",this.isAnalyzing=!1)}catch(n){console.error("Error analyzing CV:",n),this.error=n.message||"Failed to start CV analysis. Please check your connection and try again.",this.isAnalyzing=!1}})},pollAnalysisStatus(n){return h(this,null,function*(){const t=30;this.pollingAttempts=0,console.log("Starting polling for analysis:",n);const p=()=>h(this,null,function*(){if(!this.isAnalyzing){console.log("Polling stopped - isAnalyzing is false");return}try{console.log(`Polling attempt ${this.pollingAttempts+1}/${t} for analysis ${n}`);const r=yield x("ai_hr_recruitment.ai_hr_recruitment.api.cv_analysis.get_cv_analysis",{analysis_id:n});if(this.pollingAttempts++,console.log("Analysis status:",r?r.status:"null","Full data:",r),r&&r.status)if(r.status==="Completed"){if(console.log("\u2705 Analysis completed! Full data:",r),this.analysis=r,r.job_applicant){this.formJobApplicant=r.job_applicant;const s=this.jobApplicantsList.find(l=>l.name===r.job_applicant);s&&(this.applicantSearchText=s.applicant_name||s.name),this.loadApplicantData()}if(r.job_opening){this.formJobOpening=r.job_opening;const s=this.jobOpeningsList.find(l=>l.name===r.job_opening);s&&(this.openingSearchText=s.job_title||s.name),this.loadJobOpeningData()}this.isAnalyzing=!1,this.pollingInterval=null,this.pollingAttempts=0;return}else if(r.status==="Failed"){console.log("\u274C Analysis failed"),this.error=this.getErrorMessage(r),this.isAnalyzing=!1,this.pollingInterval=null;return}else if(r.status==="Analyzing"||r.status==="Pending"){console.log(`\u23F3 Still analyzing... (attempt ${this.pollingAttempts}/${t})`),this.pollingAttempts<t?this.pollingInterval=setTimeout(p,2e3):(this.error=`Analysis still processing after ${t*2} seconds. The background workers might not be running. Please check if 'bench start' is running.`,this.isAnalyzing=!1,this.pollingInterval=null,this.analysis=r);return}else{console.log("\u26A0\uFE0F Unknown status:",r.status),this.pollingAttempts<t?this.pollingInterval=setTimeout(p,2e3):(this.error=`Unknown analysis status: ${r.status}. Showing current data anyway.`,this.analysis=r,this.isAnalyzing=!1,this.pollingInterval=null);return}else{console.log("\u26A0\uFE0F No analysis data or status"),this.pollingAttempts<t?this.pollingInterval=setTimeout(p,2e3):(this.error="Could not retrieve analysis status after multiple attempts",this.isAnalyzing=!1,this.pollingInterval=null);return}}catch(r){console.error("\u274C Error polling:",r),this.pollingAttempts<t&&this.isAnalyzing?(console.log(`Retrying after error (attempt ${this.pollingAttempts}/${t})...`),this.pollingInterval=setTimeout(p,3e3)):(this.error="Error checking analysis status: "+(r.message||"Unknown error"),this.isAnalyzing=!1,this.pollingInterval=null)}});p()})},loadAnalysis(n){return h(this,null,function*(){try{this.error=null,console.log("Loading analysis:",n);const t=yield x("ai_hr_recruitment.ai_hr_recruitment.api.cv_analysis.get_cv_analysis",{analysis_id:n});if(console.log("Loaded analysis:",t),t){if(this.analysis=t,t.job_applicant){this.formJobApplicant=t.job_applicant;const p=this.jobApplicantsList.find(r=>r.name===t.job_applicant);p&&(this.applicantSearchText=p.applicant_name||p.name),this.loadApplicantData()}if(t.job_opening){this.formJobOpening=t.job_opening;const p=this.jobOpeningsList.find(r=>r.name===t.job_opening);p&&(this.openingSearchText=p.job_title||p.name),this.loadJobOpeningData()}t.status==="Analyzing"||t.status==="Pending"?(console.log("Analysis still processing, starting polling..."),this.isAnalyzing=!0,this.pollAnalysisStatus(n)):t.status==="Completed"?(console.log("\u2705 Analysis already completed, showing results"),this.isAnalyzing=!1):(this.isAnalyzing=!1,t.status==="Failed"&&(this.error=this.getErrorMessage(t)))}else this.error="Analysis not found"}catch(t){console.error("Error loading analysis:",t),this.error="Failed to load analysis: "+(t.message||"Unknown error")}})},loadAnalysisById(n=null){return h(this,null,function*(){if(!n){this.error="Please provide an Analysis ID";return}this.isAnalyzing=!0,this.error=null,yield this.loadAnalysis(n)})},reloadAnalysis(){return h(this,null,function*(){this.analysis&&this.analysis.name&&(this.isAnalyzing=!0,yield this.loadAnalysis(this.analysis.name))})},getErrorMessage(n){if(n.cv_analysis_text){if(n.cv_analysis_text.includes("disabled"))return"CV Analysis is disabled in AI HR Settings";if(n.cv_analysis_text.includes("API key"))return"OpenAI API key not configured in AI HR Settings";if(n.cv_analysis_text.includes("rate limit"))return"OpenAI API rate limit exceeded. Please wait and try again"}return"Analysis failed. Please try again or check error logs"},formatDate(n){if(!n)return"N/A";try{return new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return n}},loadApplicantData(){return h(this,null,function*(){if(!!this.effectiveJobApplicant){this.loadingApplicant=!0;try{const n=yield x("frappe.client.get",{doctype:"Job Applicant",name:this.effectiveJobApplicant});this.applicantData=n,console.log("Loaded applicant data:",n)}catch(n){console.error("Error loading applicant data:",n),this.applicantData=null}finally{this.loadingApplicant=!1}}})},loadJobOpeningData(){return h(this,null,function*(){if(!!this.effectiveJobOpening){this.loadingJobOpening=!0;try{const n=yield x("frappe.client.get",{doctype:"Job Opening",name:this.effectiveJobOpening});this.jobOpeningData=n,console.log("Loaded job opening data:",n)}catch(n){console.error("Error loading job opening data:",n),this.jobOpeningData=null}finally{this.loadingJobOpening=!1}}})},loadApplicantAndJobData(){return h(this,null,function*(){this.effectiveJobApplicant&&(yield this.loadApplicantData()),this.effectiveJobOpening&&(yield this.loadJobOpeningData())})},loadJobApplicantsList(){return h(this,null,function*(){this.loadingJobApplicants=!0;try{const n=yield x("frappe.client.get_list",{doctype:"Job Applicant",fields:["name","applicant_name","email_id","job_title","status"],limit_page_length:1e3,order_by:"modified desc"});this.jobApplicantsList=n||[],console.log("Loaded job applicants list:",this.jobApplicantsList.length)}catch(n){console.error("Error loading job applicants list:",n),this.jobApplicantsList=[]}finally{this.loadingJobApplicants=!1}})},loadJobOpeningsList(){return h(this,null,function*(){this.loadingJobOpenings=!0;try{const n=yield x("frappe.client.get_list",{doctype:"Job Opening",fields:["name","job_title","designation","status","company"],limit_page_length:1e3,order_by:"modified desc"});this.jobOpeningsList=n||[],console.log("Loaded job openings list:",this.jobOpeningsList.length)}catch(n){console.error("Error loading job openings list:",n),this.jobOpeningsList=[]}finally{this.loadingJobOpenings=!1}})},onJobApplicantChange(){return h(this,null,function*(){if(this.formJobApplicant){const n=this.jobApplicantsList.find(t=>t.name===this.formJobApplicant);if(n&&(this.applicantSearchText=n.applicant_name||n.name),yield this.loadApplicantData(),this.applicantData&&this.applicantData.job_title){this.formJobOpening=this.applicantData.job_title;const t=this.jobOpeningsList.find(p=>p.name===this.formJobOpening);t&&(this.openingSearchText=t.job_title||t.name),console.log("Auto-filled job opening from applicant:",this.formJobOpening),this.formJobOpening&&(yield this.loadJobOpeningData())}}else this.formJobOpening="",this.openingSearchText="",this.applicantData=null})},onJobOpeningChange(){return h(this,null,function*(){if(this.formJobOpening){const n=this.jobOpeningsList.find(t=>t.name===this.formJobOpening);n&&(this.openingSearchText=n.job_title||n.name),yield this.loadJobOpeningData(),this.formJobApplicant&&this.applicantData&&this.applicantData.job_title!==this.formJobOpening&&console.warn("Warning: Selected Job Applicant is not associated with the selected Job Opening")}else this.openingSearchText="",this.jobOpeningData=null})}}},k={class:"flex-1 p-6 bg-gray-50 overflow-y-auto"},I={key:0,class:"mb-6"},S={class:"bg-white rounded-lg shadow p-6"},T={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},L={class:"relative"},C={class:"flex gap-2"},z={class:"relative flex-1"},E=["placeholder","disabled"],V={key:0,class:"absolute right-2 top-1/2 transform -translate-y-1/2"},M=["disabled"],N={key:0,class:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},F={key:0,class:"p-2"},P={class:"text-xs text-gray-500 px-2 py-1 mb-1 font-semibold"},B=["onMousedown"],q={class:"font-medium text-gray-900"},U={class:"text-sm text-gray-500"},R={class:"text-xs text-gray-400 font-mono"},H={key:1,class:"p-4 text-sm text-gray-500 text-center"},K={key:2,class:"p-4 text-sm text-gray-500 text-center"},Y={key:1,class:"text-xs text-gray-500 mt-1"},G={key:2,class:"text-xs text-green-600 mt-1"},W={class:"relative"},X={class:"flex gap-2"},Z={class:"relative flex-1"},Q=["placeholder","disabled"],$={key:0,class:"absolute right-2 top-1/2 transform -translate-y-1/2"},tt=["disabled"],et={key:0,class:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},st={key:0,class:"p-2"},nt={class:"text-xs text-gray-500 px-2 py-1 mb-1 font-semibold"},it=["onMousedown"],lt={class:"font-medium text-gray-900"},at={class:"text-sm text-gray-500"},ot={class:"text-xs text-gray-400 font-mono"},rt={key:1,class:"p-4 text-sm text-gray-500 text-center"},pt={key:2,class:"p-4 text-sm text-gray-500 text-center"},gt={key:1,class:"text-xs text-gray-500 mt-1"},dt={key:2,class:"text-xs text-green-600 mt-1"},ct=["disabled"],ht={key:0},bt={key:1},yt={key:1,class:"mb-6"},ut={class:"bg-white rounded-lg shadow p-6 mb-4"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ft={class:"border-r border-gray-200 pr-6"},xt={class:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-200"},At={class:"text-xs text-gray-500 font-mono ml-auto"},_t={key:0,class:"space-y-2"},vt={class:"text-sm"},wt={class:"text-gray-900"},Ot={class:"text-sm"},Jt={class:"text-gray-900"},Dt={key:0,class:"text-sm"},jt={class:"text-gray-900"},kt={key:1,class:"text-sm"},It={class:"text-gray-900"},St={key:2,class:"text-sm"},Tt={class:"text-gray-900"},Lt={key:1,class:"text-sm text-gray-500 italic"},Ct={class:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-200"},zt={class:"text-xs text-gray-500 font-mono ml-auto"},Et={key:0,class:"space-y-2"},Vt={class:"text-sm"},Mt={class:"text-gray-900"},Nt={key:0,class:"text-sm"},Ft={class:"text-gray-900"},Pt={key:1,class:"text-sm"},Bt={class:"text-gray-900"},qt={key:2,class:"text-sm"},Ut={class:"text-gray-900"},Rt={key:3,class:"text-sm"},Ht={class:"text-gray-900"},Kt={key:4,class:"text-sm"},Yt={class:"text-gray-900"},Gt={key:5,class:"text-sm"},Wt={class:"text-gray-900"},Xt={key:1,class:"text-sm text-gray-500 italic"},Zt={class:"flex gap-3 flex-wrap"},Qt=["disabled"],$t={key:0},te={key:1},ee={key:2,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-center justify-between"},se={class:"flex items-center gap-3"},ne={class:"text-red-700"},ie={key:3,class:"bg-white rounded-lg shadow p-8 text-center mb-6"},le={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 text-left"},ae={class:"mb-4"},oe={class:"text-sm text-gray-600 mb-2"},re={class:"w-full bg-gray-200 rounded-full h-2"},pe={key:4,class:"space-y-6"},ge={class:"bg-white rounded-lg shadow p-6"},de={class:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200"},ce={key:0,class:"text-xl font-semibold text-gray-900"},he={key:1,class:"text-xl font-semibold text-gray-900"},be={key:2,class:"text-xl font-semibold text-gray-900"},ye={key:3,class:"text-xl font-semibold text-gray-900"},ue={key:4,class:"text-sm text-gray-500"},me={class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-6 text-sm text-blue-900"},fe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},xe={class:"bg-gray-50 rounded-lg p-4"},Ae={class:"text-3xl font-bold text-gray-900 mb-2"},_e={class:"w-full bg-gray-200 rounded-full h-2"},ve={class:"bg-gray-50 rounded-lg p-4"},we={class:"text-2xl mb-2"},Oe={class:"text-sm font-semibold text-gray-700"},Je={class:"bg-gray-50 rounded-lg p-4"},De={class:"text-2xl mb-2"},je={class:"text-sm font-semibold text-gray-700"},ke={class:"bg-gray-50 rounded-lg p-4"},Ie={class:"text-3xl font-bold text-gray-900 mb-2"},Se={class:"w-full bg-gray-200 rounded-full h-2"},Te={class:"bg-gray-50 rounded-lg p-6 mb-6"},Le=["innerHTML"],Ce={key:1,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-yellow-800"},ze={class:"bg-gray-50 rounded-lg p-6"},Ee={class:"text-gray-700 leading-relaxed"},Ve={key:0},Me={key:1,class:"text-gray-500 italic"};function Ne(n,t,p,r,s,l){return a(),o("div",k,[t[86]||(t[86]=e("div",{class:"mb-8"},[e("h2",{class:"text-2xl font-semibold text-gray-900 mb-2"},"\u{1F4C4} AI CV Analysis"),e("p",{class:"text-sm text-gray-600"},"Analyze candidate CVs using AI to evaluate fit and skills match")],-1)),!l.effectiveJobApplicant||!l.effectiveJobOpening?(a(),o("div",I,[e("div",S,[t[31]||(t[31]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"\u{1F4DD} Enter Analysis Details",-1)),t[32]||(t[32]=e("p",{class:"text-sm text-gray-600 mb-6"},"Select a Job Applicant and Job Opening from the dropdowns below. The Job Opening will auto-fill when you select a Job Applicant.",-1)),e("div",T,[e("div",L,[t[28]||(t[28]=e("label",{for:"job-applicant-input",class:"block text-sm font-medium text-gray-700 mb-2"},[e("span",null,"\u{1F464}"),d(" Job Applicant ")],-1)),e("div",C,[e("div",z,[O(e("input",{id:"job-applicant-input",type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>s.applicantSearchText=i),onInput:t[1]||(t[1]=(...i)=>l.onApplicantSearchInput&&l.onApplicantSearchInput(...i)),onFocus:t[2]||(t[2]=(...i)=>l.onApplicantFocus&&l.onApplicantFocus(...i)),onBlur:t[3]||(t[3]=(...i)=>l.handleApplicantBlur&&l.handleApplicantBlur(...i)),onKeydown:[t[4]||(t[4]=y(u((...i)=>l.handleApplicantEnter&&l.handleApplicantEnter(...i),["prevent"]),["enter"])),t[5]||(t[5]=y(i=>s.showApplicantDropdown=!1,["escape"])),t[6]||(t[6]=y(u(i=>l.navigateApplicantDropdown(1),["prevent"]),["down"])),t[7]||(t[7]=y(u(i=>l.navigateApplicantDropdown(-1),["prevent"]),["up"]))],placeholder:s.formJobApplicant?"Type Job Applicant ID or name...":"Type Job Applicant ID or name manually...",disabled:s.loadingJobApplicants,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},null,40,E),[[J,s.applicantSearchText]]),s.formJobApplicant?(a(),o("div",V,[e("button",{onClick:t[8]||(t[8]=(...i)=>l.clearApplicant&&l.clearApplicant(...i)),class:"text-gray-400 hover:text-gray-600",type:"button"}," \u2715 ")])):c("",!0)]),e("button",{type:"button",onClick:t[9]||(t[9]=(...i)=>l.toggleApplicantDropdown&&l.toggleApplicantDropdown(...i)),disabled:s.loadingJobApplicants,class:"px-4 py-2 border border-gray-300 rounded-lg bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",title:"Browse applicants list"},[...t[27]||(t[27]=[e("span",{class:"text-lg"},"\u25BC",-1)])],8,M)]),s.showApplicantDropdown?(a(),o("div",N,[l.filteredApplicants.length>0?(a(),o("div",F,[e("div",P,"Select from list ("+g(l.filteredApplicants.length)+" results):",1),(a(!0),o(A,null,_(l.filteredApplicants,(i,f)=>(a(),o("div",{key:i.name,onMousedown:u(b=>l.selectApplicant(i),["prevent"]),class:m(["px-4 py-2 cursor-pointer border-b border-gray-100 last:border-b-0",f===s.highlightedApplicantIndex?"bg-blue-100":"hover:bg-blue-50"])},[e("div",q,g(i.applicant_name||i.name),1),e("div",U,g(i.email_id||""),1),e("div",R,g(i.name),1)],42,B))),128))])):s.applicantSearchText?(a(),o("div",H,' No applicants found matching "'+g(s.applicantSearchText)+'" ',1)):(a(),o("div",K," Start typing to search, or scroll to browse all applicants "))])):c("",!0),s.loadingJobApplicants?(a(),o("p",Y,"Loading applicants...")):c("",!0),s.formJobApplicant&&!s.loadingJobApplicants?(a(),o("p",G," \u2713 Selected: "+g(l.getApplicantDisplayName(s.formJobApplicant)),1)):c("",!0)]),e("div",W,[t[30]||(t[30]=e("label",{for:"job-opening-input",class:"block text-sm font-medium text-gray-700 mb-2"},[e("span",null,"\u{1F4BC}"),d(" Job Opening ")],-1)),e("div",X,[e("div",Z,[O(e("input",{id:"job-opening-input",type:"text","onUpdate:modelValue":t[10]||(t[10]=i=>s.openingSearchText=i),onInput:t[11]||(t[11]=(...i)=>l.onOpeningSearchInput&&l.onOpeningSearchInput(...i)),onFocus:t[12]||(t[12]=(...i)=>l.onOpeningFocus&&l.onOpeningFocus(...i)),onBlur:t[13]||(t[13]=(...i)=>l.handleOpeningBlur&&l.handleOpeningBlur(...i)),onKeydown:[t[14]||(t[14]=y(u((...i)=>l.handleOpeningEnter&&l.handleOpeningEnter(...i),["prevent"]),["enter"])),t[15]||(t[15]=y(i=>s.showOpeningDropdown=!1,["escape"])),t[16]||(t[16]=y(u(i=>l.navigateOpeningDropdown(1),["prevent"]),["down"])),t[17]||(t[17]=y(u(i=>l.navigateOpeningDropdown(-1),["prevent"]),["up"]))],placeholder:s.formJobOpening?"Type Job Opening ID or name...":"Type Job Opening ID or name manually...",disabled:s.loadingJobOpenings,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},null,40,Q),[[J,s.openingSearchText]]),s.formJobOpening?(a(),o("div",$,[e("button",{onClick:t[18]||(t[18]=(...i)=>l.clearOpening&&l.clearOpening(...i)),class:"text-gray-400 hover:text-gray-600",type:"button"}," \u2715 ")])):c("",!0)]),e("button",{type:"button",onClick:t[19]||(t[19]=(...i)=>l.toggleOpeningDropdown&&l.toggleOpeningDropdown(...i)),disabled:s.loadingJobOpenings,class:"px-4 py-2 border border-gray-300 rounded-lg bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",title:"Browse openings list"},[...t[29]||(t[29]=[e("span",{class:"text-lg"},"\u25BC",-1)])],8,tt)]),s.showOpeningDropdown?(a(),o("div",et,[l.filteredOpenings.length>0?(a(),o("div",st,[e("div",nt,"Select from list ("+g(l.filteredOpenings.length)+" results):",1),(a(!0),o(A,null,_(l.filteredOpenings,(i,f)=>(a(),o("div",{key:i.name,onMousedown:u(b=>l.selectOpening(i),["prevent"]),class:m(["px-4 py-2 cursor-pointer border-b border-gray-100 last:border-b-0",f===s.highlightedOpeningIndex?"bg-blue-100":"hover:bg-blue-50"])},[e("div",lt,g(i.job_title||i.name),1),e("div",at,g(i.designation||""),1),e("div",ot,g(i.name),1)],42,it))),128))])):s.openingSearchText?(a(),o("div",rt,' No openings found matching "'+g(s.openingSearchText)+'" ',1)):(a(),o("div",pt," Start typing to search, or scroll to browse all openings "))])):c("",!0),s.loadingJobOpenings?(a(),o("p",gt,"Loading openings...")):c("",!0),s.formJobOpening&&!s.loadingJobOpenings?(a(),o("p",dt," \u2713 Selected: "+g(l.getOpeningDisplayName(s.formJobOpening)),1)):c("",!0)])]),e("button",{onClick:t[20]||(t[20]=(...i)=>l.startAnalysis&&l.startAnalysis(...i)),disabled:!l.canAnalyze||s.isAnalyzing,class:"w-full px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed"},[s.isAnalyzing?(a(),o("span",ht,"\u{1F504} Analyzing...")):(a(),o("span",bt,"\u{1F680} Start AI Analysis"))],8,ct)])])):(a(),o("div",yt,[e("div",ut,[e("div",mt,[e("div",ft,[e("div",xt,[t[33]||(t[33]=e("span",{class:"text-2xl"},"\u{1F464}",-1)),t[34]||(t[34]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Job Applicant",-1)),e("span",At,g(l.effectiveJobApplicant),1)]),s.applicantData?(a(),o("div",_t,[e("p",vt,[t[35]||(t[35]=e("span",{class:"font-medium text-gray-700"},"Name:",-1)),t[36]||(t[36]=d()),e("span",wt,g(s.applicantData.applicant_name||"N/A"),1)]),e("p",Ot,[t[37]||(t[37]=e("span",{class:"font-medium text-gray-700"},"Email:",-1)),t[38]||(t[38]=d()),e("span",Jt,g(s.applicantData.email_id||"N/A"),1)]),s.applicantData.phone_number?(a(),o("p",Dt,[t[39]||(t[39]=e("span",{class:"font-medium text-gray-700"},"Phone:",-1)),t[40]||(t[40]=d()),e("span",jt,g(s.applicantData.phone_number),1)])):c("",!0),s.applicantData.designation?(a(),o("p",kt,[t[41]||(t[41]=e("span",{class:"font-medium text-gray-700"},"Designation:",-1)),t[42]||(t[42]=d()),e("span",It,g(s.applicantData.designation),1)])):c("",!0),s.applicantData.status?(a(),o("p",St,[t[43]||(t[43]=e("span",{class:"font-medium text-gray-700"},"Status:",-1)),t[44]||(t[44]=d()),e("span",Tt,g(s.applicantData.status),1)])):c("",!0)])):(a(),o("div",Lt,"Loading applicant data..."))]),e("div",null,[e("div",Ct,[t[45]||(t[45]=e("span",{class:"text-2xl"},"\u{1F4BC}",-1)),t[46]||(t[46]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Job Opening",-1)),e("span",zt,g(l.effectiveJobOpening),1)]),s.jobOpeningData?(a(),o("div",Et,[e("p",Vt,[t[47]||(t[47]=e("span",{class:"font-medium text-gray-700"},"Title:",-1)),t[48]||(t[48]=d()),e("span",Mt,g(s.jobOpeningData.job_title||"N/A"),1)]),s.jobOpeningData.designation?(a(),o("p",Nt,[t[49]||(t[49]=e("span",{class:"font-medium text-gray-700"},"Designation:",-1)),t[50]||(t[50]=d()),e("span",Ft,g(s.jobOpeningData.designation),1)])):c("",!0),s.jobOpeningData.company?(a(),o("p",Pt,[t[51]||(t[51]=e("span",{class:"font-medium text-gray-700"},"Company:",-1)),t[52]||(t[52]=d()),e("span",Bt,g(s.jobOpeningData.company),1)])):c("",!0),s.jobOpeningData.department?(a(),o("p",qt,[t[53]||(t[53]=e("span",{class:"font-medium text-gray-700"},"Department:",-1)),t[54]||(t[54]=d()),e("span",Ut,g(s.jobOpeningData.department),1)])):c("",!0),s.jobOpeningData.location?(a(),o("p",Rt,[t[55]||(t[55]=e("span",{class:"font-medium text-gray-700"},"Location:",-1)),t[56]||(t[56]=d()),e("span",Ht,g(s.jobOpeningData.location),1)])):c("",!0),s.jobOpeningData.employment_type?(a(),o("p",Kt,[t[57]||(t[57]=e("span",{class:"font-medium text-gray-700"},"Type:",-1)),t[58]||(t[58]=d()),e("span",Yt,g(s.jobOpeningData.employment_type),1)])):c("",!0),s.jobOpeningData.status?(a(),o("p",Gt,[t[59]||(t[59]=e("span",{class:"font-medium text-gray-700"},"Status:",-1)),t[60]||(t[60]=d()),e("span",Wt,g(s.jobOpeningData.status),1)])):c("",!0)])):(a(),o("div",Xt,"Loading job opening data..."))])])]),e("div",Zt,[e("button",{onClick:t[21]||(t[21]=(...i)=>l.analyzeCV&&l.analyzeCV(...i)),disabled:s.isAnalyzing,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed"},[s.isAnalyzing?(a(),o("span",$t,"\u{1F504} Analyzing...")):(a(),o("span",te,"\u{1F50D} Analyze CV"))],8,Qt),e("button",{onClick:t[22]||(t[22]=(...i)=>l.clearInputs&&l.clearInputs(...i)),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},"Change IDs"),s.analysis?(a(),o("button",{key:0,onClick:t[23]||(t[23]=(...i)=>l.reloadAnalysis&&l.reloadAnalysis(...i)),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},"\u{1F504} Reload")):c("",!0)])])),s.error?(a(),o("div",ee,[e("div",se,[t[62]||(t[62]=e("span",{class:"text-xl"},"\u26A0\uFE0F",-1)),e("div",null,[t[61]||(t[61]=e("strong",{class:"text-red-800"},"Error:",-1)),e("span",ne,g(s.error),1)])]),e("button",{onClick:t[24]||(t[24]=(...i)=>l.clearError&&l.clearError(...i)),class:"text-red-600 hover:text-red-800"},"\u2715")])):c("",!0),s.isAnalyzing&&!s.analysis?(a(),o("div",ie,[t[67]||(t[67]=e("div",{class:"relative inline-block mb-6"},[e("div",{class:"w-16 h-16 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin"})],-1)),t[68]||(t[68]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"\u{1F916} AI is Analyzing CV...",-1)),t[69]||(t[69]=e("p",{class:"text-sm text-gray-600 mb-6"},"This is a real analysis using OpenAI GPT-4",-1)),e("div",le,[e("div",{class:m(["p-3 rounded-lg",s.pollingAttempts>0?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...t[63]||(t[63]=[e("span",{class:"mr-2"},"\u2713",-1),d(" Request queued ",-1)])],2),e("div",{class:m(["p-3 rounded-lg",s.pollingAttempts>2?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...t[64]||(t[64]=[e("span",{class:"mr-2"},"\u23F3",-1),d(" Processing CV ",-1)])],2),e("div",{class:m(["p-3 rounded-lg",s.pollingAttempts>5?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...t[65]||(t[65]=[e("span",{class:"mr-2"},"\u23F3",-1),d(" Calling OpenAI ",-1)])],2),e("div",{class:m(["p-3 rounded-lg",s.pollingAttempts>8?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"])},[...t[66]||(t[66]=[e("span",{class:"mr-2"},"\u23F3",-1),d(" Parsing results ",-1)])],2)]),e("div",ae,[e("p",oe,"Checking status... ("+g(s.pollingAttempts)+"/30 attempts, ~"+g(Math.round(s.pollingAttempts*2))+"s elapsed)",1),e("div",re,[e("div",{class:"bg-blue-500 h-2 rounded-full transition-all",style:w({width:Math.min(s.pollingAttempts/30*100,100)+"%"})},null,4)])]),s.pollingAttempts>5?(a(),o("button",{key:0,onClick:t[25]||(t[25]=(...i)=>l.cancelAnalysis&&l.cancelAnalysis(...i)),class:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600"},"Cancel Analysis")):c("",!0)])):c("",!0),s.analysis?(a(),o("div",pe,[e("div",ge,[e("div",de,[s.analysis.status==="Completed"?(a(),o("h3",ce,"\u2705 Analysis Complete")):s.analysis.status==="Analyzing"?(a(),o("h3",he,"\u23F3 Analysis In Progress")):s.analysis.status==="Failed"?(a(),o("h3",be,"\u274C Analysis Failed")):(a(),o("h3",ye,"\u{1F4CA} Analysis (Status: "+g(s.analysis.status)+")",1)),s.analysis.analysis_timestamp?(a(),o("div",ue," Analyzed on "+g(l.formatDate(s.analysis.analysis_timestamp)),1)):c("",!0)]),e("div",me,[t[76]||(t[76]=e("p",{class:"font-semibold mb-2"},"\u{1F50D} Debug Info:",-1)),e("p",null,[t[70]||(t[70]=e("strong",null,"Status:",-1)),d(" "+g(s.analysis.status),1)]),e("p",null,[t[71]||(t[71]=e("strong",null,"Analysis ID:",-1)),d(" "+g(s.analysis.name),1)]),e("p",null,[t[72]||(t[72]=e("strong",null,"Has text:",-1)),d(" "+g(s.analysis.cv_analysis_text?"Yes ("+s.analysis.cv_analysis_text.length+" chars)":"No"),1)]),e("p",null,[t[73]||(t[73]=e("strong",null,"Skills:",-1)),d(" "+g(s.analysis.skills_match_percentage||"N/A")+"%",1)]),e("p",null,[t[74]||(t[74]=e("strong",null,"Experience:",-1)),d(" "+g(s.analysis.experience_relevance||"N/A"),1)]),e("p",null,[t[75]||(t[75]=e("strong",null,"Education:",-1)),d(" "+g(s.analysis.education_match||"N/A"),1)])]),e("div",fe,[e("div",xe,[t[77]||(t[77]=e("div",{class:"flex items-center gap-2 mb-2"},[e("span",{class:"text-xl"},"\u{1F3AF}"),e("h4",{class:"text-sm font-medium text-gray-700"},"Skills Match")],-1)),e("div",Ae,g(s.analysis.skills_match_percentage||0)+"%",1),e("div",_e,[e("div",{class:"bg-blue-500 h-2 rounded-full",style:w({width:(s.analysis.skills_match_percentage||0)+"%"})},null,4)])]),e("div",ve,[t[78]||(t[78]=e("div",{class:"flex items-center gap-2 mb-2"},[e("span",{class:"text-xl"},"\u{1F4BC}"),e("h4",{class:"text-sm font-medium text-gray-700"},"Experience")],-1)),e("div",we,[(a(),o(A,null,_(5,i=>e("span",{key:i,class:m(i<=(s.analysis.experience_relevance||0)?"text-yellow-500":"text-gray-300")},"\u2605",2)),64))]),e("div",Oe,g(s.analysis.experience_relevance||0)+"/5",1)]),e("div",Je,[t[79]||(t[79]=e("div",{class:"flex items-center gap-2 mb-2"},[e("span",{class:"text-xl"},"\u{1F393}"),e("h4",{class:"text-sm font-medium text-gray-700"},"Education")],-1)),e("div",De,[(a(),o(A,null,_(5,i=>e("span",{key:i,class:m(i<=(s.analysis.education_match||0)?"text-yellow-500":"text-gray-300")},"\u2605",2)),64))]),e("div",je,g(s.analysis.education_match||0)+"/5",1)]),e("div",ke,[t[80]||(t[80]=e("div",{class:"flex items-center gap-2 mb-2"},[e("span",{class:"text-xl"},"\u{1F4CA}"),e("h4",{class:"text-sm font-medium text-gray-700"},"AI Confidence")],-1)),e("div",Ie,g(s.analysis.ai_confidence_score||0)+"%",1),e("div",Se,[e("div",{class:"bg-green-500 h-2 rounded-full",style:w({width:(s.analysis.ai_confidence_score||0)+"%"})},null,4)])])]),e("div",Te,[t[84]||(t[84]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-200"},"\u{1F4CB} Detailed AI Analysis",-1)),s.analysis.cv_analysis_text&&s.analysis.cv_analysis_text.trim().length>0?(a(),o("div",{key:0,class:"text-gray-700 leading-relaxed whitespace-pre-wrap",innerHTML:s.analysis.cv_analysis_text},null,8,Le)):(a(),o("div",Ce,[t[81]||(t[81]=e("p",{class:"font-semibold mb-2"},"\u26A0\uFE0F Analysis completed but no detailed text was generated.",-1)),t[82]||(t[82]=e("p",{class:"text-sm mb-2"},"This might happen if:",-1)),t[83]||(t[83]=e("ul",{class:"text-sm list-disc list-inside mb-3"},[e("li",null,"The AI response was incomplete"),e("li",null,"There was an error parsing the AI response"),e("li",null,"The analysis data is still being processed")],-1)),e("button",{onClick:t[26]||(t[26]=(...i)=>l.reloadAnalysis&&l.reloadAnalysis(...i)),class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"},"\u{1F504} Reload Analysis")]))]),e("div",ze,[t[85]||(t[85]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-200"},"\u{1F4A1} AI Recommendations",-1)),e("div",Ee,[s.analysis.ai_recommendations&&s.analysis.ai_recommendations.trim().length>0?(a(),o("p",Ve,g(s.analysis.ai_recommendations),1)):(a(),o("p",Me," \u26A0\uFE0F No recommendations were generated for this analysis. "))])])])])):c("",!0)])}var Be=D(j,[["render",Ne],["__scopeId","data-v-2f134fa7"]]);export{Be as default};
