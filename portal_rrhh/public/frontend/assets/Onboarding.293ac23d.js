var I=(V,u,m)=>new Promise((v,l)=>{var g=_=>{try{y(m.next(_))}catch(w){l(w)}},x=_=>{try{y(m.throw(_))}catch(w){l(w)}},y=_=>_.done?v(_.value):Promise.resolve(_.value).then(g,x);y((m=m.apply(V,u)).next())});import{l as M,r as B,q as C,o as n,c as i,b as e,d,w as c,u as A,I as H,f as b,F as N,E as T,G as D,e as p,n as $,t as f,s as F,W as te,Z as se}from"./vendor.13deb96d.js";const oe={class:"flex flex-col h-full overflow-hidden"},ne={class:"flex-1 overflow-y-auto"},le={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},re={class:"md:flex md:items-center md:justify-between mb-6"},ae={class:"mt-4 flex md:mt-0 md:ml-4"},ie={key:0,class:"mb-6"},de={key:1,class:"flex justify-center py-10"},ce={key:2,class:"text-center py-10 text-gray-500"},ue={key:3,class:"space-y-6"},me=["onClick"],fe={class:"flex items-center space-x-3"},_e={class:"text-lg font-medium text-gray-900"},pe={class:"flex items-center text-sm text-gray-500 space-x-2 mt-1"},ve={class:"text-xs text-gray-400"},ge={key:0,class:"p-6 border-t border-gray-100 bg-gray-50/50"},xe={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3"},he={class:"p-6 flex-1 flex flex-col"},be={class:"flex items-start justify-between"},ye={class:"flex-1"},we=["title"],ke={class:"flex items-center space-x-2"},Ce={class:"mt-4 text-sm text-gray-500 line-clamp-3"},De={class:"mt-6 pt-4 border-t border-gray-100 flex items-center justify-between"},je={class:"text-xs text-gray-400"},Pe={key:1,class:"text-xs text-green-600 font-medium"},Be={class:"text-lg font-bold"},Fe={class:"min-h-[400px] max-h-[60vh] overflow-y-auto border rounded bg-gray-50 p-4"},Ve={key:0,class:"mb-6 p-4 bg-blue-50 border border-blue-100 rounded-lg flex items-center justify-between"},Oe={class:"flex items-center"},Ee=["href"],Le=["innerHTML"],Re={key:2,class:"flex flex-col items-center justify-center h-full mt-4"},ze=["src"],Ie={key:1,class:"text-center text-gray-500"},Me={key:3,class:"text-gray-500 italic text-center py-10"},Ae={key:0,class:"mt-4"},He={class:"mt-4 p-4 bg-yellow-50 rounded border border-yellow-100"},Ne={class:"flex items-start space-x-3 cursor-pointer"},Te={class:"text-sm text-gray-700"},$e={class:"flex justify-end space-x-2"},Se={__name:"Onboarding",setup(V){const u=M({url:"portal_rrhh.api.onboarding.get_my_onboarding_docs",auto:!0}),m=M({url:"portal_rrhh.api.signing.sign_document"}),v=B(!1),l=B(null),g=B(!1),x=B({}),y=C(()=>{if(!u.data)return{};const t={};return u.data.forEach(o=>{t[o.process_name]||(t[o.process_name]={id:o.process_name,title:o.process_title||o.process_name,status:o.process_status,creation:o.process_creation,docs:[],isOpen:!1}),t[o.process_name].docs.push(o)}),Object.keys(t).forEach((o,h)=>{x.value[o]===void 0&&(x.value[o]=h===0),t[o].isOpen=x.value[o]}),t}),_=t=>{x.value[t]=!x.value[t]},w=t=>t==="Completed"?"green":t==="Pending"?"orange":t==="In Progress"?"blue":t==="Cancelled"?"red":"gray",q=t=>t==="Completed"?"Completado":t==="Pending"?"Pendiente":t==="In Progress"?"En Progreso":t==="Cancelled"?"Cancelado":t,G=C(()=>u.data||[]),S=C(()=>u.loading),j=C(()=>u.error?u.error.message||u.error:m.error?m.error.message||m.error:null),U=C(()=>m.loading),W=()=>{u.fetch()},Z=t=>{l.value=t,g.value=!1,v.value=!0,m.reset()},J=()=>I(this,null,function*(){if(!(!l.value||!g.value))try{yield m.submit({process_name:l.value.process_name,row_name:l.value.row_name}),alert("Documento firmado correctamente"),v.value=!1,u.reload()}catch(t){console.error(t)}}),O=t=>t?new Date(t).toLocaleDateString():"-",K=t=>t==null?void 0:t.toLowerCase().endsWith(".pdf"),Q=t=>{window.open(t,"_blank")};return(t,s)=>{const o=D("FeatherIcon"),h=D("Button"),E=D("Badge"),X=D("Card"),Y=D("Dialog");return n(),i("div",oe,[e("div",ne,[e("div",le,[e("div",re,[s[4]||(s[4]=e("div",{class:"flex-1 min-w-0"},[e("h2",{class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"}," Onboarding "),e("p",{class:"mt-1 text-sm text-gray-500"}," Documentos pendientes de lectura y firma. ")],-1)),e("div",ae,[d(h,{variant:"outline",onClick:W},{prefix:c(()=>[d(o,{name:"refresh-cw",class:"w-4 h-4"})]),default:c(()=>[s[3]||(s[3]=p(" Actualizar ",-1))]),_:1})])]),j.value?(n(),i("div",ie,[d(A(H),{message:j.value},null,8,["message"])])):b("",!0),S.value?(n(),i("div",de,[...s[5]||(s[5]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1)])])):G.value.length===0?(n(),i("div",ce,[d(o,{name:"check-circle",class:"w-12 h-12 mx-auto mb-4 text-green-500"}),s[6]||(s[6]=e("p",{class:"text-lg"},"No se encontr\xF3 historial de onboarding.",-1))])):(n(),i("div",ue,[(n(!0),i(N,null,T(y.value,(r,k)=>(n(),i("div",{key:k,class:"border rounded-lg bg-white overflow-hidden shadow-sm"},[e("div",{onClick:a=>_(k),class:"flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50 transition-colors select-none"},[e("div",fe,[e("div",{class:$(["p-2 rounded-full",r.isOpen?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-500"])},[d(o,{name:r.isOpen?"chevron-down":"chevron-right",class:"w-5 h-5 transition-transform duration-200"},null,8,["name"])],2),e("div",null,[e("h3",_e,f(r.title),1),e("div",pe,[e("span",null,f(O(r.creation)),1),s[7]||(s[7]=e("span",null,"\u2022",-1)),d(E,{theme:w(r.status)},{default:c(()=>[p(f(q(r.status)),1)]),_:2},1032,["theme"]),e("span",ve,"("+f(r.docs.length)+" docs)",1)])])])],8,me),r.isOpen?(n(),i("div",ge,[e("div",xe,[(n(!0),i(N,null,T(r.docs,a=>(n(),F(X,{key:a.row_name,class:"flex flex-col h-full hover:shadow-lg transition-shadow duration-200 bg-white"},{default:c(()=>[e("div",he,[e("div",be,[e("div",ye,[e("h3",{class:"text-lg font-medium text-gray-900 mb-2 truncate",title:a.title},f(a.title),9,we),e("div",ke,[d(E,{theme:a.is_completed?"green":"orange"},{default:c(()=>[p(f(a.is_completed?"Firmado":"Pendiente"),1)]),_:2},1032,["theme"])])]),d(o,{name:a.is_completed?"check-circle":"file-text",class:$([a.is_completed?"text-green-500":"text-gray-400","w-6 h-6 flex-shrink-0"])},null,8,["name","class"])]),e("p",Ce,f(a.description||"Sin descripci\xF3n"),1),e("div",De,[e("span",je,f(a.type),1),a.is_completed?(n(),i("span",Pe," Completado el "+f(O(a.completion_date)),1)):(n(),F(h,{key:0,variant:"solid",onClick:P=>Z(a)},{default:c(()=>[...s[8]||(s[8]=[p(" Revisar y Firmar ",-1)])]),_:1},8,["onClick"])),a.file_url?(n(),F(h,{key:2,variant:"outline",onClick:P=>Q(a.file_url),class:"ml-2 px-2",title:"Descargar Archivo Adjunto"},{default:c(()=>[d(o,{name:"download",class:"w-4 h-4"})]),_:1},8,["onClick"])):b("",!0)])])]),_:2},1024))),128))])])):b("",!0)]))),128))])),d(Y,{modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=r=>v.value=r),options:{size:"4xl"}},{"body-title":c(()=>{var r;return[e("h3",Be,f((r=l.value)==null?void 0:r.title),1)]}),"body-content":c(()=>{var r,k,a,P,L,R,z;return[e("div",Fe,[((r=l.value)==null?void 0:r.file_url)?(n(),i("div",Ve,[e("div",Oe,[d(o,{name:"paperclip",class:"w-5 h-5 text-blue-500 mr-2"}),s[9]||(s[9]=e("span",{class:"text-sm text-blue-700 font-medium"},"Documento Adjunto Disponible",-1))]),e("a",{href:l.value.file_url,target:"_blank",class:"flex items-center text-white bg-blue-600 hover:bg-blue-700 px-3 py-1.5 rounded text-sm transition-colors"},[d(o,{name:"download",class:"w-4 h-4 mr-2"}),s[10]||(s[10]=p(" Descargar ",-1))],8,Ee)])):b("",!0),((k=l.value)==null?void 0:k.html_content)?(n(),i("div",{key:1,innerHTML:l.value.html_content,class:"prose max-w-none"},null,8,Le)):((a=l.value)==null?void 0:a.file_url)&&!((P=l.value)==null?void 0:P.html_content)?(n(),i("div",Re,[K(l.value.file_url)?(n(),i("iframe",{key:0,src:l.value.file_url,class:"w-full h-[500px]",frameborder:"0"},null,8,ze)):(n(),i("div",Ie,[...s[11]||(s[11]=[e("p",null,"Vista previa no disponible.",-1),e("p",null,"Por favor descargue el archivo para visualizarlo.",-1)])]))])):b("",!0),!((L=l.value)==null?void 0:L.html_content)&&!((R=l.value)==null?void 0:R.file_url)?(n(),i("div",Me," No hay contenido visualizable. Por favor contacte a RRHH. ")):b("",!0)]),j.value?(n(),i("div",Ae,[d(A(H),{message:j.value},null,8,["message"])])):b("",!0),e("div",He,[e("label",Ne,[te(e("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=ee=>g.value=ee),class:"mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 transition duration-150 ease-in-out"},null,512),[[se,g.value]]),e("span",Te,[s[12]||(s[12]=p(" Declaro que he le\xEDdo, comprendido y acepto el contenido del documento ",-1)),e("strong",null,f((z=l.value)==null?void 0:z.title),1),s[13]||(s[13]=p('. Entiendo que al hacer clic en "Firmar Documento", se registrar\xE1 mi aceptaci\xF3n con fecha y hora. ',-1))])])])]}),actions:c(()=>[e("div",$e,[d(h,{variant:"subtle",onClick:s[1]||(s[1]=r=>v.value=!1)},{default:c(()=>[...s[14]||(s[14]=[p("Cancelar",-1)])]),_:1}),d(h,{variant:"solid",theme:"blue",loading:U.value,disabled:!g.value,onClick:J},{default:c(()=>[...s[15]||(s[15]=[p(" Firmar Documento ",-1)])]),_:1},8,["loading","disabled"])])]),_:1},8,["modelValue"])])])])}}};export{Se as default};
